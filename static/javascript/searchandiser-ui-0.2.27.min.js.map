{"version":3,"sources":["webpack:///searchandiser-ui-0.2.27.min.js","webpack:///webpack/bootstrap c3976e4898f69d988432","webpack:///./src/pkg-index.ts","webpack:///./src/polyfills.ts","webpack:///external \"array.of\"","webpack:///external \"array.from\"","webpack:///external \"array-includes\"","webpack:///external \"string.prototype.repeat\"","webpack:///external \"string.prototype.startswith\"","webpack:///./~/ts-helpers/index.js","webpack:///./src/searchandiser.ts","webpack:///./src/services/init.ts","webpack:///./src/services/collections.ts","webpack:///./src/utils/common.ts","webpack:///external \"debounce\"","webpack:///external \"query-string\"","webpack:///external \"filter-object\"","webpack:///external \"oget\"","webpack:///external \"groupby-api\"","webpack:///./src/services/filter.ts","webpack:///./src/services/redirect.ts","webpack:///./src/services/tracker.ts","webpack:///./src/utils/product-transformer.ts","webpack:///external \"gb-tracker-client\"","webpack:///external \"js-cookie\"","webpack:///external \"node-uuid\"","webpack:///./src/services/url.ts","webpack:///./src/utils/simple-beautifier.ts","webpack:///external \"parseUri\"","webpack:///./src/utils/url-beautifier.ts","webpack:///./src/tags/tag.ts","webpack:///external \"sayt\"","webpack:///./src/utils/configuration.ts","webpack:///external \"riot\"","webpack:///./src/tags/index.ts","webpack:///./src/tags/breadcrumbs/gb-breadcrumbs.tag.html","webpack:///./src/tags/breadcrumbs/gb-query-crumb.tag.html","webpack:///./src/tags/list/gb-list.tag.html","webpack:///./src/tags/breadcrumbs/gb-refinement-crumb.tag.html","webpack:///./src/tags/breadcrumbs/gb-breadcrumbs.ts","webpack:///./src/tags/carousel/gb-carousel.tag.html","webpack:///./src/tags/carousel/gb-carousel.ts","webpack:///./src/tags/category-menu/gb-category-menu.tag.html","webpack:///./src/tags/category-menu/gb-category-dropdown.tag.html","webpack:///./src/tags/category-menu/gb-category-section.tag.html","webpack:///./src/tags/collections/gb-collections.tag.html","webpack:///./src/tags/collections/gb-collection-item.tag.html","webpack:///./src/tags/badge/gb-badge.tag.html","webpack:///./src/tags/collections/gb-collection-dropdown-item.tag.html","webpack:///./src/tags/select/gb-select.tag.html","webpack:///./src/tags/select/gb-native-select.tag.html","webpack:///./src/tags/select/gb-select.ts","webpack:///./src/tags/select/arrow-down.png","webpack:///./src/tags/select/gb-custom-select.tag.html","webpack:///./src/tags/select/gb-select-button.tag.html","webpack:///./src/tags/select/gb-option-list.tag.html","webpack:///./src/tags/select/gb-option.tag.html","webpack:///./src/tags/collections/gb-collections.ts","webpack:///./src/tags/details/gb-details.tag.html","webpack:///./src/tags/details/gb-details.ts","webpack:///external \"clone\"","webpack:///./src/tags/did-you-mean/gb-did-you-mean.tag.html","webpack:///./src/tags/did-you-mean/gb-did-you-mean.ts","webpack:///./src/tags/filter/gb-filter.tag.html","webpack:///./src/tags/filter/gb-filter.ts","webpack:///./src/tags/navigation/gb-navigation.tag.html","webpack:///./src/tags/navigation/gb-refinement-list.tag.html","webpack:///./src/tags/navigation/gb-available-refinement.tag.html","webpack:///./src/tags/navigation/gb-refinement.ts","webpack:///./src/tags/navigation/gb-selected-refinement.tag.html","webpack:///./src/tags/navigation/gb-navigation.ts","webpack:///./src/tags/page-size/gb-page-size.tag.html","webpack:///./src/tags/page-size/gb-page-size.ts","webpack:///./src/tags/paging/gb-pager.tag.html","webpack:///./src/tags/icon/gb-icon.tag.html","webpack:///./src/tags/icon/gb-icon.ts","webpack:///./src/tags/paging/gb-pager.ts","webpack:///./src/tags/paging/gb-pages.tag.html","webpack:///./src/tags/paging/gb-pages.ts","webpack:///./src/tags/paging/gb-paging.tag.html","webpack:///./src/tags/paging/gb-terminal-pager.tag.html","webpack:///./src/tags/paging/gb-terminal-pager.ts","webpack:///./src/tags/paging/gb-paging.ts","webpack:///./src/tags/paging/double-arrow-left.png","webpack:///./src/tags/paging/arrow-left.png","webpack:///./src/tags/paging/arrow-right.png","webpack:///./src/tags/paging/double-arrow-right.png","webpack:///./src/tags/query/gb-query.tag.html","webpack:///./src/tags/query/gb-search-box.tag.html","webpack:///./src/tags/submit/gb-submit.tag.html","webpack:///./src/tags/submit/gb-submit.ts","webpack:///./src/tags/reset/gb-reset.tag.html","webpack:///./src/tags/reset/gb-reset.ts","webpack:///./src/tags/sayt/gb-sayt.tag.html","webpack:///./src/tags/sayt/gb-sayt-autocomplete.tag.html","webpack:///./src/tags/sayt/gb-sayt-categories.tag.html","webpack:///./src/tags/sayt/gb-sayt-link.tag.html","webpack:///./src/tags/raw/gb-raw.tag.html","webpack:///./src/tags/raw/gb-raw.ts","webpack:///./src/tags/sayt/gb-sayt-search-terms.tag.html","webpack:///./src/tags/sayt/gb-sayt-refinements.tag.html","webpack:///./src/tags/sayt/gb-sayt-divider.tag.html","webpack:///./src/tags/sayt/gb-sayt-products.tag.html","webpack:///./src/tags/product/gb-product.tag.html","webpack:///./src/tags/product/gb-product-image.tag.html","webpack:///./src/tags/product/gb-product-info.tag.html","webpack:///./src/tags/product/gb-variant-switcher.tag.html","webpack:///./src/tags/product/gb-product.ts","webpack:///./src/tags/sayt/gb-sayt.ts","webpack:///./src/tags/sayt/autocomplete.ts","webpack:///external \"escape-string-regexp\"","webpack:///./src/tags/query/gb-query.ts","webpack:///./src/tags/record-count/gb-record-count.tag.html","webpack:///./src/tags/record-count/gb-record-count.ts","webpack:///./src/tags/related-queries/gb-related-queries.tag.html","webpack:///./src/tags/related-queries/gb-related-queries.ts","webpack:///./src/tags/results/gb-results.tag.html","webpack:///./src/tags/results/gb-results.ts","webpack:///./src/tags/snippet/gb-snippet.tag.html","webpack:///./src/tags/snippet/gb-snippet.ts","webpack:///./src/tags/sort/gb-sort.tag.html","webpack:///./src/tags/sort/gb-sort.ts","webpack:///./src/tags/template/gb-template.tag.html","webpack:///./src/tags/template/gb-content-zone.tag.html","webpack:///./src/tags/template/gb-rich-content-zone.tag.html","webpack:///./src/tags/template/gb-record-zone.tag.html","webpack:///./src/tags/template/gb-template.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","searchandiser_1","Searchandiser","utils","groupby_api_1","BrowserBridge","CloudBridge","FluxCapacitor","Query","sayt_1","Sayt","searchandiser","initSearchandiser","shim","require","__assignFn","t","s","i","n","arguments","length","Object","prototype","hasOwnProperty","__extendsFn","d","b","__","this","constructor","create","__decorateFn","decorators","target","key","desc","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__metadataFn","k","v","metadata","__paramFn","paramIndex","decorator","__awaiterFn","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__global","__assign","assign","__extends","__decorate","__metadata","__param","__awaiter","window","WorkerGlobalScope","self","global","Function","configure","rawConfig","config","configuration_1","Configuration","flux","customerId","CONFIGURATION_MASK","Events","services","init_1","initServices","riot","mixin","tag_1","MixinFlux","init","initialSearch","search","attach","tagName","selectorOrOpts","options","tag","cssAttach","simpleAttach","compile","query","_this","emit","PAGE_CHANGED","pageNumber","finalPage","page","mount","riotTagName","cssSelector","startsWith","servicesConstructors","SERVICES","CORE_SERVICES","_i","_a","keys","startServices","collections_1","filter_1","redirect_1","tracker_1","url_1","collections","Collections","filter","Filter","redirect","Redirect","tracker","Tracker","url","Url","common_1","COLLECTIONS_UPDATED_EVENT","counts","collectionsConfig","getPath","fetchCounts","unless","isLabeled","map","collection","on","QUERY_CHANGED","updateCollectionCounts","RESULTS","results","updateSelectedCollectionCount","inProgress","cancelled","searches","isSelected","bridge","raw","refinements","pageSize","fields","promises_1","all","extractCounts","res","reduce","_b","totalRecordCount","selectedCollection","get","enumerable","configurable","findSearchBox","oget","findTag","document","querySelector","toRefinement","ref","nav","filterObject","navigationName","name","displayRefinement","type","low","high","checkNested","obj","Array","slice","arg","getParam","param","queryString","parse","LOCATION","getSearch","defaultObjs","undefined","splice","concat","path","remap","mapping","acc","checkBooleanAttr","attribute","opts","debounce","href","location","setSearch","pathname","replace","FILTER_UPDATED_EVENT","fluxClone","clone","filterConfig","updateFluxClone","searchRequest","withConfiguration","filteredRefinements","isTargetNav","withSelectedRefinements","navName","field","REDIRECT","product_transformer_1","GbTracker","Cookies","uuid","MAX_COOKIE_AGE","VISITOR_COOKIE_KEY","SESSION_COOKIE_KEY","_config","area","transformer","ProductTransformer","structure","setVisitorInfo","listenForViewProduct","visitorId","v1","sessionId","setVisitor","DETAILS","allMeta","productMeta","transform","sendViewProductEvent","product","productId","title","price","category","set","expires","sendSearchEvent","didYouMean","sayt","addToCart","productsInfo","sendAddToCartEvent","order","sendOrderEvent","origin","originalQuery","DEFAULT_STRUCTURE","struct","setTransform","hasVariants","variantStruct","_variantStructure","idField","extractIdField","transformedMeta","productTransform","variants","unpackVariants","variant","Error","remappedMeta","variantMapping","remapVariant","isArray","variantsArray","remappedVariant","_transform","defaultTransform","simple_beautifier_1","url_beautifier_1","parseUri","urlConfig","beautify","beautifier","UrlBeautifier","simple","SimpleBeautifier","parseBeautifiedUrl","parseUrl","isActive","searchUrl","update","build","setLocation","queryParams","queryFromUrl","queryParam","JSON","request","queryObj","stringify","searchandiserConfig","refinementMapping","extraRefinementsParam","queryToken","suffix","UrlGenerator","parser","UrlParser","match","indexOf","push","uri","origRefinements","of","countMap","generateRefinementMap","keys_1","convertRefinement","sort","referenceKey_1","forEach","repeat","lhs","rhs","localeCompare","stringifyRefinement","join","encodeURIComponent","refinementMap","refinementKeys","_loop_1","matchingRefinements","refinement","suffixRegex","RegExp","rawUrl","paths","split","val","pop","generateRefinementMapping","keys_2","withQuery","decode","extractRefinements","unmappedRefinements","extractUnmapped","refinementString","refinementStrings","Number","decodeURIComponent","setTagName","htmlTagName","root","toLowerCase","dataset","getAttribute","_tagName","_simpleTagName","_camelTagName","toUpperCase","setParents","_parents","parent","_parentsList","currTag","setScope","scope","_scope","parent_1","_top","FluxTag","_style","stylish","_mixin","mixins","__proto__","_scopeTo","findParent","parentTag","localName","defaultConfig","SaytTag","DEFAULT_CONFIG","handlers","headers","skipCache","skipSemantish","sortOptions","pageSizes","validate","applyDefaults","defaults","trim","_gbBreadcrumbs","tag2","Breadcrumbs","activation","remove","hideQuery","hideRefinements","labels","resultsLabel","noResultsLabel","correctedResultsLabel","toView","updateQueryState","RESET","clearRefinements","selected","selectedNavigation","correctedQuery","unrefine","_gbCarousel","Carousel","currentIndex","index","Math","min","prev","max","parentOpts","saytConfig","products","subdomain","autocomplete","productSearch","numProducts","updateSectionImages","event","console","dir","updateCategoryImages","_gbCollections","_typeof","Symbol","iterator","selectDropdown","option","selectCustom","label","_gbSelect","Select","optionLabel","optionValue","iconUrl","clearOption","clear","callback","onselect","selectedOption","updateOptions","selectLabel","prepFocus","focused","selectButton","tags","nativeSelect","selector","unfocus","hover","blur","selectOption","selectNative","from","selectedOptions","disabled","text","clearSelection","addEventListener","unFocus","send","dropdown","collectionsService","extractLabels","updateCounts","switchCollection","element","parentElement","_gbDetails","Details","idParam","updateRecord","details","_gbDidYouMean","DidYouMean","updateDidYouMean","rewrite","_gbFilter","updateValues","convertRefinements","navigations","found","find","converted","availableNavigation","skipSearch","reset","refine","_gbNavigation","Navigation","moreRefinements","_gbRefinement","AvailableRefinement","Refinement","_super","SelectedRefinement","badge","showSelected","updateNavigations","REFINEMENT_RESULTS","updateRefinements","processed","processNavigations","replaceRefinements","navigation","selNav","availNav","unshift","_gbPageSize","PageSize","resetOffset","resize","_gbPager","Pager","_gbIcon","Icon","IMAGE_PATTERN","DATA_URL_PREFIX","isImage","classes","matches","_gbPages","Pages","jumpTo","pager","switchPage","_gbPaging","Paging","_gbTerminalPager","TerminalPager","limit","pages","numeric","terminals","icons","first_label","prev_label","next_label","last_label","first_icon","prev_icon","next_icon","last_icon","backDisabled","currentPage","wrapPager","updateCurrentPage","pageInfo","pageNumbers","lastPage","updatePageInfo","lowOverflow","highOverflow","forwardDisabled","first","emitEvent","last","_gbQuery","_gbSubmit","Submit","staticSearch","setSearchBox","submitQuery","searchBox","inputValue","_gbReset","Reset","clearQuery","_gbSayt","_tag","_gbRaw","Raw","updateContent","innerHTML","content","isVisible","nextElementSibling","previousElementSibling","_gbProduct","Product","imageLink","image","variantIndex","detailsUrl","transformRecord","all_meta","link","imageObj","switchVariant","autocomplete_1","escapeStringRegexp","allCategoriesLabel","queries","minimumCharacters","delay","autoSearch","highlight","https","navigationNames","allowedNavigations","MIN_DELAY","showProducts","generateSaytConfig","initializeAutocomplete","AUTOCOMPLETE_HIDE_EVENT","Autocomplete","numSearchTerms","language","fetchSuggestions","handleSuggestions","err","error","processResults","matchesInput","searchProducts","rewriteQuery","REWRITE_QUERY","notifier","isRefinement","categoryField","categoryResults","searchTerms","categoryQuery","extractCategoryResults","displayName","includes","additionalInfo","noRefine","searchRefinement","resetRecall","searchCategory","highlightCurrentQuery","regexReplacement","enhanceCategoryQuery","node","doRefinement","listenForInput","input","debouncedSearch","KEY_UP","KEY_DOWN","KEY_ENTER","KEY_ESCAPE","ACTIVE","searchInput","indexOfSelected","links","selectLink","swapAttributes","linkAbove","linkBelow","querySelectorAll","isSelectedInAutocomplete","removeActiveClass","classList","add","resetSelected","keyboardListener","submitDefault","keyCode","preventDefault","preautocompleteValue","click","enterKeyHandlers","attachListeners","keydownListener","listenForStaticSearch","listenForSubmit","resetToInputValue","onSubmit","f","_gbRecordCount","RecordCount","recordStart","recordEnd","total","_gbRelatedQueries","RelatedQueries","updatedRelatedQueries","relatedQueries","_gbResults","Results","updateRecords","records","userStyle","css","_gbSnippet","Snippet","loadFile","req","XMLHttpRequest","onload","responseText","open","_gbSort","Sort","DEFAULT_SORTS","sortValues","_gbTemplate","Template","updateActive","template","zoneMap","zones","sortZones","list","zone"],"mappings":"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","file":"searchandiser-ui-0.2.27.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t__webpack_require__(1);\r\n\tvar searchandiser_1 = __webpack_require__(8);\r\n\texports.Searchandiser = searchandiser_1.Searchandiser;\r\n\t__webpack_require__(32);\r\n\tvar utils = __webpack_require__(11);\r\n\texports.utils = utils;\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.BrowserBridge = groupby_api_1.BrowserBridge;\r\n\texports.CloudBridge = groupby_api_1.CloudBridge;\r\n\texports.FluxCapacitor = groupby_api_1.FluxCapacitor;\r\n\texports.Query = groupby_api_1.Query;\r\n\tvar sayt_1 = __webpack_require__(29);\r\n\texports.Sayt = sayt_1.Sayt;\r\n\tvar searchandiser = searchandiser_1.initSearchandiser();\r\n\texports.searchandiser = searchandiser;\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t__webpack_require__(2);\r\n\t__webpack_require__(3).shim();\r\n\t__webpack_require__(4).shim();\r\n\t__webpack_require__(5);\r\n\t__webpack_require__(6);\r\n\t__webpack_require__(7);\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"array.of\");\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"array.from\");\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"array-includes\");\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"string.prototype.repeat\");\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"string.prototype.startswith\");\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\tfunction __assignFn(t) {\n\t    for (var s, i = 1, n = arguments.length; i < n; i++) {\n\t        s = arguments[i];\n\t        for (var p in s)\n\t            if (Object.prototype.hasOwnProperty.call(s, p))\n\t                t[p] = s[p];\n\t    }\n\t    return t;\n\t}\n\tfunction __extendsFn(d, b) {\n\t    for (var p in b)\n\t        if (b.hasOwnProperty(p))\n\t            d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t}\n\tfunction __decorateFn(decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n\t        r = Reflect.decorate(decorators, target, key, desc);\n\t    else\n\t        for (var i = decorators.length - 1; i >= 0; i--)\n\t            if (d = decorators[i])\n\t                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t}\n\tfunction __metadataFn(k, v) {\n\t    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\")\n\t        return Reflect.metadata(k, v);\n\t}\n\tfunction __paramFn(paramIndex, decorator) {\n\t    return function (target, key) { decorator(target, key, paramIndex); };\n\t}\n\tfunction __awaiterFn(thisArg, _arguments, P, generator) {\n\t    return new (P || (P = Promise))(function (resolve, reject) {\n\t        function fulfilled(value) { try {\n\t            step(generator.next(value));\n\t        }\n\t        catch (e) {\n\t            reject(e);\n\t        } }\n\t        function rejected(value) { try {\n\t            step(generator.throw(value));\n\t        }\n\t        catch (e) {\n\t            reject(e);\n\t        } }\n\t        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n\t        step((generator = generator.apply(thisArg, _arguments)).next());\n\t    });\n\t}\n\t// hook global helpers\n\t(function (__global) {\n\t    __global.__assign = (__global && __global.__assign) || Object.assign || __assignFn;\n\t    __global.__extends = (__global && __global.__extends) || __extendsFn;\n\t    __global.__decorate = (__global && __global.__decorate) || __decorateFn;\n\t    __global.__metadata = (__global && __global.__metadata) || __metadataFn;\n\t    __global.__param = (__global && __global.__param) || __paramFn;\n\t    __global.__awaiter = (__global && __global.__awaiter) || __awaiterFn;\n\t})(typeof window !== \"undefined\" ? window :\n\t    typeof WorkerGlobalScope !== \"undefined\" ? self :\n\t        typeof global !== \"undefined\" ? global :\n\t            Function(\"return this;\")());\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar init_1 = __webpack_require__(9);\r\n\tvar tag_1 = __webpack_require__(28);\r\n\tvar configuration_1 = __webpack_require__(30);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar riot = __webpack_require__(31);\r\n\texports.CONFIGURATION_MASK = '{collection,area,language,pageSize,sort,fields,customUrlParams,pruneRefinements,disableAutocorrection}'; // tslint:disable:max-line-length\r\n\tfunction initSearchandiser() {\r\n\t    return function configure(rawConfig) {\r\n\t        if (rawConfig === void 0) { rawConfig = {}; }\r\n\t        var config = new configuration_1.Configuration(rawConfig).apply();\r\n\t        var flux = new groupby_api_1.FluxCapacitor(config.customerId, config, exports.CONFIGURATION_MASK);\r\n\t        Object.assign(flux, groupby_api_1.Events);\r\n\t        var services = init_1.initServices(flux, config);\r\n\t        riot.mixin(tag_1.MixinFlux(flux, config, services));\r\n\t        Object.assign(configure, { flux: flux, services: services, config: config }, new Searchandiser()['__proto__']);\r\n\t    };\r\n\t}\r\n\texports.initSearchandiser = initSearchandiser;\r\n\tvar Searchandiser = (function () {\r\n\t    function Searchandiser() {\r\n\t    }\r\n\t    Searchandiser.prototype.init = function () {\r\n\t        if (this.config.initialSearch)\r\n\t            this.search();\r\n\t    };\r\n\t    Searchandiser.prototype.attach = function (tagName, selectorOrOpts, options) {\r\n\t        var tag;\r\n\t        if (typeof selectorOrOpts === 'string') {\r\n\t            tag = this.cssAttach(tagName, selectorOrOpts, options);\r\n\t        }\r\n\t        else {\r\n\t            tag = this.simpleAttach(tagName, selectorOrOpts);\r\n\t        }\r\n\t        if (tag) {\r\n\t            return tag.length === 1 ? tag[0] : tag;\r\n\t        }\r\n\t        else {\r\n\t            return null;\r\n\t        }\r\n\t    };\r\n\t    Searchandiser.prototype.compile = function () {\r\n\t        riot.compile(function () { return null; });\r\n\t    };\r\n\t    Searchandiser.prototype.search = function (query) {\r\n\t        var _this = this;\r\n\t        return this.flux.search(query)\r\n\t            .then(function () { return _this.flux.emit(groupby_api_1.Events.PAGE_CHANGED, { pageNumber: 1, finalPage: _this.flux.page.finalPage }); });\r\n\t    };\r\n\t    Searchandiser.prototype.simpleAttach = function (tagName, options) {\r\n\t        if (options === void 0) { options = {}; }\r\n\t        return riot.mount(this.riotTagName(tagName), options);\r\n\t    };\r\n\t    Searchandiser.prototype.cssAttach = function (tagName, cssSelector, options) {\r\n\t        if (cssSelector === void 0) { cssSelector = \".\" + tagName; }\r\n\t        if (options === void 0) { options = {}; }\r\n\t        return riot.mount(cssSelector, this.riotTagName(tagName), options);\r\n\t    };\r\n\t    Searchandiser.prototype.riotTagName = function (tagName) {\r\n\t        return tagName.startsWith('gb-') ? tagName : \"gb-\" + tagName;\r\n\t    };\r\n\t    return Searchandiser;\r\n\t}());\r\n\texports.Searchandiser = Searchandiser;\r\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar collections_1 = __webpack_require__(10);\r\n\tvar filter_1 = __webpack_require__(17);\r\n\tvar redirect_1 = __webpack_require__(18);\r\n\tvar tracker_1 = __webpack_require__(19);\r\n\tvar url_1 = __webpack_require__(24);\r\n\tvar SERVICES = {\r\n\t    collections: collections_1.Collections,\r\n\t    filter: filter_1.Filter,\r\n\t    redirect: redirect_1.Redirect,\r\n\t    tracker: tracker_1.Tracker,\r\n\t    url: url_1.Url\r\n\t};\r\n\tvar CORE_SERVICES = {\r\n\t    collections: collections_1.Collections,\r\n\t    filter: filter_1.Filter,\r\n\t    tracker: tracker_1.Tracker\r\n\t};\r\n\tfunction initServices(flux, config) {\r\n\t    var servicesConstructors = Object.assign({}, SERVICES, config.services || {}, CORE_SERVICES);\r\n\t    var services = {};\r\n\t    for (var _i = 0, _a = Object.keys(servicesConstructors); _i < _a.length; _i++) {\r\n\t        var key = _a[_i];\r\n\t        services[key] = new servicesConstructors[key](flux, config, services);\r\n\t    }\r\n\t    startServices(services);\r\n\t    return services;\r\n\t}\r\n\texports.initServices = initServices;\r\n\tfunction startServices(services) {\r\n\t    for (var _i = 0, _a = Object.keys(services); _i < _a.length; _i++) {\r\n\t        var key = _a[_i];\r\n\t        if (services[key]) {\r\n\t            services[key].init();\r\n\t        }\r\n\t    }\r\n\t}\r\n\texports.startServices = startServices;\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.COLLECTIONS_UPDATED_EVENT = 'collections_updated';\r\n\tvar Collections = (function () {\r\n\t    function Collections(flux, config) {\r\n\t        this.flux = flux;\r\n\t        this.config = config;\r\n\t        this.counts = {};\r\n\t        this.collectionsConfig = common_1.getPath(config, 'tags.collections') || {};\r\n\t        this.fetchCounts = common_1.unless(this.collectionsConfig.counts, true);\r\n\t        this.options = this.collectionsConfig.options || [];\r\n\t        this.isLabeled = this.options.length !== 0\r\n\t            && typeof this.options[0] === 'object';\r\n\t        this.collections = this.isLabeled\r\n\t            ? this.options.map(function (collection) { return collection.value; })\r\n\t            : this.options;\r\n\t    }\r\n\t    Collections.prototype.init = function () {\r\n\t        var _this = this;\r\n\t        this.flux.on(groupby_api_1.Events.QUERY_CHANGED, function (query) { return _this.updateCollectionCounts(query); });\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, function (results) { return _this.updateSelectedCollectionCount(results); });\r\n\t        this.updateCollectionCounts();\r\n\t    };\r\n\t    Collections.prototype.updateCollectionCounts = function (query) {\r\n\t        var _this = this;\r\n\t        if (query === void 0) { query = ''; }\r\n\t        if (this.fetchCounts) {\r\n\t            if (this.inProgress) {\r\n\t                this.inProgress.cancelled = true;\r\n\t            }\r\n\t            var searches = this.collections\r\n\t                .filter(function (collection) { return !_this.isSelected(collection); })\r\n\t                .map(function (collection) { return _this.flux.bridge\r\n\t                .search(Object.assign(_this.flux.query.raw, { query: query, collection: collection, refinements: [], pageSize: 0, fields: '' }))\r\n\t                .then(function (results) { return ({ results: results, collection: collection }); }); });\r\n\t            var promises_1 = this.inProgress = Promise.all(searches);\r\n\t            promises_1.then(this.extractCounts)\r\n\t                .then(function (counts) {\r\n\t                if (!promises_1.cancelled) {\r\n\t                    Object.assign(_this.counts, counts);\r\n\t                    _this.flux.emit(exports.COLLECTIONS_UPDATED_EVENT, _this.counts);\r\n\t                }\r\n\t            });\r\n\t        }\r\n\t    };\r\n\t    Collections.prototype.extractCounts = function (res) {\r\n\t        return res.reduce(function (counts, _a) {\r\n\t            var results = _a.results, collection = _a.collection;\r\n\t            return Object.assign(counts, (_b = {}, _b[collection] = results.totalRecordCount, _b));\r\n\t            var _b;\r\n\t        }, {});\r\n\t    };\r\n\t    Collections.prototype.updateSelectedCollectionCount = function (res) {\r\n\t        Object.assign(this.counts, (_a = {}, _a[this.selectedCollection] = res.totalRecordCount, _a));\r\n\t        this.flux.emit(exports.COLLECTIONS_UPDATED_EVENT, this.counts);\r\n\t        var _a;\r\n\t    };\r\n\t    Collections.prototype.isSelected = function (collection) {\r\n\t        return collection === this.selectedCollection;\r\n\t    };\r\n\t    Object.defineProperty(Collections.prototype, \"selectedCollection\", {\r\n\t        get: function () {\r\n\t            return common_1.getPath(this.flux, 'query.raw.collection') || this.config.collection;\r\n\t        },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    return Collections;\r\n\t}());\r\n\texports.Collections = Collections;\r\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar debounce = __webpack_require__(12);\r\n\texports.debounce = debounce;\r\n\tvar queryString = __webpack_require__(13);\r\n\tvar filterObject = __webpack_require__(14);\r\n\tvar oget = __webpack_require__(15);\r\n\texports.LOCATION = {\r\n\t    href: function () { return window.location.href; },\r\n\t    setSearch: function (search) { return window.location.search = search; },\r\n\t    getSearch: function () { return window.location.search; },\r\n\t    pathname: function () { return window.location.pathname; },\r\n\t    replace: function (url) { return window.location.replace(url); },\r\n\t    assign: function (url) { return window.location.assign(url); }\r\n\t};\r\n\tfunction findSearchBox() {\r\n\t    return oget(findTag('gb-query'), '_tag.searchBox');\r\n\t}\r\n\texports.findSearchBox = findSearchBox;\r\n\tfunction findTag(tagName) {\r\n\t    return document.querySelector(tagName)\r\n\t        || document.querySelector(\"[data-is=\\\"\" + tagName + \"\\\"]\")\r\n\t        || document.querySelector(\"[riot-tag=\\\"\" + tagName + \"\\\"]\");\r\n\t}\r\n\texports.findTag = findTag;\r\n\tfunction toRefinement(ref, nav) {\r\n\t    return Object.assign({}, filterObject(ref, '{type,value,low,high}'), { navigationName: nav.name });\r\n\t}\r\n\texports.toRefinement = toRefinement;\r\n\tfunction displayRefinement(ref) {\r\n\t    return ref.type === 'Value' ? ref.value : ref.low + \" - \" + ref.high;\r\n\t}\r\n\texports.displayRefinement = displayRefinement;\r\n\tfunction checkNested(obj) {\r\n\t    var keys = [];\r\n\t    for (var _i = 1; _i < arguments.length; _i++) {\r\n\t        keys[_i - 1] = arguments[_i];\r\n\t    }\r\n\t    return Array.prototype.slice.call(arguments, 1)\r\n\t        .reduce(function (res, arg) {\r\n\t        if (!obj || !obj.hasOwnProperty(arg))\r\n\t            return false;\r\n\t        obj = obj[arg];\r\n\t        return res;\r\n\t    }, true);\r\n\t}\r\n\texports.checkNested = checkNested;\r\n\tfunction getParam(param) {\r\n\t    return queryString.parse(exports.LOCATION.getSearch())[param] || null;\r\n\t}\r\n\texports.getParam = getParam;\r\n\tfunction unless(obj) {\r\n\t    var defaultObjs = [];\r\n\t    for (var _i = 1; _i < arguments.length; _i++) {\r\n\t        defaultObjs[_i - 1] = arguments[_i];\r\n\t    }\r\n\t    return obj !== undefined ? obj : unless.apply(void 0, [defaultObjs.splice(0, 1)[0]].concat(defaultObjs));\r\n\t}\r\n\texports.unless = unless;\r\n\tfunction getPath(obj, path) {\r\n\t    if (path === void 0) { path = ''; }\r\n\t    return oget(obj, path);\r\n\t}\r\n\texports.getPath = getPath;\r\n\t/**\r\n\t * Example:\r\n\t * ({x: 3, y: 4, h: 8}, {z: 'x', i: 'h'}) -> {z: 3, i: 8}\r\n\t *\r\n\t * N.B. It removes keys that do not appear in the mapping\r\n\t */\r\n\tfunction remap(obj, mapping) {\r\n\t    if (mapping) {\r\n\t        return Object.keys(mapping).reduce(function (acc, key) {\r\n\t            var value = getPath(obj, mapping[key]);\r\n\t            if (value) {\r\n\t                return Object.assign(acc, (_a = {}, _a[key] = value, _a));\r\n\t            }\r\n\t            else {\r\n\t                return acc;\r\n\t            }\r\n\t            var _a;\r\n\t        }, {});\r\n\t    }\r\n\t    else {\r\n\t        return obj;\r\n\t    }\r\n\t}\r\n\texports.remap = remap;\r\n\tfunction checkBooleanAttr(attribute, opts) {\r\n\t    return typeof opts === 'object'\r\n\t        && attribute in opts\r\n\t        && opts[attribute] != 'false' // tslint:disable-line:triple-equals\r\n\t        && opts[attribute] !== false;\r\n\t}\r\n\texports.checkBooleanAttr = checkBooleanAttr;\r\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"debounce\");\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"query-string\");\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"filter-object\");\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"oget\");\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"groupby-api\");\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar searchandiser_1 = __webpack_require__(8);\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.FILTER_UPDATED_EVENT = 'filter_updated';\r\n\tvar Filter = (function () {\r\n\t    function Filter(flux, config) {\r\n\t        this.flux = flux;\r\n\t        this.config = config;\r\n\t        this.fluxClone = this.clone();\r\n\t        this.filterConfig = common_1.getPath(config, 'tags.filter') || {};\r\n\t    }\r\n\t    Filter.prototype.init = function () {\r\n\t        var _this = this;\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, function () { return _this.updateFluxClone(); });\r\n\t    };\r\n\t    Filter.prototype.updateFluxClone = function () {\r\n\t        var _this = this;\r\n\t        var searchRequest = this.flux.query.raw;\r\n\t        // TODO: this is probably broken in terms of state propagation\r\n\t        this.fluxClone.query.withConfiguration({ refinements: [] });\r\n\t        if (searchRequest.refinements) {\r\n\t            var filteredRefinements = searchRequest.refinements\r\n\t                .filter(function (_a) {\r\n\t                var navigationName = _a.navigationName;\r\n\t                return !_this.isTargetNav(navigationName);\r\n\t            });\r\n\t            (_a = this.fluxClone.query).withSelectedRefinements.apply(_a, filteredRefinements);\r\n\t        }\r\n\t        this.fluxClone.search(searchRequest.query)\r\n\t            .then(function (res) { return _this.flux.emit(exports.FILTER_UPDATED_EVENT, res); });\r\n\t        var _a;\r\n\t    };\r\n\t    Filter.prototype.isTargetNav = function (navName) {\r\n\t        return navName === this.filterConfig.field;\r\n\t    };\r\n\t    Filter.prototype.clone = function () {\r\n\t        return new groupby_api_1.FluxCapacitor(this.config.customerId, this.config, searchandiser_1.CONFIGURATION_MASK);\r\n\t    };\r\n\t    return Filter;\r\n\t}());\r\n\texports.Filter = Filter;\r\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar Redirect = (function () {\r\n\t    function Redirect(flux) {\r\n\t        this.flux = flux;\r\n\t    }\r\n\t    Redirect.prototype.init = function () {\r\n\t        var _this = this;\r\n\t        this.flux.on(groupby_api_1.Events.REDIRECT, function (redirect) { return _this.redirect(redirect); });\r\n\t    };\r\n\t    Redirect.prototype.redirect = function (url) {\r\n\t        common_1.LOCATION.assign(url);\r\n\t    };\r\n\t    return Redirect;\r\n\t}());\r\n\texports.Redirect = Redirect;\r\n\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar product_transformer_1 = __webpack_require__(20);\r\n\tvar GbTracker = __webpack_require__(21);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar Cookies = __webpack_require__(22);\r\n\tvar uuid = __webpack_require__(23);\r\n\texports.MAX_COOKIE_AGE = 365; // days\r\n\texports.VISITOR_COOKIE_KEY = 'visitor';\r\n\texports.SESSION_COOKIE_KEY = 'session';\r\n\tvar Tracker = (function () {\r\n\t    function Tracker(flux, config) {\r\n\t        this.flux = flux;\r\n\t        this.config = config;\r\n\t        this._config = this.config.tracker || {};\r\n\t        this.tracker = new GbTracker(this.config.customerId, this.config.area);\r\n\t        this.transformer = new product_transformer_1.ProductTransformer(this.config.structure || {});\r\n\t    }\r\n\t    Tracker.prototype.init = function () {\r\n\t        this.setVisitorInfo();\r\n\t        this.listenForViewProduct();\r\n\t    };\r\n\t    Tracker.prototype.setVisitorInfo = function () {\r\n\t        var visitorId = this._config.visitorId\r\n\t            || Cookies.get(exports.VISITOR_COOKIE_KEY)\r\n\t            || uuid.v1();\r\n\t        var sessionId = this._config.sessionId\r\n\t            || Cookies.get(exports.SESSION_COOKIE_KEY)\r\n\t            || uuid.v1();\r\n\t        this.setVisitor(visitorId, sessionId);\r\n\t    };\r\n\t    Tracker.prototype.listenForViewProduct = function () {\r\n\t        var _this = this;\r\n\t        this.flux.on(groupby_api_1.Events.DETAILS, function (_a) {\r\n\t            var allMeta = _a.allMeta;\r\n\t            var productMeta = _this.transformer.transform(allMeta);\r\n\t            _this.tracker.sendViewProductEvent({\r\n\t                product: {\r\n\t                    productId: productMeta().id,\r\n\t                    title: productMeta().title,\r\n\t                    price: productMeta().price,\r\n\t                    category: 'NONE'\r\n\t                }\r\n\t            });\r\n\t        });\r\n\t    };\r\n\t    Tracker.prototype.setVisitor = function (visitorId, sessionId) {\r\n\t        this.tracker.setVisitor(visitorId, sessionId);\r\n\t        Cookies.set(exports.VISITOR_COOKIE_KEY, visitorId, { expires: exports.MAX_COOKIE_AGE });\r\n\t        Cookies.set(exports.SESSION_COOKIE_KEY, sessionId);\r\n\t    };\r\n\t    Tracker.prototype.search = function () {\r\n\t        this.sendSearchEvent();\r\n\t    };\r\n\t    Tracker.prototype.didYouMean = function () {\r\n\t        this.sendSearchEvent('dym');\r\n\t    };\r\n\t    Tracker.prototype.sayt = function () {\r\n\t        this.sendSearchEvent('sayt');\r\n\t    };\r\n\t    Tracker.prototype.addToCart = function (productsInfo) {\r\n\t        this.tracker.sendAddToCartEvent(productsInfo);\r\n\t    };\r\n\t    Tracker.prototype.order = function (productsInfo) {\r\n\t        this.tracker.sendOrderEvent(productsInfo);\r\n\t    };\r\n\t    Tracker.prototype.sendSearchEvent = function (origin) {\r\n\t        if (origin === void 0) { origin = 'search'; }\r\n\t        this.tracker.sendSearchEvent({\r\n\t            search: Object.assign({\r\n\t                origin: (_a = {}, _a[origin] = true, _a),\r\n\t                query: this.flux.results.originalQuery || ''\r\n\t            }, this.flux.results)\r\n\t        });\r\n\t        var _a;\r\n\t    };\r\n\t    return Tracker;\r\n\t}());\r\n\texports.Tracker = Tracker;\r\n\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar filterObject = __webpack_require__(14);\r\n\tvar DEFAULT_STRUCTURE = {\r\n\t    id: 'id'\r\n\t};\r\n\tvar ProductTransformer = (function () {\r\n\t    function ProductTransformer(struct) {\r\n\t        this.struct = Object.assign({}, DEFAULT_STRUCTURE, struct);\r\n\t        this.setTransform();\r\n\t        this.hasVariants = 'variants' in struct;\r\n\t        this.variantStruct = this.struct._variantStructure || this.struct;\r\n\t        this.idField = this.extractIdField();\r\n\t    }\r\n\t    ProductTransformer.prototype.transform = function (allMeta) {\r\n\t        var transformedMeta = this.productTransform(allMeta);\r\n\t        var variants = this.unpackVariants(transformedMeta);\r\n\t        var productMeta = function (variant) {\r\n\t            if (variant === void 0) { variant = 0; }\r\n\t            if (variant >= variants.length) {\r\n\t                throw new Error(\"cannot access the variant at index \" + variant);\r\n\t            }\r\n\t            else {\r\n\t                return variants[variant];\r\n\t            }\r\n\t        };\r\n\t        productMeta.variants = variants;\r\n\t        productMeta.transformedMeta = transformedMeta;\r\n\t        return productMeta;\r\n\t    };\r\n\t    ProductTransformer.prototype.unpackVariants = function (allMeta) {\r\n\t        var struct = filterObject(this.struct, '!_*');\r\n\t        var variantStruct = filterObject(this.variantStruct, '!_*');\r\n\t        var remappedMeta = common_1.remap(allMeta, struct);\r\n\t        var variantMapping = this.remapVariant(remappedMeta, variantStruct);\r\n\t        if (this.hasVariants && Array.isArray(common_1.getPath(allMeta, struct.variants))) {\r\n\t            var variantsArray = common_1.getPath(allMeta, struct.variants)\r\n\t                .filter(function (variant) { return variant; });\r\n\t            if (variantsArray.length > 0) {\r\n\t                return variantsArray.map(variantMapping);\r\n\t            }\r\n\t        }\r\n\t        return [filterObject(remappedMeta, '!variants')];\r\n\t    };\r\n\t    ProductTransformer.prototype.remapVariant = function (remappedMeta, variantStruct) {\r\n\t        return function (variant) {\r\n\t            var remappedVariant = common_1.remap(variant, variantStruct);\r\n\t            return filterObject(Object.assign({}, remappedMeta, remappedVariant), '!variants');\r\n\t        };\r\n\t    };\r\n\t    ProductTransformer.prototype.extractIdField = function () {\r\n\t        // ensure we actually want the nested id\r\n\t        if (this.hasVariants && this.struct._variantStructure && this.variantStruct.id) {\r\n\t            return this.struct.variants + \".\" + this.variantStruct.id;\r\n\t        }\r\n\t        else {\r\n\t            return this.struct.id;\r\n\t        }\r\n\t    };\r\n\t    ProductTransformer.prototype.setTransform = function () {\r\n\t        if (typeof this.struct._transform === 'function') {\r\n\t            this.productTransform = this.struct._transform;\r\n\t        }\r\n\t        else {\r\n\t            this.productTransform = this.defaultTransform;\r\n\t        }\r\n\t    };\r\n\t    ProductTransformer.prototype.defaultTransform = function (allMeta) {\r\n\t        return allMeta;\r\n\t    };\r\n\t    return ProductTransformer;\r\n\t}());\r\n\texports.ProductTransformer = ProductTransformer;\r\n\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"gb-tracker-client\");\n\n/***/ },\n/* 22 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"js-cookie\");\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"node-uuid\");\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar simple_beautifier_1 = __webpack_require__(25);\r\n\tvar url_beautifier_1 = __webpack_require__(27);\r\n\tvar parseUri = __webpack_require__(26);\r\n\tvar Url = (function () {\r\n\t    function Url(flux, config, services) {\r\n\t        this.flux = flux;\r\n\t        this.config = config;\r\n\t        this.services = services;\r\n\t        this.urlConfig = this.config.url || {};\r\n\t        this.beautify = !!this.urlConfig.beautifier;\r\n\t    }\r\n\t    Url.prototype.init = function () {\r\n\t        var _this = this;\r\n\t        this.beautifier = new url_beautifier_1.UrlBeautifier(this.config);\r\n\t        this.simple = new simple_beautifier_1.SimpleBeautifier(this.config);\r\n\t        if (!this.config.initialSearch) {\r\n\t            var query = void 0;\r\n\t            if (this.beautify) {\r\n\t                query = Url.parseBeautifiedUrl(this.beautifier);\r\n\t            }\r\n\t            else {\r\n\t                query = Url.parseUrl(this.simple);\r\n\t            }\r\n\t            if (query) {\r\n\t                this.flux.query = query;\r\n\t                this.flux.search(query.raw.query)\r\n\t                    .then(function () { return _this.services.tracker.search(); });\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    Url.prototype.isActive = function () {\r\n\t        return common_1.LOCATION.pathname() !== this.urlConfig.searchUrl;\r\n\t    };\r\n\t    Url.prototype.update = function (query) {\r\n\t        var url = (this.beautify ? this.beautifier : this.simple).build(query);\r\n\t        Url.setLocation(url, this.urlConfig);\r\n\t    };\r\n\t    Url.parseUrl = function (simple) {\r\n\t        return simple.parse(common_1.LOCATION.href());\r\n\t    };\r\n\t    Url.parseBeautifiedUrl = function (beautifier) {\r\n\t        return beautifier.parse(common_1.LOCATION.href());\r\n\t    };\r\n\t    // TODO: better way to do this is with browser history rewrites\r\n\t    Url.setLocation = function (url, config) {\r\n\t        if (common_1.LOCATION.pathname() === config.searchUrl) {\r\n\t            common_1.LOCATION.setSearch(\"?\" + parseUri(url).query);\r\n\t        }\r\n\t        else {\r\n\t            common_1.LOCATION.replace(url);\r\n\t        }\r\n\t    };\r\n\t    return Url;\r\n\t}());\r\n\texports.Url = Url;\r\n\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar searchandiser_1 = __webpack_require__(8);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar parseUri = __webpack_require__(26);\r\n\tvar queryString = __webpack_require__(13);\r\n\tvar SimpleBeautifier = (function () {\r\n\t    function SimpleBeautifier(config) {\r\n\t        this.config = config;\r\n\t        this.urlConfig = config.url || {};\r\n\t    }\r\n\t    SimpleBeautifier.prototype.parse = function (url) {\r\n\t        var queryParams = queryString.parse(parseUri(url).query);\r\n\t        var queryFromUrl = new groupby_api_1.Query(queryParams[this.urlConfig.queryParam] || '')\r\n\t            .withConfiguration(this.config, searchandiser_1.CONFIGURATION_MASK);\r\n\t        if (queryParams.refinements) {\r\n\t            var refinements = JSON.parse(queryParams.refinements);\r\n\t            if (refinements.length > 0) {\r\n\t                queryFromUrl.withSelectedRefinements.apply(queryFromUrl, refinements);\r\n\t            }\r\n\t        }\r\n\t        return queryFromUrl;\r\n\t    };\r\n\t    SimpleBeautifier.prototype.build = function (query) {\r\n\t        var request = query.build();\r\n\t        var queryObj = {};\r\n\t        if ('refinements' in request && request.refinements.length > 0) {\r\n\t            queryObj['refinements'] = JSON.stringify(request.refinements);\r\n\t        }\r\n\t        queryObj[this.urlConfig.queryParam] = request.query;\r\n\t        return this.urlConfig.searchUrl + \"?\" + queryString.stringify(queryObj);\r\n\t    };\r\n\t    return SimpleBeautifier;\r\n\t}());\r\n\texports.SimpleBeautifier = SimpleBeautifier;\r\n\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"parseUri\");\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar searchandiser_1 = __webpack_require__(8);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar parseUri = __webpack_require__(26);\r\n\tvar queryString = __webpack_require__(13);\r\n\tvar UrlBeautifier = (function () {\r\n\t    function UrlBeautifier(searchandiserConfig) {\r\n\t        if (searchandiserConfig === void 0) { searchandiserConfig = {}; }\r\n\t        this.searchandiserConfig = searchandiserConfig;\r\n\t        this.config = {\r\n\t            refinementMapping: [],\r\n\t            extraRefinementsParam: 'refinements',\r\n\t            queryToken: 'q',\r\n\t            suffix: ''\r\n\t        };\r\n\t        this.generator = new UrlGenerator(this);\r\n\t        this.parser = new UrlParser(this);\r\n\t        var urlConfig = searchandiserConfig.url || {};\r\n\t        var config = typeof urlConfig.beautifier === 'object' ? urlConfig.beautifier : {};\r\n\t        Object.assign(this.config, config);\r\n\t        var keys = [];\r\n\t        for (var _i = 0, _a = this.config.refinementMapping; _i < _a.length; _i++) {\r\n\t            var mapping = _a[_i];\r\n\t            var key = Object.keys(mapping)[0];\r\n\t            if (key.length !== 1) {\r\n\t                throw new Error('refinement mapping token must be a single character');\r\n\t            }\r\n\t            if (key.match(/[aeiouy]/)) {\r\n\t                throw new Error('refinement mapping token must not be a vowel');\r\n\t            }\r\n\t            if (keys.indexOf(key) > -1) {\r\n\t                throw new Error('refinement mapping tokens must be unique');\r\n\t            }\r\n\t            keys.push(key);\r\n\t        }\r\n\t        if (this.config.queryToken.length !== 1) {\r\n\t            throw new Error('query token must be a single character');\r\n\t        }\r\n\t        if (this.config.queryToken.match(/[aeiouy]/)) {\r\n\t            throw new Error('query token must not be a vowel');\r\n\t        }\r\n\t        if (keys.indexOf(this.config.queryToken) > -1) {\r\n\t            throw new Error('query token must be unique from refinement tokens');\r\n\t        }\r\n\t    }\r\n\t    UrlBeautifier.prototype.parse = function (url) {\r\n\t        return this.parser.parse(url);\r\n\t    };\r\n\t    UrlBeautifier.prototype.build = function (query) {\r\n\t        return this.generator.build(query);\r\n\t    };\r\n\t    return UrlBeautifier;\r\n\t}());\r\n\texports.UrlBeautifier = UrlBeautifier;\r\n\tvar UrlGenerator = (function () {\r\n\t    function UrlGenerator(_a) {\r\n\t        var config = _a.config;\r\n\t        this.config = config;\r\n\t    }\r\n\t    UrlGenerator.prototype.build = function (query) {\r\n\t        var request = query.build();\r\n\t        var uri = {\r\n\t            path: [],\r\n\t            query: ''\r\n\t        };\r\n\t        // let url = '';\r\n\t        var origRefinements = Array.of.apply(Array, request.refinements);\r\n\t        var countMap = {};\r\n\t        var _a = this.generateRefinementMap(origRefinements), map = _a.map, keys = _a.keys;\r\n\t        // add query\r\n\t        if (request.query) {\r\n\t            uri.path.push(request.query);\r\n\t        }\r\n\t        // add refinements\r\n\t        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n\t            var key = keys_1[_i];\r\n\t            var refinements = map[key];\r\n\t            countMap[key] = refinements.length;\r\n\t            (_b = uri.path).push.apply(_b, refinements.map(this.convertRefinement).sort());\r\n\t        }\r\n\t        // add reference key\r\n\t        if (keys.length || request.query) {\r\n\t            var referenceKey_1 = '';\r\n\t            if (request.query)\r\n\t                referenceKey_1 += this.config.queryToken;\r\n\t            keys.forEach(function (key) { return referenceKey_1 += key.repeat(countMap[key]); });\r\n\t            uri.path.push(referenceKey_1);\r\n\t        }\r\n\t        // add remaining refinements\r\n\t        if (origRefinements.length) {\r\n\t            uri.query = origRefinements\r\n\t                .sort(function (lhs, rhs) { return lhs.navigationName.localeCompare(rhs.navigationName); })\r\n\t                .map(this.stringifyRefinement)\r\n\t                .join('~');\r\n\t        }\r\n\t        var url = \"/\" + uri.path.map(function (path) { return encodeURIComponent(path); }).join('/');\r\n\t        if (this.config.suffix)\r\n\t            url += \"/\" + this.config.suffix.replace(/^\\/+/, '');\r\n\t        if (uri.query)\r\n\t            url += \"?\" + this.config.extraRefinementsParam + \"=\" + encodeURIComponent(uri.query);\r\n\t        return url.replace(/\\s|%20/g, '+');\r\n\t        var _b;\r\n\t    };\r\n\t    UrlGenerator.prototype.generateRefinementMap = function (refinements) {\r\n\t        var refinementMap = {};\r\n\t        var refinementKeys = [];\r\n\t        var _loop_1 = function(mapping) {\r\n\t            var key = Object.keys(mapping)[0];\r\n\t            var matchingRefinements = refinements.filter(function (refinement) { return refinement.navigationName === mapping[key]; });\r\n\t            if (matchingRefinements.length) {\r\n\t                refinementKeys.push(key);\r\n\t                refinementMap[key] = matchingRefinements;\r\n\t                matchingRefinements.forEach(function (ref) { return refinements.splice(refinements.indexOf(ref), 1); });\r\n\t            }\r\n\t        };\r\n\t        for (var _i = 0, _a = this.config.refinementMapping; _i < _a.length; _i++) {\r\n\t            var mapping = _a[_i];\r\n\t            _loop_1(mapping);\r\n\t        }\r\n\t        return { map: refinementMap, keys: refinementKeys };\r\n\t    };\r\n\t    UrlGenerator.prototype.convertRefinement = function (refinement) {\r\n\t        if (refinement.type === 'Value') {\r\n\t            return refinement.value;\r\n\t        }\r\n\t        else {\r\n\t            throw new Error('cannot map range refinements');\r\n\t        }\r\n\t    };\r\n\t    UrlGenerator.prototype.stringifyRefinement = function (refinement) {\r\n\t        var name = refinement.navigationName;\r\n\t        if (refinement.type === 'Value') {\r\n\t            return name + \"=\" + refinement.value;\r\n\t        }\r\n\t        else {\r\n\t            return name + \":\" + refinement.low + \"..\" + refinement.high;\r\n\t        }\r\n\t    };\r\n\t    return UrlGenerator;\r\n\t}());\r\n\texports.UrlGenerator = UrlGenerator;\r\n\tvar UrlParser = (function () {\r\n\t    function UrlParser(_a) {\r\n\t        var config = _a.config, searchandiserConfig = _a.searchandiserConfig;\r\n\t        this.config = config;\r\n\t        this.searchandiserConfig = searchandiserConfig;\r\n\t        this.suffixRegex = new RegExp(\"^\" + this.config.suffix);\r\n\t    }\r\n\t    UrlParser.prototype.parse = function (rawUrl) {\r\n\t        var url = parseUri(rawUrl);\r\n\t        var paths = url.path.split('/').filter(function (val) { return val; });\r\n\t        if (paths[paths.length - 1] === this.config.suffix)\r\n\t            paths.pop();\r\n\t        var keys = (paths.pop() || '').split('');\r\n\t        var map = this.generateRefinementMapping();\r\n\t        var query = new groupby_api_1.Query().withConfiguration(this.searchandiserConfig, searchandiser_1.CONFIGURATION_MASK);\r\n\t        for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {\r\n\t            var key = keys_2[_i];\r\n\t            if (!(key in map || key === this.config.queryToken)) {\r\n\t                throw new Error(\"unexpected token '\" + key + \"' found in reference\");\r\n\t            }\r\n\t        }\r\n\t        if (paths.length < keys.length)\r\n\t            throw new Error('token reference is invalid');\r\n\t        // remove prefixed paths\r\n\t        paths.splice(0, paths.length - keys.length);\r\n\t        for (var i = 0; i < keys.length; i++) {\r\n\t            if (keys[i] === this.config.queryToken) {\r\n\t                query.withQuery(this.decode(paths[i]));\r\n\t            }\r\n\t            else {\r\n\t                query.withSelectedRefinements.apply(query, this.extractRefinements(paths[i], map[keys[i]]));\r\n\t            }\r\n\t        }\r\n\t        var unmappedRefinements = queryString.parse(url.query)[this.config.extraRefinementsParam];\r\n\t        if (unmappedRefinements)\r\n\t            query.withSelectedRefinements.apply(query, this.extractUnmapped(unmappedRefinements));\r\n\t        return query;\r\n\t    };\r\n\t    UrlParser.prototype.generateRefinementMapping = function () {\r\n\t        return this.config.refinementMapping.reduce(function (map, mapping) { return Object.assign(map, mapping); }, {});\r\n\t    };\r\n\t    UrlParser.prototype.extractRefinements = function (refinementString, navigationName) {\r\n\t        var _this = this;\r\n\t        var refinementStrings = refinementString.split('~');\r\n\t        return refinementStrings.map(function (value) { return ({ navigationName: navigationName, type: 'Value', value: _this.decode(value) }); });\r\n\t    };\r\n\t    UrlParser.prototype.extractUnmapped = function (refinementString) {\r\n\t        var refinementStrings = refinementString.split('~');\r\n\t        return refinementStrings\r\n\t            .map(this.decode)\r\n\t            .map(function (refinement) {\r\n\t            var _a = refinement.split(/=|:/), navigationName = _a[0], value = _a[1];\r\n\t            if (value.indexOf('..') >= 0) {\r\n\t                var _b = value.split('..'), low = _b[0], high = _b[1];\r\n\t                return { navigationName: navigationName, low: Number(low), high: Number(high), type: 'Range' };\r\n\t            }\r\n\t            else {\r\n\t                return { navigationName: navigationName, value: value, type: 'Value' };\r\n\t            }\r\n\t        });\r\n\t    };\r\n\t    UrlParser.prototype.decode = function (value) {\r\n\t        return decodeURIComponent(value.replace('+', ' '));\r\n\t    };\r\n\t    return UrlParser;\r\n\t}());\r\n\texports.UrlParser = UrlParser;\r\n\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar sayt_1 = __webpack_require__(29);\r\n\tvar sayt = new sayt_1.Sayt();\r\n\tvar FluxTag = (function () {\r\n\t    function FluxTag() {\r\n\t    }\r\n\t    FluxTag.prototype.init = function () {\r\n\t        this._style = this.config.stylish ? 'gb-stylish' : '';\r\n\t        setTagName(this);\r\n\t        setParents(this);\r\n\t        setScope(this);\r\n\t    };\r\n\t    FluxTag.prototype._mixin = function () {\r\n\t        var mixins = [];\r\n\t        for (var _i = 0; _i < arguments.length; _i++) {\r\n\t            mixins[_i - 0] = arguments[_i];\r\n\t        }\r\n\t        this.mixin.apply(this, mixins.map(function (mixin) { return new mixin().__proto__; }));\r\n\t    };\r\n\t    FluxTag.prototype._scopeTo = function (scope) {\r\n\t        this._scope = this._parents[scope];\r\n\t    };\r\n\t    FluxTag.prototype.findParent = function (tag, name) {\r\n\t        var parentTag = tag;\r\n\t        while (parentTag.root.localName !== name && parentTag.parent) {\r\n\t            parentTag = parentTag.parent;\r\n\t        }\r\n\t        return parentTag;\r\n\t    };\r\n\t    FluxTag.prototype.configure = function (defaultConfig) {\r\n\t        if (defaultConfig === void 0) { defaultConfig = {}; }\r\n\t        var rawConfig = Object.assign({}, defaultConfig, common_1.getPath(this.config, \"tags.\" + this._camelTagName), this.opts.__proto__, this.opts);\r\n\t        for (var _i = 0, _a = Object.keys(rawConfig); _i < _a.length; _i++) {\r\n\t            var key = _a[_i];\r\n\t            if (typeof defaultConfig[key] === 'boolean'\r\n\t                || rawConfig[key] == true // tslint:disable-line:triple-equals\r\n\t                || rawConfig[key] == false) {\r\n\t                rawConfig[key] = common_1.checkBooleanAttr(key, rawConfig);\r\n\t            }\r\n\t        }\r\n\t        this._config = rawConfig;\r\n\t    };\r\n\t    return FluxTag;\r\n\t}());\r\n\texports.FluxTag = FluxTag;\r\n\tvar SaytTag = (function () {\r\n\t    function SaytTag() {\r\n\t    }\r\n\t    SaytTag.prototype.init = function () {\r\n\t        this.sayt = sayt;\r\n\t    };\r\n\t    return SaytTag;\r\n\t}());\r\n\texports.SaytTag = SaytTag;\r\n\tfunction setTagName(tag) {\r\n\t    var htmlTagName = tag.root.tagName.toLowerCase();\r\n\t    var tagName = htmlTagName.startsWith('gb-') ?\r\n\t        htmlTagName :\r\n\t        tag.root.dataset['is'] || tag.root.getAttribute('riot-tag');\r\n\t    if (tagName) {\r\n\t        tag._tagName = tagName;\r\n\t        tag._simpleTagName = tag._tagName.replace(/^gb-/, '');\r\n\t        tag._camelTagName = tag._simpleTagName.replace(/-([a-z])/g, function (match) { return match[1].toUpperCase(); });\r\n\t    }\r\n\t}\r\n\texports.setTagName = setTagName;\r\n\tfunction setParents(tag) {\r\n\t    tag._parents = tag.parent ? Object.assign({}, tag.parent['_parents']) : {};\r\n\t    if (tag._tagName) {\r\n\t        tag._parents[tag._tagName] = tag;\r\n\t    }\r\n\t    tag._parentsList = [];\r\n\t    var currTag = tag;\r\n\t    while (currTag = currTag.parent)\r\n\t        tag._parentsList.push(currTag);\r\n\t}\r\n\texports.setParents = setParents;\r\n\t// somehow this function isn't working for the gb-select inside gb-sort\r\n\tfunction setScope(tag) {\r\n\t    if (tag._parents && tag._parents[tag.opts.scope]) {\r\n\t        tag._scope = tag._parents[tag.opts.scope];\r\n\t    }\r\n\t    else if (tag.parent && tag.parent._scope) {\r\n\t        tag._scope = tag.parent._scope;\r\n\t    }\r\n\t    else {\r\n\t        var parent_1 = tag;\r\n\t        while (parent_1.parent)\r\n\t            tag._scope = parent_1 = parent_1.parent;\r\n\t        tag._top = tag._scope;\r\n\t    }\r\n\t}\r\n\texports.setScope = setScope;\r\n\tfunction MixinFlux(flux, config, services) {\r\n\t    return Object.assign(new FluxTag()['__proto__'], { flux: flux, config: config, services: services });\r\n\t}\r\n\texports.MixinFlux = MixinFlux;\r\n\n\n/***/ },\n/* 29 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"sayt\");\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar oget = __webpack_require__(15);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    initialSearch: true,\r\n\t    url: {\r\n\t        queryParam: 'q',\r\n\t        searchUrl: 'search'\r\n\t    }\r\n\t};\r\n\tvar Configuration = (function () {\r\n\t    function Configuration(rawConfig) {\r\n\t        var _this = this;\r\n\t        this.rawConfig = rawConfig;\r\n\t        this.handlers = {\r\n\t            bridge: function (config) {\r\n\t                if (config === void 0) { config = {}; }\r\n\t                var headers = config.headers || {};\r\n\t                if (config.skipCache) {\r\n\t                    headers['Skip-Caching'] = 'true';\r\n\t                }\r\n\t                if (config.skipSemantish) {\r\n\t                    headers['Skip-Semantish'] = 'true';\r\n\t                }\r\n\t                return Object.assign(config, { headers: headers });\r\n\t            },\r\n\t            sort: function (sort) {\r\n\t                if (!sort) {\r\n\t                    var sortOptions = oget(_this.rawConfig, 'tags.sort.options');\r\n\t                    if (sortOptions && sortOptions.length > 0) {\r\n\t                        return sortOptions.map(function (val) { return val.value; })[0];\r\n\t                    }\r\n\t                }\r\n\t                return sort;\r\n\t            },\r\n\t            pageSize: function (pageSize) {\r\n\t                if (!pageSize) {\r\n\t                    var pageSizes = _this.rawConfig.pageSizes;\r\n\t                    if (pageSizes && pageSizes.length > 0) {\r\n\t                        return pageSizes[0];\r\n\t                    }\r\n\t                }\r\n\t                return pageSize;\r\n\t            }\r\n\t        };\r\n\t    }\r\n\t    Configuration.prototype.apply = function () {\r\n\t        Configuration.validate(this.rawConfig);\r\n\t        var config = Configuration.applyDefaults(this.rawConfig, exports.DEFAULT_CONFIG);\r\n\t        return Configuration.transform(config, this.handlers);\r\n\t    };\r\n\t    Configuration.applyDefaults = function (config, defaults) {\r\n\t        for (var _i = 0, _a = Object.keys(defaults); _i < _a.length; _i++) {\r\n\t            var key = _a[_i];\r\n\t            if (typeof defaults[key] === 'object') {\r\n\t                config[key] = Object.assign(config[key] || {}, defaults[key]);\r\n\t            }\r\n\t            else {\r\n\t                config[key] = defaults[key];\r\n\t            }\r\n\t        }\r\n\t        return config;\r\n\t    };\r\n\t    Configuration.transform = function (config, handlers) {\r\n\t        for (var _i = 0, _a = Object.keys(handlers); _i < _a.length; _i++) {\r\n\t            var key = _a[_i];\r\n\t            config[key] = handlers[key](config[key]);\r\n\t        }\r\n\t        return config;\r\n\t    };\r\n\t    Configuration.validate = function (config) {\r\n\t        if (!config.structure) {\r\n\t            throw 'must provide a record structure';\r\n\t        }\r\n\t        var struct = Object.assign({}, config.structure, config.structure._variantStructure);\r\n\t        if (!(struct.title && struct.title.trim())) {\r\n\t            throw 'structure.title must be the path to the title field';\r\n\t        }\r\n\t        if (!(struct.price && struct.price.trim())) {\r\n\t            throw 'structure.price must be the path to the price field';\r\n\t        }\r\n\t    };\r\n\t    return Configuration;\r\n\t}());\r\n\texports.Configuration = Configuration;\r\n\n\n/***/ },\n/* 31 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"riot\");\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t__webpack_require__(33);\r\n\t__webpack_require__(38);\r\n\t__webpack_require__(40);\r\n\t__webpack_require__(43);\r\n\t__webpack_require__(56);\r\n\t__webpack_require__(59);\r\n\t__webpack_require__(61);\r\n\t__webpack_require__(63);\r\n\t__webpack_require__(69);\r\n\t__webpack_require__(71);\r\n\t__webpack_require__(75);\r\n\t__webpack_require__(77);\r\n\t__webpack_require__(78);\r\n\t__webpack_require__(85);\r\n\t__webpack_require__(95);\r\n\t__webpack_require__(110);\r\n\t__webpack_require__(112);\r\n\t__webpack_require__(89);\r\n\t__webpack_require__(114);\r\n\t__webpack_require__(91);\r\n\t__webpack_require__(47);\r\n\t__webpack_require__(116);\r\n\t__webpack_require__(118);\r\n\t__webpack_require__(87);\r\n\t__webpack_require__(120);\r\n\n\n/***/ },\n/* 33 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(34);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(36);\n\t\n\tvar _gbBreadcrumbs = __webpack_require__(37);\n\t\n\triot.tag2('gb-breadcrumbs', '<yield> <div class=\"gb-breadcrumbs {_style}\"> <gb-query-crumb if=\"{!_config.hideQuery}\"></gb-query-crumb> <gb-list items=\"{selected}\" if=\"{!_config.hideRefinements}\" scope=\"gb-breadcrumbs\"> <gb-list class=\"gb-navigation-crumb\" items=\"{item.refinements}\" inline> <gb-refinement-crumb nav=\"{parent.item}\" ref=\"{item}\"></gb-refinement-crumb> </gb-list> </gb-list> </div> </yield>', 'gb-breadcrumbs .gb-stylish.gb-breadcrumbs,[riot-tag=\"gb-breadcrumbs\"] .gb-stylish.gb-breadcrumbs,[data-is=\"gb-breadcrumbs\"] .gb-stylish.gb-breadcrumbs{ display: flex; justify-content: flex-start; align-items: baseline; }', '', function (opts) {\n\t    this._mixin(_gbBreadcrumbs.Breadcrumbs);\n\t});\n\n/***/ },\n/* 34 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-query-crumb', '<div if=\"{originalQuery}\"> <span if=\"{!_scope.correctedQuery && _scope._config.labels}\" class=\"gb-query-label\">{_scope._config.resultsLabel}</span> <span if=\"{_scope.correctedQuery && _scope._config.labels}\" class=\"gb-query-label\">{_scope._config.noResultsLabel}</span> <span class=\"gb-original-query\">{originalQuery}</span> </div> <div if=\"{correctedQuery}\"> <span if=\"{_scope._config.labels}\" class=\"gb-query-label\">{_scope._config.correctedResultsLabel}</span> <span class=\"gb-corrected-query\">{correctedQuery}</span> </div>', '', '', function (opts) {\n\t    this._scopeTo('gb-breadcrumbs');\n\t});\n\n/***/ },\n/* 35 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-list', '<ul class=\"{_style} {inline: \\'inline\\' in opts}\"> <li each=\"{item, i in opts.items}\" class=\"{active: isActive(i)}\"> <yield></yield> </li> </ul>', 'gb-list > ul.gb-stylish { list-style: none; margin: 0; padding: 0; } gb-list > ul.gb-stylish > li { margin: 0 10px; } gb-list > ul.gb-stylish.inline > li { display: inline-block; } gb-list > ul.gb-stylish a { color: #888; cursor: pointer; } gb-list > ul.gb-stylish a:hover { color: black; }', '', function (opts) {\n\t    this.isActive = opts.activation;\n\t});\n\n/***/ },\n/* 36 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-refinement-crumb', '<a onclick=\"{remove}\">&times;</a> <b>{nav.displayName}: {_scope.toView(ref)}</b>', '', '', function (opts) {\n\t    var _this = this;\n\t\n\t    this.remove = function () {\n\t        return _this._scope.remove(opts.ref, opts.nav);\n\t    };\n\t    this.nav = opts.nav;\n\t    this.ref = opts.ref;\n\t});\n\n/***/ },\n/* 37 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    hideQuery: false,\r\n\t    hideRefinements: false,\r\n\t    labels: true,\r\n\t    resultsLabel: 'Results for:',\r\n\t    noResultsLabel: 'No results for:',\r\n\t    correctedResultsLabel: 'Showing results for:'\r\n\t};\r\n\tvar Breadcrumbs = (function () {\r\n\t    function Breadcrumbs() {\r\n\t    }\r\n\t    Breadcrumbs.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.toView = common_1.displayRefinement;\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updateQueryState);\r\n\t        this.flux.on(groupby_api_1.Events.RESET, this.clearRefinements);\r\n\t    };\r\n\t    Breadcrumbs.prototype.clearRefinements = function () {\r\n\t        this.update({ selected: [] });\r\n\t    };\r\n\t    Breadcrumbs.prototype.updateQueryState = function (_a) {\r\n\t        var originalQuery = _a.originalQuery, selectedNavigation = _a.selectedNavigation, correctedQuery = _a.correctedQuery;\r\n\t        this.update({ originalQuery: originalQuery, selected: selectedNavigation, correctedQuery: correctedQuery });\r\n\t    };\r\n\t    Breadcrumbs.prototype.remove = function (ref, nav) {\r\n\t        this.flux.unrefine(common_1.toRefinement(ref, nav));\r\n\t    };\r\n\t    return Breadcrumbs;\r\n\t}());\r\n\texports.Breadcrumbs = Breadcrumbs;\r\n\n\n/***/ },\n/* 38 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\tvar _gbCarousel = __webpack_require__(39);\n\t\n\triot.tag2('gb-carousel', '<a class=\"gb-carousel__previous-link\" onclick=\"{prev}\">Prev</a> <gb-list items=\"{options}\" activation=\"{isSelected}\"> <yield></yield> </gb-list> <a class=\"gb-carousel__next-link\" onclick=\"{next}\">Next</a>', 'gb-carousel gb-list > ul > li:not(.active),[riot-tag=\"gb-carousel\"] gb-list > ul > li:not(.active),[data-is=\"gb-carousel\"] gb-list > ul > li:not(.active){ display: none; }', '', function (opts) {\n\t    this._mixin(_gbCarousel.Carousel);\n\t});\n\n/***/ },\n/* 39 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar Carousel = (function () {\r\n\t    function Carousel() {\r\n\t    }\r\n\t    Carousel.prototype.init = function () {\r\n\t        this.configure();\r\n\t        this.currentIndex = 0;\r\n\t        this.options = common_1.unless(this._config.options, this._scope.options, []);\r\n\t    };\r\n\t    Carousel.prototype.isSelected = function (index) {\r\n\t        return this.currentIndex === index;\r\n\t    };\r\n\t    Carousel.prototype.next = function () {\r\n\t        this.update({ currentIndex: Math.min(this.currentIndex + 1, this.options.length - 1) });\r\n\t    };\r\n\t    Carousel.prototype.prev = function () {\r\n\t        this.update({ currentIndex: Math.max(this.currentIndex - 1, 0) });\r\n\t    };\r\n\t    return Carousel;\r\n\t}());\r\n\texports.Carousel = Carousel;\r\n\n\n/***/ },\n/* 40 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(41);\n\t\n\t__webpack_require__(42);\n\t\n\triot.tag2('gb-category-menu', '<div class=\"gb-menu {_style}\"> <div class=\"gb-menu__item\" each=\"{opts.sections}\"> <gb-category-dropdown class=\"gb-category-dropdown\"></gb-category-dropdown> </div> </div>', 'gb-category-menu .gb-stylish.gb-menu,[riot-tag=\"gb-category-menu\"] .gb-stylish.gb-menu,[data-is=\"gb-category-menu\"] .gb-stylish.gb-menu{ display: flex; flex-direction: row; justify-content: center; }', '', function (opts) {});\n\n/***/ },\n/* 41 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-category-dropdown', '<div class=\"gb-dropdown {_style}\"> <button type=\"button\" class=\"gb-dropdown__button\">{name}</button> <div class=\"gb-dropdown__content\"> <gb-category-section if=\"{items}\"></gb-category-section> <gb-category-section each=\"{subsections}\" named=\"{true}\"></gb-category-section> </div> <div class=\"gb-dropdown__images\"> <img src=\"\" each=\"{results.images}\"> </div> </div>', 'gb-category-dropdown .gb-dropdown,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown,[data-is=\"gb-category-dropdown\"] .gb-dropdown{ position: relative; display: inline-block; } gb-category-dropdown .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-dropdown__content{ display: none; position: absolute; min-width: 160px; background-color: #fff; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); } gb-category-dropdown .gb-dropdown:hover .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown:hover .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-dropdown:hover .gb-dropdown__content{ display: block; } gb-category-dropdown .gb-stylish .gb-dropdown__button,[riot-tag=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__button,[data-is=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__button{ border: none; cursor: pointer; padding: 16px; width: 100%; } gb-category-dropdown .gb-stylish .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__content{ flex-wrap: wrap; background-color: #f9f9f9; min-width: 272px; } gb-category-dropdown .gb-stylish.gb-dropdown:hover .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-stylish.gb-dropdown:hover .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-stylish.gb-dropdown:hover .gb-dropdown__content{ display: flex; }', '', function (opts) {\n\t  var sayt = __webpack_require__(29);\n\t  this.parentOpts = this.parent.opts;\n\t  var saytConfig = Object.assign({ products: 4 }, this.parentOpts.config.sayt);\n\t\n\t  sayt.configure({\n\t    subdomain: this.parentOpts.config.customerId,\n\t    collection: this.parentOpts.config.collection,\n\t    autocomplete: {},\n\t    productSearch: { area: this.parentOpts.config.area, numProducts: saytConfig.products }\n\t  });\n\t\n\t  this.updateSectionImages = function (event) {\n\t    return console.dir(event.target);\n\t  };\n\t  this.updateCategoryImages = function (event) {\n\t    return console.dir(event.target);\n\t  };\n\t});\n\n/***/ },\n/* 42 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-category-section', '<div class=\"gb-category-section {_style}\"> <a if=\"{opts.named}\" class=\"gb-category-section__header\" onmouseover=\"{updateSectionImages}\" data-try=\"{name}\">{name}</a> <a each=\"{item in items}\" class=\"gb-category-section__link\" onmouseover=\"{updateCategoryImages}\">{item}</a> </div>', 'gb-category-section .gb-stylish.gb-category-section,[riot-tag=\"gb-category-section\"] .gb-stylish.gb-category-section,[data-is=\"gb-category-section\"] .gb-stylish.gb-category-section{ min-width: 120px; flex-wrap: wrap; padding: 6px 8px; } gb-category-section .gb-stylish .gb-category-section__header,[riot-tag=\"gb-category-section\"] .gb-stylish .gb-category-section__header,[data-is=\"gb-category-section\"] .gb-stylish .gb-category-section__header{ padding: 6px 4px; margin: 0; font-size: 1.1em; font-weight: bold; } gb-category-section .gb-stylish a,[riot-tag=\"gb-category-section\"] .gb-stylish a,[data-is=\"gb-category-section\"] .gb-stylish a{ padding: 3px 4px; text-decoration: none; display: block; } gb-category-section .gb-stylish a:hover,[riot-tag=\"gb-category-section\"] .gb-stylish a:hover,[data-is=\"gb-category-section\"] .gb-stylish a:hover{ background-color: #f1f1f1; }', '', function (opts) {\n\t    this.parentOpts = this.parent.parent.opts;\n\t    this.updateSectionImages = this.parent.parent.updateSectionImages;\n\t    this.updateCategoryImages = this.parent.parent.updateCategoryImages;\n\t});\n\n/***/ },\n/* 43 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(44);\n\t\n\t__webpack_require__(46);\n\t\n\t__webpack_require__(45);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(47);\n\t\n\tvar _gbCollections = __webpack_require__(55);\n\t\n\triot.tag2('gb-collections', '<yield> <gb-list class=\"gb-collections {_style}\" items=\"{collections}\" if=\"{!_config.dropdown}\" scope=\"gb-collections\" inline> <gb-collection-item></gb-collection-item> </gb-list> <gb-select if=\"{_config.dropdown}\" scope=\"gb-collections\"> <gb-custom-select> <gb-collection-dropdown-item></gb-collection-dropdown-item> </gb-custom-select> </gb-select> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbCollections.Collections);\n\t});\n\n/***/ },\n/* 44 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(45);\n\t\n\triot.tag2('gb-collection-item', '<a class=\"gb-collection\" data-collection=\"{item}\" onclick=\"{_scope.switchCollection}\"> <span class=\"gb-collection__name\">{_scope.labels[item] || item}</span> <gb-badge if=\"{_scope._config.counts}\">{_scope.counts[item]}</gb-badge> </a>', '', '', function (opts) {});\n\n/***/ },\n/* 45 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-badge', '<span class=\"{_style}\"><yield></yield></span>', 'gb-badge .gb-stylish,[riot-tag=\"gb-badge\"] .gb-stylish,[data-is=\"gb-badge\"] .gb-stylish{ display: inline-block; min-width: 10px; max-height: 20px; padding: 4px 7px; border-radius: 10px; font-size: 12px; font-weight: bold; line-height: 1; color: #fff; background-color: #ccc; text-align: center; white-space: nowrap; vertical-align: middle; }', '', function (opts) {});\n\n/***/ },\n/* 46 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\triot.tag2('gb-collection-dropdown-item', '<a class=\"gb-collection\" onclick=\"{selectDropdown}\"> <span class=\"gb-collection__name\">{option.label || option}</span> <gb-badge>{_scope.counts[option.value || option]}</gb-badge> </a>', '', '', function (opts) {\n\t  var _this = this;\n\t\n\t  this.selectDropdown = function () {\n\t    if (_typeof(_this.option) === 'object') {\n\t      _this._scope.selectCustom(_this.option);\n\t    } else {\n\t      _this._scope.selectCustom({\n\t        label: _this.option,\n\t        value: _this.option\n\t      });\n\t    }\n\t  };\n\t});\n\n/***/ },\n/* 47 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(48);\n\t\n\t__webpack_require__(51);\n\t\n\tvar _gbSelect = __webpack_require__(49);\n\t\n\triot.tag2('gb-select', '<yield> <gb-native-select if=\"{_config.native}\"></gb-native-select> <gb-custom-select if=\"{!_config.native}\"></gb-custom-select> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbSelect.Select);\n\t});\n\n/***/ },\n/* 48 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbSelect = __webpack_require__(49);\n\t\n\triot.tag2('gb-native-select', '<select name=\"selector\" onchange=\"{_scope.selectNative}\"> <option if=\"{!_scope.default}\" value=\"\" selected disabled>{_scope.selectLabel()}</option> <option each=\"{option in _scope.options}\" if=\"{!option.clear}\" value=\"{optionValue(option)}\">{optionLabel(option)}</option> </select>', '', '', function (opts) {\n\t    this.optionLabel = _gbSelect.Select.optionLabel;\n\t    this.optionValue = _gbSelect.Select.optionValue;\n\t    this._scopeTo('gb-select');\n\t});\n\n/***/ },\n/* 49 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar Select = (function () {\r\n\t    function Select() {\r\n\t    }\r\n\t    Select.prototype.init = function () {\r\n\t        this._config = this._scope._config;\r\n\t        this.iconUrl = __webpack_require__(50);\r\n\t        this.label = this._config.label || 'Select';\r\n\t        this.clearOption = { label: this._config.clear || 'Unselect', clear: true };\r\n\t        this.options = this._scope.options || [];\r\n\t        this.callback = this._scope.onselect;\r\n\t        this.default = !('clear' in this._config);\r\n\t        if (this.default) {\r\n\t            this.selectedOption = typeof this.options[0] === 'object' ? this.options[0].label : this.options[0];\r\n\t        }\r\n\t    };\r\n\t    Select.prototype.updateOptions = function (options) {\r\n\t        this.update({ options: this.default ? options : [this.clearOption].concat(options) });\r\n\t    };\r\n\t    Select.prototype.selectLabel = function () {\r\n\t        return this.selectedOption || (this.selected ? this.clearOption : this.label);\r\n\t    };\r\n\t    Select.prototype.prepFocus = function () {\r\n\t        return this.focused = false;\r\n\t    };\r\n\t    Select.prototype.selectButton = function () {\r\n\t        return this.tags['gb-custom-select'].tags['gb-select-button'].root;\r\n\t    };\r\n\t    Select.prototype.nativeSelect = function () {\r\n\t        if (this.tags['gb-native-select']) {\r\n\t            return this.tags['gb-native-select'].selector;\r\n\t        }\r\n\t        else {\r\n\t            return this.root.querySelector('select');\r\n\t        }\r\n\t    };\r\n\t    Select.prototype.unfocus = function () {\r\n\t        this.focused = this._config.hover || !this.focused;\r\n\t        if (!this.focused)\r\n\t            this.selectButton().blur();\r\n\t    };\r\n\t    Select.prototype.selectOption = function (selectedOption, value) {\r\n\t        this.update({ selectedOption: selectedOption });\r\n\t        if (this.callback) {\r\n\t            try {\r\n\t                this.callback(JSON.parse(value));\r\n\t            }\r\n\t            catch (e) {\r\n\t                this.callback(value || '*');\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    Select.prototype.selectNative = function (event) {\r\n\t        var option = Array.from(event.target.selectedOptions)[0];\r\n\t        var selected = option.value;\r\n\t        this.nativeSelect().options[0].disabled = !selected;\r\n\t        this.update({ selected: selected });\r\n\t        this.selectOption(option.text, selected);\r\n\t    };\r\n\t    Select.prototype.selectCustom = function (_a) {\r\n\t        var value = _a.value, label = _a.label;\r\n\t        this.selectButton().blur();\r\n\t        this.selectOption(label, value);\r\n\t    };\r\n\t    Select.prototype.clearSelection = function () {\r\n\t        return this.selectOption(undefined, '*');\r\n\t    };\r\n\t    Select.optionValue = function (option) {\r\n\t        return typeof option === 'object' ? JSON.stringify(option.value) : option;\r\n\t    };\r\n\t    Select.optionLabel = function (option) {\r\n\t        return typeof option === 'object' ? option.label : option;\r\n\t    };\r\n\t    return Select;\r\n\t}());\r\n\texports.Select = Select;\r\n\n\n/***/ },\n/* 50 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAPFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQLyYwAAAAE3RSTlMADQ46Ozw9SElKS0y5x+zz9Pj5WslQRAAAAQdJREFUeJztzlcOwkAQBFFyxjbM/e9KFsbrNGK3V6Cq/1a/yYSIiIiIiIiIiIiIfqRp8kF/q2LtG+yLedT/yk4uwf5sZUTBsjJzCa7/FlFw//cI7v/xBMvSzCV4/scSLF7/ZueN6z+OoPY/TlD7jyI4mLkEH/9mh68Bs6NL0Pg/zr4G+AQJ/l2CJP8OQaL/ULAV/48UJPwfJUj6P0KQ+H9QkPx/QCD4DwU78X+PQPTfKZD9dwiE/60C6X+LQPwfCtT/gUD+3yfQ/HcLVP9dAt1/u0D53ybQ/ocC9X9ToP//FOT4rwvy/L8Fuf5fgnz/D0HO/5sg7/9VkPmfiIiIiIiIiIiIiP6gC0vzP5P1npi3AAAAAElFTkSuQmCC\"\n\n/***/ },\n/* 51 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(52);\n\t\n\t__webpack_require__(53);\n\t\n\t__webpack_require__(54);\n\t\n\triot.tag2('gb-custom-select', '<div class=\"gb-select {_scope._config.hover ? \\'hoverable\\' : \\'clickable\\'} {_style}\"> <button data-is=\"gb-select-button\" type=\"button\"></button> <gb-option-list> <yield> <gb-option option=\"{option}\" send=\"{option.clear ? _scope.clearSelection : _scope.selectCustom}\"></gb-option> </yield> </gb-option-list> </div>', 'gb-custom-select .gb-select,[riot-tag=\"gb-custom-select\"] .gb-select,[data-is=\"gb-custom-select\"] .gb-select{ position: relative; display: inline-block; } gb-custom-select gb-option-list,[riot-tag=\"gb-custom-select\"] gb-option-list,[data-is=\"gb-custom-select\"] gb-option-list{ display: none; z-index: 100; position: absolute; min-width: 160px; background-color: #f6f6f6; box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); max-height: 300px; overflow-y: scroll; } gb-custom-select .gb-select.hoverable:hover gb-option-list,[riot-tag=\"gb-custom-select\"] .gb-select.hoverable:hover gb-option-list,[data-is=\"gb-custom-select\"] .gb-select.hoverable:hover gb-option-list,gb-custom-select .gb-select.clickable button:focus + gb-option-list,[riot-tag=\"gb-custom-select\"] .gb-select.clickable button:focus + gb-option-list,[data-is=\"gb-custom-select\"] .gb-select.clickable button:focus + gb-option-list,gb-custom-select gb-option-list:hover,[riot-tag=\"gb-custom-select\"] gb-option-list:hover,[data-is=\"gb-custom-select\"] gb-option-list:hover{ display: block; } gb-custom-select .gb-stylish.gb-select:hover button,[riot-tag=\"gb-custom-select\"] .gb-stylish.gb-select:hover button,[data-is=\"gb-custom-select\"] .gb-stylish.gb-select:hover button,gb-custom-select .gb-stylish.gb-select button:focus,[riot-tag=\"gb-custom-select\"] .gb-stylish.gb-select button:focus,[data-is=\"gb-custom-select\"] .gb-stylish.gb-select button:focus{ border-color: #aaa; } gb-custom-select button,[riot-tag=\"gb-custom-select\"] button,[data-is=\"gb-custom-select\"] button{ overflow-x: hidden; display: flex; align-items: center; font-size: 14px; border: none; cursor: pointer; padding: 8px 16px; width: 100%; background-color: #eee; border: 2px solid #ddd; border-radius: 4px; white-space: nowrap; } gb-custom-select .gb-stylish button:focus,[riot-tag=\"gb-custom-select\"] .gb-stylish button:focus,[data-is=\"gb-custom-select\"] .gb-stylish button:focus{ outline: none; }', '', function (opts) {\n\t    this._scopeTo('gb-select');\n\t});\n\n/***/ },\n/* 52 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-select-button', '<yield> <span class=\"gb-button__label\">{_scope.selectLabel()}</span> <img riot-src=\"{_scope.iconUrl}\" alt=\"\"> </yield>', 'gb-select-button img,[riot-tag=\"gb-select-button\"] img,[data-is=\"gb-select-button\"] img{ margin-left: 10px; margin-top: 2px; height: 24px; }', '', function (opts) {\n\t    this.root.addEventListener('focus', this._scope.prepFocus);\n\t    this.root.addEventListener('click', this._scope.unFocus);\n\t});\n\n/***/ },\n/* 53 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-option-list', '<ul> <li each=\"{option in _scope.options}\" class=\"gb-select__option {clear: option.clear}\" if=\"{option.clear ? _scope.selectedOption : true}\"> <yield></yield> </li> </ul>', 'gb-option-list ul,[riot-tag=\"gb-option-list\"] ul,[data-is=\"gb-option-list\"] ul{ margin: 0; padding: 0; list-style: none; } gb-option-list ul:hover,[riot-tag=\"gb-option-list\"] ul:hover,[data-is=\"gb-option-list\"] ul:hover{ display: block; } gb-option-list a,[riot-tag=\"gb-option-list\"] a,[data-is=\"gb-option-list\"] a{ cursor: pointer; display: block; text-decoration: none; color: black; padding: 10px 12px; } gb-option-list a:hover,[riot-tag=\"gb-option-list\"] a:hover,[data-is=\"gb-option-list\"] a:hover{ background-color: #eee; }', '', function (opts) {});\n\n/***/ },\n/* 54 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbSelect = __webpack_require__(49);\n\t\n\triot.tag2('gb-option', '<a onclick=\"{send}\">{label}</a>', '', '', function (opts) {\n\t    var _this = this;\n\t\n\t    this.label = _gbSelect.Select.optionLabel(opts.option);\n\t    this.value = _gbSelect.Select.optionValue(opts.option);\n\t    this.send = function () {\n\t        return opts.send(_this);\n\t    };\n\t});\n\n/***/ },\n/* 55 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar collections_1 = __webpack_require__(10);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    options: [],\r\n\t    counts: true,\r\n\t    dropdown: false\r\n\t};\r\n\tvar Collections = (function () {\r\n\t    function Collections() {\r\n\t    }\r\n\t    Collections.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.options = this._config.options;\r\n\t        var collectionsService = this.services.collections;\r\n\t        this.collections = collectionsService.collections;\r\n\t        this.labels = collectionsService.isLabeled\r\n\t            ? this._config.options.reduce(this.extractLabels, {})\r\n\t            : {};\r\n\t        this.flux.on(collections_1.COLLECTIONS_UPDATED_EVENT, this.updateCounts);\r\n\t    };\r\n\t    Collections.prototype.updateCounts = function (counts) {\r\n\t        this.update({ counts: counts });\r\n\t    };\r\n\t    Collections.prototype.switchCollection = function (event) {\r\n\t        var element = event.target;\r\n\t        while (element.tagName !== 'A')\r\n\t            element = element.parentElement;\r\n\t        this.onselect(element.dataset['collection']);\r\n\t    };\r\n\t    Collections.prototype.onselect = function (collection) {\r\n\t        this.flux.switchCollection(collection);\r\n\t    };\r\n\t    Collections.prototype.extractLabels = function (labels, collection) {\r\n\t        return Object.assign(labels, (_a = {}, _a[collection.value] = collection.label, _a));\r\n\t        var _a;\r\n\t    };\r\n\t    return Collections;\r\n\t}());\r\n\texports.Collections = Collections;\r\n\n\n/***/ },\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbDetails = __webpack_require__(57);\n\t\n\triot.tag2('gb-details', '<div class=\"gb-details\"> <yield></yield> </div>', '', '', function (opts) {\n\t    this._mixin(_gbDetails.Details);\n\t});\n\n/***/ },\n/* 57 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar product_transformer_1 = __webpack_require__(20);\r\n\tvar clone = __webpack_require__(58);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    idParam: 'id'\r\n\t};\r\n\tvar Details = (function () {\r\n\t    function Details() {\r\n\t    }\r\n\t    Details.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.query = common_1.getParam(this._config.idParam);\r\n\t        this.struct = this.config.structure || {};\r\n\t        this.transformer = new product_transformer_1.ProductTransformer(this.struct);\r\n\t        this.flux.on(groupby_api_1.Events.DETAILS, this.updateRecord);\r\n\t        if (this.query)\r\n\t            this.flux.details(this.query, this.transformer.idField);\r\n\t    };\r\n\t    Details.prototype.updateRecord = function (_a) {\r\n\t        var allMeta = _a.allMeta;\r\n\t        var productMeta = this.transformer.transform(clone(allMeta, false));\r\n\t        this.update({ productMeta: productMeta, allMeta: productMeta() });\r\n\t    };\r\n\t    return Details;\r\n\t}());\r\n\texports.Details = Details;\r\n\n\n/***/ },\n/* 58 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"clone\");\n\n/***/ },\n/* 59 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\tvar _gbDidYouMean = __webpack_require__(60);\n\t\n\triot.tag2('gb-did-you-mean', '<yield> <gb-list class=\"{_style}\" items=\"{didYouMean}\" scope=\"gb-did-you-mean\" inline> <a onclick=\"{_scope.send}\">{item}</a> </gb-list> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbDidYouMean.DidYouMean);\n\t});\n\n/***/ },\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar DidYouMean = (function () {\r\n\t    function DidYouMean() {\r\n\t    }\r\n\t    DidYouMean.prototype.init = function () {\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updateDidYouMean);\r\n\t    };\r\n\t    DidYouMean.prototype.send = function (event) {\r\n\t        var _this = this;\r\n\t        this.flux.rewrite(event.target.text)\r\n\t            .then(function () { return _this.services.tracker.didYouMean(); });\r\n\t    };\r\n\t    DidYouMean.prototype.updateDidYouMean = function (_a) {\r\n\t        var didYouMean = _a.didYouMean;\r\n\t        this.update({ didYouMean: didYouMean });\r\n\t    };\r\n\t    return DidYouMean;\r\n\t}());\r\n\texports.DidYouMean = DidYouMean;\r\n\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(47);\n\t\n\tvar _gbFilter = __webpack_require__(62);\n\t\n\triot.tag2('gb-filter', '<yield> <gb-select scope=\"gb-filter\"> </gb-select> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbFilter.Filter);\n\t});\n\n/***/ },\n/* 62 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar filter_1 = __webpack_require__(17);\r\n\tvar common_1 = __webpack_require__(11);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    field: undefined,\r\n\t    label: 'Filter',\r\n\t    clear: 'Unfiltered'\r\n\t};\r\n\tvar Filter = (function () {\r\n\t    function Filter() {\r\n\t    }\r\n\t    Filter.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.flux.on(filter_1.FILTER_UPDATED_EVENT, this.updateValues);\r\n\t    };\r\n\t    Filter.prototype.convertRefinements = function (navigations) {\r\n\t        var _this = this;\r\n\t        var found = navigations.find(function (_a) {\r\n\t            var name = _a.name;\r\n\t            return _this.services.filter.isTargetNav(name);\r\n\t        });\r\n\t        return found ? found.refinements.map(function (ref) { return ({ label: ref.value, value: ref }); }) : [];\r\n\t    };\r\n\t    Filter.prototype.updateValues = function (res) {\r\n\t        var converted = this.convertRefinements(res.availableNavigation);\r\n\t        if (this.tags['gb-select']) {\r\n\t            this.tags['gb-select'].updateOptions(converted);\r\n\t        }\r\n\t        else {\r\n\t            this.update({ options: converted });\r\n\t        }\r\n\t    };\r\n\t    Filter.prototype.onselect = function (value) {\r\n\t        if (this.selected)\r\n\t            this.flux.unrefine(this.selected, { skipSearch: true });\r\n\t        if (value === '*') {\r\n\t            this.flux.reset();\r\n\t        }\r\n\t        else {\r\n\t            this.flux.refine(this.selected = common_1.toRefinement(value, { name: this._config.field }));\r\n\t        }\r\n\t    };\r\n\t    return Filter;\r\n\t}());\r\n\texports.Filter = Filter;\r\n\n\n/***/ },\n/* 63 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(64);\n\t\n\t__webpack_require__(65);\n\t\n\t__webpack_require__(67);\n\t\n\tvar _gbNavigation = __webpack_require__(68);\n\t\n\triot.tag2('gb-navigation', '<yield> <div class=\"gb-side-nav {_style}\"> <gb-refinement-list each=\"{nav in processed}\"></gb-refinement-list> </div> </yield>', 'gb-navigation .gb-stylish.gb-side-nav,[riot-tag=\"gb-navigation\"] .gb-stylish.gb-side-nav,[data-is=\"gb-navigation\"] .gb-stylish.gb-side-nav{ padding: 12px; }', '', function (opts) {\n\t    this._mixin(_gbNavigation.Navigation);\n\t});\n\n/***/ },\n/* 64 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-refinement-list', '<div id=\"{nav.name}\" class=\"{_style}\"> <h4 class=\"gb-navigation-title\">{nav.displayName}</h4> <ul> <gb-selected-refinement if=\"{_config.showSelected}\" each=\"{ref in nav.selected}\"></gb-selected-refinement> <gb-available-refinement each=\"{ref in nav.refinements}\"></gb-available-refinement> <li class=\"gb-more-refinements\" if=\"{nav.moreRefinements}\"> <a href=\"#\" onclick=\"{moreRefinements}\">More</a> </li> </ul> </div>', 'gb-refinement-list .gb-stylish.gb-refinement-list .gb-navigation-title,[riot-tag=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list .gb-navigation-title,[data-is=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list .gb-navigation-title{ font-size: 18px; margin: 10px 0; } gb-refinement-list .gb-stylish.gb-refinement-list ul,[riot-tag=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list ul,[data-is=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list ul{ margin: 0; padding-left: 8px; }', '', function (opts) {\n\t  var _this = this;\n\t\n\t  this.moreRefinements = function () {\n\t    _this.flux.refinements(_this.nav.name);\n\t    _this.nav.moreRefinements = false;\n\t  };\n\t});\n\n/***/ },\n/* 65 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(45);\n\t\n\tvar _gbRefinement = __webpack_require__(66);\n\t\n\triot.tag2('gb-available-refinement', '<li class=\"gb-ref {_style}\"> <a class=\"gb-ref__link\" onclick=\"{send}\"> <span class=\"gb-ref__title\">{toView(ref)}</span> <span class=\"gb-filler\"></span> <gb-badge if=\"{_config.badge}\">{ref.count}</gb-badge> </a> </li>', 'gb-available-refinement .gb-stylish,[riot-tag=\"gb-available-refinement\"] .gb-stylish,[data-is=\"gb-available-refinement\"] .gb-stylish{ list-style: none; } gb-available-refinement .gb-stylish .gb-filler,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-filler,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-filler{ flex-grow: 1; } gb-available-refinement .gb-stylish .gb-ref__link,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-ref__link,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-ref__link{ cursor: pointer; display: flex; padding: 4px 6px; border-radius: 4px; color: black; font-size: 14px; text-decoration: none; align-items: baseline; } gb-available-refinement .gb-stylish .gb-ref__link:hover,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-ref__link:hover,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-ref__link:hover{ background-color: #ddd; }', '', function (opts) {\n\t    this._mixin(_gbRefinement.AvailableRefinement);\n\t});\n\n/***/ },\n/* 66 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar Refinement = (function () {\r\n\t    function Refinement() {\r\n\t    }\r\n\t    Refinement.prototype.init = function () {\r\n\t        this._scopeTo('gb-navigation');\r\n\t        this.toView = common_1.displayRefinement;\r\n\t    };\r\n\t    return Refinement;\r\n\t}());\r\n\texports.Refinement = Refinement;\r\n\tvar AvailableRefinement = (function (_super) {\r\n\t    __extends(AvailableRefinement, _super);\r\n\t    function AvailableRefinement() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    AvailableRefinement.prototype.send = function () {\r\n\t        return this._scope.send(this.ref, this.nav);\r\n\t    };\r\n\t    return AvailableRefinement;\r\n\t}(Refinement));\r\n\texports.AvailableRefinement = AvailableRefinement;\r\n\tvar SelectedRefinement = (function (_super) {\r\n\t    __extends(SelectedRefinement, _super);\r\n\t    function SelectedRefinement() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    SelectedRefinement.prototype.remove = function () {\r\n\t        return this._scope.remove(this.ref, this.nav);\r\n\t    };\r\n\t    return SelectedRefinement;\r\n\t}(Refinement));\r\n\texports.SelectedRefinement = SelectedRefinement;\r\n\n\n/***/ },\n/* 67 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbRefinement = __webpack_require__(66);\n\t\n\triot.tag2('gb-selected-refinement', '<li class=\"gb-ref {_style}\"> <a class=\"gb-ref__link\" onclick=\"{remove}\">&times;</a> <span class=\"gb-ref__value\">{toView(ref)}</span> </li>', 'gb-selected-refinement .gb-stylish,[riot-tag=\"gb-selected-refinement\"] .gb-stylish,[data-is=\"gb-selected-refinement\"] .gb-stylish{ position: relative; list-style: none; padding: 4px 6px; font-size: 14px; } gb-selected-refinement .gb-stylish .gb-ref__link,[riot-tag=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link,[data-is=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link{ cursor: pointer; left: -8px; position: absolute; color: black; text-decoration: none; } gb-selected-refinement .gb-stylish .gb-ref__link:hover,[riot-tag=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link:hover,[data-is=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link:hover{ color: red; font-weight: bold; }', '', function (opts) {\n\t    this._mixin(_gbRefinement.SelectedRefinement);\n\t});\n\n/***/ },\n/* 68 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar clone = __webpack_require__(58);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    badge: true,\r\n\t    showSelected: true\r\n\t};\r\n\tvar Navigation = (function () {\r\n\t    function Navigation() {\r\n\t    }\r\n\t    Navigation.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updateNavigations);\r\n\t        this.flux.on(groupby_api_1.Events.REFINEMENT_RESULTS, this.updateRefinements);\r\n\t    };\r\n\t    Navigation.prototype.updateNavigations = function (res) {\r\n\t        this.update({ processed: this.processNavigations(res) });\r\n\t    };\r\n\t    Navigation.prototype.updateRefinements = function (res) {\r\n\t        this.update({ processed: this.replaceRefinements(res) });\r\n\t    };\r\n\t    Navigation.prototype.replaceRefinements = function (res) {\r\n\t        var found = this.processed.find(function (nav) { return nav.name === res.navigation.name; });\r\n\t        if (found) {\r\n\t            found.refinements = res.navigation.refinements;\r\n\t        }\r\n\t        return this.processed;\r\n\t    };\r\n\t    Navigation.prototype.processNavigations = function (_a) {\r\n\t        var selectedNavigation = _a.selectedNavigation, availableNavigation = _a.availableNavigation;\r\n\t        var processed = clone(availableNavigation);\r\n\t        selectedNavigation.forEach(function (selNav) {\r\n\t            var availNav = processed.find(function (nav) { return nav.name === selNav.name; });\r\n\t            if (availNav) {\r\n\t                availNav.selected = selNav.refinements;\r\n\t            }\r\n\t            else {\r\n\t                processed.unshift(Object.assign({}, selNav, { selected: selNav.refinements, refinements: [] }));\r\n\t            }\r\n\t        });\r\n\t        return processed;\r\n\t    };\r\n\t    Navigation.prototype.send = function (ref, nav) {\r\n\t        return this.flux.refine(common_1.toRefinement(ref, nav));\r\n\t    };\r\n\t    Navigation.prototype.remove = function (ref, nav) {\r\n\t        return this.flux.unrefine(common_1.toRefinement(ref, nav));\r\n\t    };\r\n\t    return Navigation;\r\n\t}());\r\n\texports.Navigation = Navigation;\r\n\n\n/***/ },\n/* 69 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(47);\n\t\n\tvar _gbPageSize = __webpack_require__(70);\n\t\n\triot.tag2('gb-page-size', '<yield> <gb-select scope=\"gb-page-size\"> </gb-select> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbPageSize.PageSize);\n\t});\n\n/***/ },\n/* 70 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.DEFAULT_CONFIG = {\r\n\t    resetOffset: false\r\n\t};\r\n\tvar PageSize = (function () {\r\n\t    function PageSize() {\r\n\t    }\r\n\t    PageSize.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.options = this.config.pageSizes || [10, 25, 50, 100];\r\n\t    };\r\n\t    PageSize.prototype.onselect = function (value) {\r\n\t        var _this = this;\r\n\t        this.flux.resize(value, this._config.resetOffset)\r\n\t            .then(function () { return _this.services.tracker.search(); });\r\n\t    };\r\n\t    return PageSize;\r\n\t}());\r\n\texports.PageSize = PageSize;\r\n\n\n/***/ },\n/* 71 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(72);\n\t\n\tvar _gbPager = __webpack_require__(74);\n\t\n\triot.tag2('gb-pager', '<div class=\"gb-pager {_style}\"> <a class=\"gb-pager__link prev {disabled: _scope.backDisabled}\" onclick=\"{_scope.pager.prev}\"> <gb-icon if=\"{_config.icons}\" value=\"{_config.prev_icon}\"></gb-icon> <span if=\"{_config.labels}\">{_config.prev_label}</span> </a> <yield></yield> <a class=\"gb-pager__link next {disabled: _scope.forwardDisabled}\" onclick=\"{_scope.pager.next}\"> <span if=\"{_config.labels}\">{_config.next_label}</span> <gb-icon if=\"{_config.icons}\" value=\"{_config.next_icon}\"></gb-icon> </a> </div>', 'gb-pager .gb-stylish a,[riot-tag=\"gb-pager\"] .gb-stylish a,[data-is=\"gb-pager\"] .gb-stylish a{ cursor: pointer; } gb-pager .gb-stylish.gb-pager,[riot-tag=\"gb-pager\"] .gb-stylish.gb-pager,[data-is=\"gb-pager\"] .gb-stylish.gb-pager{ display: flex; } gb-pager .gb-stylish .gb-pager__link,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link{ display: flex; text-decoration: none; color: #888; padding: 5px 14px; } gb-pager .gb-stylish .gb-pager__link:hover,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link:hover,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link:hover{ color: black; } gb-pager .gb-stylish .gb-pager__link.disabled,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link.disabled,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link.disabled{ color: #ddd; cursor: not-allowed; } gb-pager .gb-stylish gb-pages,[riot-tag=\"gb-pager\"] .gb-stylish gb-pages,[data-is=\"gb-pager\"] .gb-stylish gb-pages{ flex: 1; } gb-pager .gb-stylish gb-icon img,[riot-tag=\"gb-pager\"] .gb-stylish gb-icon img,[data-is=\"gb-pager\"] .gb-stylish gb-icon img{ width: 20px; }', '', function (opts) {\n\t    this._mixin(_gbPager.Pager);\n\t});\n\n/***/ },\n/* 72 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbIcon = __webpack_require__(73);\n\t\n\triot.tag2('gb-icon', '<i if=\"{classes}\" class=\"{classes}\"></i> <img if=\"{url}\" riot-src=\"{url}\"></img>', '', '', function (opts) {\n\t    this._mixin(_gbIcon.Icon);\n\t});\n\n/***/ },\n/* 73 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.IMAGE_PATTERN = /.*\\..*/;\r\n\texports.DATA_URL_PREFIX = 'data:image/';\r\n\tvar Icon = (function () {\r\n\t    function Icon() {\r\n\t    }\r\n\t    Icon.prototype.init = function () {\r\n\t        this.configure();\r\n\t        if (this.isImage(this._config.value)) {\r\n\t            this.url = this._config.value;\r\n\t        }\r\n\t        else {\r\n\t            this.classes = this._config.value;\r\n\t        }\r\n\t    };\r\n\t    Icon.prototype.isImage = function (value) {\r\n\t        var matches = value.match(exports.IMAGE_PATTERN);\r\n\t        return (matches && matches.length > 0) || value.startsWith(exports.DATA_URL_PREFIX);\r\n\t    };\r\n\t    return Icon;\r\n\t}());\r\n\texports.Icon = Icon;\r\n\n\n/***/ },\n/* 74 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Pager = (function () {\r\n\t    function Pager() {\r\n\t    }\r\n\t    Pager.prototype.init = function () {\r\n\t        this._scopeTo('gb-paging');\r\n\t        this._config = this._scope._config;\r\n\t    };\r\n\t    return Pager;\r\n\t}());\r\n\texports.Pager = Pager;\r\n\n\n/***/ },\n/* 75 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbPages = __webpack_require__(76);\n\t\n\triot.tag2('gb-pages', '<ul class=\"gb-pages {_style}\" if=\"{_config.pages}\"> <span class=\"gb-pages__ellipsis\" if=\"{_scope.lowOverflow}\">&hellip;</span> <li each=\"{pageNumber in _scope.pageNumbers}\"> <a class=\"gb-pages__page {selected: _scope.currentPage === pageNumber}\" onclick=\"{jumpTo}\">{pageNumber}</a> </li> <span class=\"gb-pages__ellipsis\" if=\"{_scope.highOverflow}\">&hellip;</span> </ul>', 'gb-pages .gb-stylish a,[riot-tag=\"gb-pages\"] .gb-stylish a,[data-is=\"gb-pages\"] .gb-stylish a{ cursor: pointer; } gb-pages .gb-stylish.gb-pages,[riot-tag=\"gb-pages\"] .gb-stylish.gb-pages,[data-is=\"gb-pages\"] .gb-stylish.gb-pages{ margin: 0; padding: 0; list-style: none; display: flex; align-items: center; justify-content: center; height: 100%; } gb-pages .gb-stylish.gb-pages li,[riot-tag=\"gb-pages\"] .gb-stylish.gb-pages li,[data-is=\"gb-pages\"] .gb-stylish.gb-pages li{ display: inline; } gb-pages .gb-stylish .gb-pages__page,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page,gb-pages .gb-stylish .gb-pages__ellipsis,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__ellipsis,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__ellipsis{ text-decoration: none; color: #888; } gb-pages .gb-stylish .gb-pages__page,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page{ padding: 0 4px; } gb-pages .gb-stylish .gb-pages__page:hover,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page:hover,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page:hover,gb-pages .gb-stylish .gb-pages__page.selected,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page.selected,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page.selected{ color: black; }', '', function (opts) {\n\t    this._mixin(_gbPages.Pages);\n\t});\n\n/***/ },\n/* 76 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Pages = (function () {\r\n\t    function Pages() {\r\n\t    }\r\n\t    Pages.prototype.init = function () {\r\n\t        this._scopeTo('gb-paging');\r\n\t        this._config = this._scope._config;\r\n\t    };\r\n\t    Pages.prototype.jumpTo = function (_a) {\r\n\t        var target = _a.target;\r\n\t        this._scope.pager.switchPage(Number(target.text));\r\n\t    };\r\n\t    return Pages;\r\n\t}());\r\n\texports.Pages = Pages;\r\n\n\n/***/ },\n/* 77 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(78);\n\t\n\t__webpack_require__(71);\n\t\n\t__webpack_require__(75);\n\t\n\tvar _gbPaging = __webpack_require__(80);\n\t\n\triot.tag2('gb-paging', '<yield> <gb-terminal-pager> <gb-pager> <gb-pages></gb-pages> </gb-pager> </gb-terminal-pager> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbPaging.Paging);\n\t});\n\n/***/ },\n/* 78 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(72);\n\t\n\tvar _gbTerminalPager = __webpack_require__(79);\n\t\n\triot.tag2('gb-terminal-pager', '<div class=\"gb-terminal-pager {_style}\"> <a class=\"gb-terminal__link first {disabled: _scope.backDisabled}\" if=\"{_scope._config.terminals}\" onclick=\"{_scope.pager.first}\"> <gb-icon if=\"{_config.icons}\" value=\"{_config.first_icon}\"></gb-icon> <span if=\"{_config.labels}\">{_config.numeric ? 1 : _config.first_label}</span> </a> <yield></yield> <a class=\"gb-terminal__link last {disabled: _scope.forwardDisabled}\" if=\"{_config.terminals}\" onclick=\"{_scope.pager.last}\"> <span if=\"{_config.labels}\">{_config.numeric ? _scope.lastPage : _config.last_label}</span> <gb-icon if=\"{_config.icons}\" value=\"{_config.last_icon}\"></gb-icon> </a> </div>', 'gb-terminal-pager .gb-stylish a,[riot-tag=\"gb-terminal-pager\"] .gb-stylish a,[data-is=\"gb-terminal-pager\"] .gb-stylish a{ cursor: pointer; } gb-terminal-pager .gb-stylish.gb-terminal-pager,[riot-tag=\"gb-terminal-pager\"] .gb-stylish.gb-terminal-pager,[data-is=\"gb-terminal-pager\"] .gb-stylish.gb-terminal-pager{ display: flex; width: 100%; } gb-terminal-pager .gb-stylish .gb-terminal__link,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link{ display: flex; text-decoration: none; color: #888; padding: 5px 14px; } gb-terminal-pager .gb-stylish .gb-terminal__link:hover,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link:hover,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link:hover{ color: black; } gb-terminal-pager .gb-stylish .gb-terminal__link.disabled,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link.disabled,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link.disabled{ color: #ddd; cursor: not-allowed; } gb-terminal-pager .gb-stylish gb-pager,[riot-tag=\"gb-terminal-pager\"] .gb-stylish gb-pager,[data-is=\"gb-terminal-pager\"] .gb-stylish gb-pager{ flex: 1; } gb-terminal-pager .gb-stylish gb-icon img,[riot-tag=\"gb-terminal-pager\"] .gb-stylish gb-icon img,[data-is=\"gb-terminal-pager\"] .gb-stylish gb-icon img{ width: 20px; }', '', function (opts) {\n\t    this._mixin(_gbTerminalPager.TerminalPager);\n\t});\n\n/***/ },\n/* 79 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar TerminalPager = (function () {\r\n\t    function TerminalPager() {\r\n\t    }\r\n\t    TerminalPager.prototype.init = function () {\r\n\t        this._scopeTo('gb-paging');\r\n\t        this._config = this._scope._config;\r\n\t    };\r\n\t    return TerminalPager;\r\n\t}());\r\n\texports.TerminalPager = TerminalPager;\r\n\n\n/***/ },\n/* 80 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    limit: 5,\r\n\t    pages: false,\r\n\t    numeric: false,\r\n\t    terminals: true,\r\n\t    labels: true,\r\n\t    icons: true,\r\n\t    first_label: 'First',\r\n\t    prev_label: 'Prev',\r\n\t    next_label: 'Next',\r\n\t    last_label: 'Last',\r\n\t    first_icon: __webpack_require__(81),\r\n\t    prev_icon: __webpack_require__(82),\r\n\t    next_icon: __webpack_require__(83),\r\n\t    last_icon: __webpack_require__(84)\r\n\t};\r\n\tvar Paging = (function () {\r\n\t    function Paging() {\r\n\t    }\r\n\t    Paging.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        // default initial state\r\n\t        this.backDisabled = true;\r\n\t        this.currentPage = 1;\r\n\t        this.pager = this.wrapPager(this.flux.page);\r\n\t        this.flux.on(groupby_api_1.Events.PAGE_CHANGED, this.updateCurrentPage);\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.pageInfo);\r\n\t    };\r\n\t    Paging.prototype.pageInfo = function () {\r\n\t        var pageNumbers = this.flux.page.pageNumbers(this._config.limit);\r\n\t        var lastPage = this.flux.page.finalPage;\r\n\t        var currentPage = this.flux.page.currentPage;\r\n\t        this.updatePageInfo(pageNumbers, currentPage, lastPage);\r\n\t    };\r\n\t    Paging.prototype.updatePageInfo = function (pageNumbers, currentPage, lastPage) {\r\n\t        this.update({\r\n\t            pageNumbers: pageNumbers,\r\n\t            currentPage: currentPage,\r\n\t            lastPage: lastPage,\r\n\t            lowOverflow: pageNumbers[0] !== 1,\r\n\t            highOverflow: pageNumbers[pageNumbers.length - 1] !== lastPage,\r\n\t            backDisabled: currentPage === 1,\r\n\t            forwardDisabled: currentPage === lastPage\r\n\t        });\r\n\t    };\r\n\t    Paging.prototype.updateCurrentPage = function (_a) {\r\n\t        var pageNumber = _a.pageNumber;\r\n\t        this.update({ currentPage: pageNumber });\r\n\t    };\r\n\t    Paging.prototype.wrapPager = function (pager) {\r\n\t        var _this = this;\r\n\t        return {\r\n\t            first: function () { return !_this.backDisabled && pager.reset().then(_this.emitEvent); },\r\n\t            prev: function () { return !_this.backDisabled && pager.prev().then(_this.emitEvent); },\r\n\t            next: function () { return !_this.forwardDisabled && pager.next().then(_this.emitEvent); },\r\n\t            last: function () { return !_this.forwardDisabled && pager.last().then(_this.emitEvent); },\r\n\t            switchPage: function (page) { return pager.switchPage(page).then(_this.emitEvent); }\r\n\t        };\r\n\t    };\r\n\t    Paging.prototype.emitEvent = function () {\r\n\t        this.services.tracker.search();\r\n\t    };\r\n\t    return Paging;\r\n\t}());\r\n\texports.Paging = Paging;\r\n\n\n/***/ },\n/* 81 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABYmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9InIiPz60J7anAAABhWlDQ1BzUkdCIElFQzYxOTY2LTIuMQAAKJF1kbtLA0EQhz8TxeADCwNaWKQQBYmiUYJ2miA+CEGigq8mOfMQcslxd0HE0sI2hYUPbBSxsdZO/AcEQVArEWzFQsFG5JxNhIiYWXb329/OzO7Ogmshq+lWbT/oOduMTYR8C4tLvvonPLThpRt/XLOMsZmZCFXt444aNd/2qlzV/f61xtWkpUGNR3hUM0xbeFI4um4bineFvVomvip8Juw35YLCD0pPlPlFcbrELpXTa87FwsJeYV/6Fyd+sZYxdeEh4U49W9B+7qNe0pTMzc8qXXoHFjEmCOFjinHCBBlgRMYgvQTokxVV4gOl+Ch5idVkNNjAZI00GWz8ohYke1LmlOhJaVnxEFN/8Le2VmowUD6haRrqnh3nvQfqD+Br23E+jxzn6xjcUpernUp8fgeGX0UvVrTOQ2jZgvPLipY4gYsitD8acTNektzSXakUvJ1C8yK03kDDcrluP/sc38PcJkSuYW8fusS/ZeUbWh5nYM1tRxkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAGBSURBVHic7d0xblNhEIXRS3qyoCT0QLJhVpDNpDMFVFBZspBj8vxmnm3NOdJrR5a+6/pPAAAAAAAAAAAAAAAAAAAAAK7TfZIfSR5v5C6F7pO8JvmTZJe6WF13KXQYaf/tkjxd6V0KHYtUEavrLoVORdp/P7M8VtddCn0k0mGsLxe+S6ElkZbE6rpLoXMi7b+3JJ83vkuhNZF+Jfm68V0KiT+Y+IOJP9iaSL/TE//UXQqtjfRt47sUEn8w8QcTfzDxBxN/MPEHWxvp+8Z3KST+YOIPJv5g4g8m/mBrIz1vfJdC4g8m/mDiDyb+YOJfgbtL/4AVPt3YXY5Y+2992fguDYwAI8AIiBEQIyBGQIyAGAExAmIExAiIERAjIEZAjIAYATECYgTECIgRECMgRkA8GEHOi7VL8nChuzRYEmtJpK67NPhIrHMidd2lwf8eeDw3UtddGrz3xOvaSF13afDvI89Vkbru0mD/zHt1pK67AAAAAAAAAAAAAAAAAAAAwGB/AYR4hXFo7p5xAAAAAElFTkSuQmCC\"\n\n/***/ },\n/* 82 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAACrklEQVR4Ae3dvXLTQBQF4IQeHihAD0leOE+Ql0kHBVSwKjzjIj9er65GZ/V5RpXlq7vfOeOk882NFwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEBgLoEv7ThP7fo617Gc5hKBJfzndv1r1692KUFDOMrrPPylAKcSfDsKwJHP+Vr4SnCQRrwX/qkEv5uFb4IJC3FJ+Ocl+D6hwWGP1BO+EkxWk2vCP5XgpVl8nszjUMcZCf9Pk/pxKK3JDiv8yQLtOY7we7Qmu1f4kwXac5yR8P+2B/mb36O9s3tHw/+5s/NYp0NA+B1Ys90q/NkS7TiP8DuwZrtV+LMl2nEe4XdgzXar8GdLtOM8o+HfdzzLrTsTEP7OAtlyHeFvqb2zZwl/Z4FsuY7wt9Te2bOEv7NAtlxnNPyHLZf1rHUFhL+uZ9Q04UfFte6ywl/XM2qa8KPiWndZ4a/o+WnFWSmjblMWtefbAqPfAo9vj/ZOioASpCRVuKcSFOKmjFaClKQK91SCQtyU0UqQklThnkpQiJsyWglSkircUwkKcVNGK0FKUoV7KkEhbspoJUhJqnBPJSjETRmtBClJFe6pBIW4KaOVICWpwj2VoBA3ZbQSpCRVuKcSFOKmjFaClKQK91SCQtyU0UqQklThnkpQiJsyeqQEfjAiJeUP9rymBMtvCd59MNfbQQI9JRB+ULA9q15SAuH3iAbe+14JhB8Y6DUrv1YC4V8jGfyZ8xIIPzjIkdWXEiw/H++//RFFnyVAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgS6BP4DIgpCusyEaeEAAAAASUVORK5CYII=\"\n\n/***/ },\n/* 83 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAACtklEQVR4Ae3dQW7UQBAF0Ch7OFCAPQQunBNwGXawgBUpLywhFEFc3Ym7ym8kK5uU3f3+z8QjZTI3Nx4ECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgdcTuItLPcTx9vUu6UqrCGzhf4/jdxxf41CCQLjK48/wtwIowVWSj30+Fb4SXKQA/wpfCZqX4DnhK0HTEhwJXwmaleBN7OdbHHuwR756ddCkDF9iH7+UoEmayW0oQRKu05gSdEozuRclSMJ1GlOCTmkm96IESbhOY0rQKc3kXpQgCddpTAk6pZncixIk4TqNKUGnNJN7UYIkXKcxJeiUZnIvSpCE6zSmBJ3STO5FCZJwncaUoFOayb0oQRKu05gSdEozuRclSMJ1GlOCTmkm96IESbhOY0rQKc3kXi5XgtskVNex7Y0mHhcV+Bz79oYT4R9+25m3nBUvjZ/84gGOLF/4I3rFZ4VfPMCR5d/HsBu+EcHCs8IvHN7o0oU/Klh4XviFwxtduvBHBQvPC79weKNL/xQncLc/qlh0XvhFg5uxbOHPUCx6DuEXDW7GsoU/Q7HoOYRfNLgZyxb+DMWi5/gY6/ZSr2h4o8vewv8Zx5F/Gr1/r7/kGdU/eV74Jwdw5uWFf6b+ydcW/skBnHl5Hxhxpv4i1/4Q6/gRx34z95yvbvgWCW/WMo6UQPiz1Bc7z/tYz/+eCYS/WGizl7OVYP/I2L9/FQh/tvai53uqBMJfNKyXWta7OPH+TCD8l1Je/LxbCR7i8MnhiwdleQQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgMAxgUc/cUO5Y0FtKQAAAABJRU5ErkJggg==\"\n\n/***/ },\n/* 84 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,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\"\n\n/***/ },\n/* 85 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(86);\n\t\n\t__webpack_require__(87);\n\t\n\t__webpack_require__(89);\n\t\n\t__webpack_require__(91);\n\t\n\tvar _gbQuery = __webpack_require__(109);\n\t\n\triot.tag2('gb-query', '<yield> <div class=\"gb-query {_style}\"> <gb-search-box></gb-search-box> <gb-submit></gb-submit> <gb-reset></gb-reset> <gb-sayt if=\"{_config.sayt}\"></gb-sayt> </div> </yield>', 'gb-query .gb-stylish.gb-query,[riot-tag=\"gb-query\"] .gb-stylish.gb-query,[data-is=\"gb-query\"] .gb-stylish.gb-query{ position: relative; display: flex; align-items: baseline; } gb-query .gb-stylish.gb-query gb-sayt,[riot-tag=\"gb-query\"] .gb-stylish.gb-query gb-sayt,[data-is=\"gb-query\"] .gb-stylish.gb-query gb-sayt{ top: 31px; left: 0; z-index: 10; position: absolute; min-width: 175px; background-color: #fff; box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); }', '', function (opts) {\n\t    this._mixin(_gbQuery.Query);\n\t});\n\n/***/ },\n/* 86 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-search-box', '<input name=\"searchBox\" class=\"{_style}\" type=\"text\" placeholder=\"Search...\" autofocus>', 'gb-search-box input.gb-stylish,[riot-tag=\"gb-search-box\"] input.gb-stylish,[data-is=\"gb-search-box\"] input.gb-stylish{ padding: 6px 12px; font-size: 14px; }', '', function (opts) {});\n\n/***/ },\n/* 87 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbSubmit = __webpack_require__(88);\n\t\n\triot.tag2('gb-submit', '<yield> <a class=\"gb-submit {_style}\">&#128269;</a> </yield>', 'gb-submit .gb-stylish.gb-submit,[riot-tag=\"gb-submit\"] .gb-stylish.gb-submit,[data-is=\"gb-submit\"] .gb-stylish.gb-submit{ padding: 4px; } gb-submit .gb-stylish.gb-submit:hover,[riot-tag=\"gb-submit\"] .gb-stylish.gb-submit:hover,[data-is=\"gb-submit\"] .gb-stylish.gb-submit:hover{ cursor: pointer; }', '', function (opts) {\n\t    this._mixin(_gbSubmit.Submit);\n\t});\n\n/***/ },\n/* 88 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    label: 'Search',\r\n\t    staticSearch: false\r\n\t};\r\n\tvar Submit = (function () {\r\n\t    function Submit() {\r\n\t    }\r\n\t    Submit.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        if (this.root.tagName === 'INPUT') {\r\n\t            this.root.value = this._config.label;\r\n\t        }\r\n\t        this.on('mount', this.setSearchBox);\r\n\t        this.root.addEventListener('click', this.submitQuery);\r\n\t    };\r\n\t    Submit.prototype.setSearchBox = function () {\r\n\t        this.searchBox = common_1.findSearchBox();\r\n\t    };\r\n\t    Submit.prototype.submitQuery = function () {\r\n\t        var _this = this;\r\n\t        var inputValue = this.searchBox.value;\r\n\t        if (this._config.staticSearch && this.services.url.isActive()) {\r\n\t            this.services.url.update(this.flux.query.withQuery(inputValue)\r\n\t                .withConfiguration({ refinements: [] }));\r\n\t        }\r\n\t        else {\r\n\t            this.flux.reset(inputValue)\r\n\t                .then(function () { return _this.services.tracker.search(); });\r\n\t        }\r\n\t    };\r\n\t    return Submit;\r\n\t}());\r\n\texports.Submit = Submit;\r\n\n\n/***/ },\n/* 89 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbReset = __webpack_require__(90);\n\t\n\triot.tag2('gb-reset', '<yield> <a class=\"gb-reset {_style}\">&times;</a> </yield>', 'gb-reset .gb-stylish.gb-reset,[riot-tag=\"gb-reset\"] .gb-stylish.gb-reset,[data-is=\"gb-reset\"] .gb-stylish.gb-reset{ color: #888; padding: 4px; } gb-reset .gb-stylish.gb-reset:hover,[riot-tag=\"gb-reset\"] .gb-stylish.gb-reset:hover,[data-is=\"gb-reset\"] .gb-stylish.gb-reset:hover{ color: black; cursor: pointer; }', '', function (opts) {\n\t    this._mixin(_gbReset.Reset);\n\t});\n\n/***/ },\n/* 90 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar Reset = (function () {\r\n\t    function Reset() {\r\n\t    }\r\n\t    Reset.prototype.init = function () {\r\n\t        this.on('mount', this.setSearchBox);\r\n\t        this.root.addEventListener('click', this.clearQuery);\r\n\t    };\r\n\t    Reset.prototype.setSearchBox = function () {\r\n\t        this.searchBox = common_1.findSearchBox();\r\n\t    };\r\n\t    Reset.prototype.clearQuery = function () {\r\n\t        var _this = this;\r\n\t        this.flux.reset(this.searchBox.value = '')\r\n\t            .then(function () { return _this.services.tracker.search(); });\r\n\t    };\r\n\t    return Reset;\r\n\t}());\r\n\texports.Reset = Reset;\r\n\n\n/***/ },\n/* 91 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(92);\n\t\n\t__webpack_require__(100);\n\t\n\tvar _gbSayt = __webpack_require__(106);\n\t\n\tvar _tag = __webpack_require__(28);\n\t\n\triot.tag2('gb-sayt', '<yield> <div class=\"{_style}\" if=\"{(queries && queries.length) || (navigations && navigations.length)}\"> <gb-sayt-autocomplete></gb-sayt-autocomplete> <gb-sayt-products if=\"{showProducts}\"></gb-sayt-products> </div> </yield>', 'gb-sayt div.gb-stylish,[riot-tag=\"gb-sayt\"] div.gb-stylish,[data-is=\"gb-sayt\"] div.gb-stylish{ display: flex; } gb-sayt .gb-stylish ul,[riot-tag=\"gb-sayt\"] .gb-stylish ul,[data-is=\"gb-sayt\"] .gb-stylish ul{ list-style: none; margin: 0; padding: 0; } gb-sayt .gb-stylish gb-sayt-link:hover,[riot-tag=\"gb-sayt\"] .gb-stylish gb-sayt-link:hover,[data-is=\"gb-sayt\"] .gb-stylish gb-sayt-link:hover,gb-sayt .gb-stylish gb-sayt-link.active,[riot-tag=\"gb-sayt\"] .gb-stylish gb-sayt-link.active,[data-is=\"gb-sayt\"] .gb-stylish gb-sayt-link.active{ background-color: #f1f1f1; display: block; } gb-sayt .gb-stylish gb-list li,[riot-tag=\"gb-sayt\"] .gb-stylish gb-list li,[data-is=\"gb-sayt\"] .gb-stylish gb-list li{ margin: 0px; }', '', function (opts) {\n\t    this._mixin(_tag.SaytTag, _gbSayt.Sayt);\n\t});\n\n/***/ },\n/* 92 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(93);\n\t\n\t__webpack_require__(97);\n\t\n\t__webpack_require__(98);\n\t\n\t__webpack_require__(99);\n\t\n\triot.tag2('gb-sayt-autocomplete', '<yield> <gb-sayt-categories></gb-sayt-categories> <gb-sayt-divider></gb-sayt-divider> <gb-sayt-search-terms></gb-sayt-search-terms> <gb-sayt-divider></gb-sayt-divider> <gb-sayt-refinements each=\"{navigations}\"></gb-sayt-refinements> </yield>', '.gb-stylish gb-sayt-autocomplete,.gb-stylish [riot-tag=\"gb-sayt-autocomplete\"],.gb-stylish [data-is=\"gb-sayt-autocomplete\"]{ min-width: 210px; }', '', function (opts) {});\n\n/***/ },\n/* 93 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(94);\n\t\n\t__webpack_require__(95);\n\t\n\triot.tag2('gb-sayt-categories', '<gb-list items=\"{categoryResults}\"> <gb-sayt-link send=\"{_scope.searchCategory}\" data-value=\"{item.value}\" data-refinement=\"{item.category}\" data-field=\"{_scope.categoryField}\" data-norefine=\"{item.noRefine}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item.value, \\'<b>$&</b>\\')}\"></gb-raw> in <span class=\"gb-category-query\">{item.category}</span> </yield> </gb-sayt-link> </gb-list>', '.gb-stylish gb-sayt-categories .gb-category-query,.gb-stylish [riot-tag=\"gb-sayt-categories\"] .gb-category-query,.gb-stylish [data-is=\"gb-sayt-categories\"] .gb-category-query{ font-weight: bold; color: darkorange; }', '', function (opts) {\n\t\n\t    this._scopeTo('gb-sayt');\n\t});\n\n/***/ },\n/* 94 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-sayt-link', '<a onclick=\"{opts.send}\"> <yield></yield> </a>', '.gb-stylish gb-sayt-link a,.gb-stylish [riot-tag=\"gb-sayt-link\"] a,.gb-stylish [data-is=\"gb-sayt-link\"] a{ padding: 5px 15px; text-decoration: none; display: block; }', '', function (opts) {});\n\n/***/ },\n/* 95 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbRaw = __webpack_require__(96);\n\t\n\triot.tag2('gb-raw', '<span></span>', '', '', function (opts) {\n\t    this._mixin(_gbRaw.Raw);\n\t});\n\n/***/ },\n/* 96 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Raw = (function () {\r\n\t    function Raw() {\r\n\t    }\r\n\t    Raw.prototype.init = function () {\r\n\t        this.configure();\r\n\t        this.on('update', this.updateContent);\r\n\t        this.on('mount', this.updateContent);\r\n\t    };\r\n\t    Raw.prototype.updateContent = function () {\r\n\t        this.root.innerHTML = this._config.content;\r\n\t    };\r\n\t    return Raw;\r\n\t}());\r\n\texports.Raw = Raw;\r\n\n\n/***/ },\n/* 97 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(94);\n\t\n\t__webpack_require__(95);\n\t\n\triot.tag2('gb-sayt-search-terms', '<gb-list items=\"{_scope.queries}\"> <gb-sayt-link send=\"{_scope.search}\" data-value=\"{item.value}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item.value, \\'<b>$&</b>\\')}\"></gb-raw> </yield> </gb-sayt-link> </gb-list>', '', '', function (opts) {\n\t\n\t    this._scopeTo('gb-sayt');\n\t});\n\n/***/ },\n/* 98 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(94);\n\t\n\t__webpack_require__(95);\n\t\n\triot.tag2('gb-sayt-refinements', '<h4>{displayName}</h4> <gb-list items=\"{values}\"> <gb-sayt-link send=\"{_scope.searchRefinement}\" data-value=\"{displayName}: {item}\" data-refinement=\"{item}\" data-field=\"{name}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item, \\'<b>$&</b>\\')}\"></gb-raw> </yield> </gb-sayt-link> </gb-list>', '.gb-stylish gb-sayt-refinements h4,.gb-stylish [riot-tag=\"gb-sayt-refinements\"] h4,.gb-stylish [data-is=\"gb-sayt-refinements\"] h4{ margin: 4px; }', '', function (opts) {\n\t\n\t    this._scopeTo('gb-sayt');\n\t});\n\n/***/ },\n/* 99 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-sayt-divider', '<div if=\"{isVisible()}\"></div>', '.gb-stylish gb-sayt-divider div,.gb-stylish [riot-tag=\"gb-sayt-divider\"] div,.gb-stylish [data-is=\"gb-sayt-divider\"] div{ display: block; margin: 3px 10%; border-top: 1px solid #777; }', '', function (opts) {\n\t  var _this = this;\n\t\n\t  this.isVisible = function () {\n\t    return _this.root.nextElementSibling && _this.root.nextElementSibling.querySelector('li') && _this.root.previousElementSibling && _this.root.previousElementSibling.querySelector('li');\n\t  };\n\t});\n\n/***/ },\n/* 100 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(101);\n\t\n\t__webpack_require__(102);\n\t\n\triot.tag2('gb-sayt-products', '<ul class=\"{_style}\"> <li class=\"gb-sayt-product\" each=\"{products}\"> <yield> <gb-product all_meta=\"{allMeta}\"> <gb-product-image thumbnail></gb-product-image> </gb-product> </yield> </li> </ul>', '.gb-stylish gb-sayt-products,.gb-stylish [riot-tag=\"gb-sayt-products\"],.gb-stylish [data-is=\"gb-sayt-products\"]{ min-width: 300px; } gb-sayt-products ul.gb-stylish,[riot-tag=\"gb-sayt-products\"] ul.gb-stylish,[data-is=\"gb-sayt-products\"] ul.gb-stylish{ display: flex; flex-wrap: wrap; align-items: center; width: calc(86px * 4); align-content: flex-start; } gb-sayt-products .gb-stylish gb-product-image img,[riot-tag=\"gb-sayt-products\"] .gb-stylish gb-product-image img,[data-is=\"gb-sayt-products\"] .gb-stylish gb-product-image img{ vertical-align: bottom; margin: 3px; } gb-sayt-products .gb-stylish gb-product-image img:hover,[riot-tag=\"gb-sayt-products\"] .gb-stylish gb-product-image img:hover,[data-is=\"gb-sayt-products\"] .gb-stylish gb-product-image img:hover{ box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); }', '', function (opts) {\n\t    this._scopeTo('gb-sayt');\n\t});\n\n/***/ },\n/* 101 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(102);\n\t\n\t__webpack_require__(103);\n\t\n\t__webpack_require__(104);\n\t\n\tvar _gbProduct = __webpack_require__(105);\n\t\n\triot.tag2('gb-product', '<yield> <gb-product-image></gb-product-image> <gb-product-info></gb-product-info> <gb-variant-switcher></gb-variant-switcher> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbProduct.Product);\n\t});\n\n/***/ },\n/* 102 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-product-image', '<a class=\"gb-product-image {_style}\" href=\"{_scope.link()}\"> <img class=\"{thumbnail: opts.thumbnail !== undefined}\" riot-src=\"{imageLink()}\" alt=\"\"> </a>', 'gb-product-image .gb-product-image.gb-stylish img,[riot-tag=\"gb-product-image\"] .gb-product-image.gb-stylish img,[data-is=\"gb-product-image\"] .gb-product-image.gb-stylish img{ width: 380px; } gb-product-image .gb-product-image.gb-stylish img.thumbnail,[riot-tag=\"gb-product-image\"] .gb-product-image.gb-stylish img.thumbnail,[data-is=\"gb-product-image\"] .gb-product-image.gb-stylish img.thumbnail{ width: 80px; }', '', function (opts) {\n\t    this._scopeTo('gb-product');\n\t    var _scope = this._scope;\n\t    this.imageLink = function () {\n\t        return _scope.image(_scope.productMeta().image);\n\t    };\n\t});\n\n/***/ },\n/* 103 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-product-info', '<a href=\"{_scope.link()}\"> <p class=\"gb-product__title\">{_scope.productMeta().title}</p> <p class=\"gb-product__price\">{_scope.productMeta().price}</p> </a>', '', '', function (opts) {\n\t    this._scopeTo('gb-product');\n\t});\n\n/***/ },\n/* 104 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-variant-switcher', '<a if=\"{_scope.variants.length > 1}\" each=\"{variant, i in _scope.variants}\" class=\"gb-product__variant-link\" onclick=\"{_scope.switchVariant}\" data-index=\"{i}\"> {i} </a>', '', '', function (opts) {\n\t    this._scopeTo('gb-product');\n\t});\n\n/***/ },\n/* 105 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar product_transformer_1 = __webpack_require__(20);\r\n\tvar clone = __webpack_require__(58);\r\n\tvar oget = __webpack_require__(15);\r\n\tvar Product = (function () {\r\n\t    function Product() {\r\n\t    }\r\n\t    Product.prototype.init = function () {\r\n\t        this.variantIndex = 0;\r\n\t        this.detailsUrl = oget(this.services, 'url.urlConfig.detailsUrl', 'details.html');\r\n\t        this.struct = this._scope.struct || this.config.structure || {};\r\n\t        this.transformer = new product_transformer_1.ProductTransformer(this.struct);\r\n\t        this.transformRecord(this.opts.all_meta);\r\n\t    };\r\n\t    Product.prototype.transformRecord = function (allMeta) {\r\n\t        var _this = this;\r\n\t        var productMeta = this.transformer.transform(clone(allMeta, false));\r\n\t        this.update({\r\n\t            productMeta: function () { return productMeta(_this.variantIndex); },\r\n\t            variants: productMeta.variants || [],\r\n\t            allMeta: productMeta.transformedMeta\r\n\t        });\r\n\t    };\r\n\t    Product.prototype.link = function () {\r\n\t        return this.productMeta().url || this.detailsUrl + \"?id=\" + this.productMeta().id;\r\n\t    };\r\n\t    Product.prototype.image = function (imageObj) {\r\n\t        return Array.isArray(imageObj) ? imageObj[0] : imageObj;\r\n\t    };\r\n\t    Product.prototype.switchVariant = function (event) {\r\n\t        var variantIndex = event.target.dataset['index'];\r\n\t        this.update({ variantIndex: variantIndex });\r\n\t    };\r\n\t    return Product;\r\n\t}());\r\n\texports.Product = Product;\r\n\n\n/***/ },\n/* 106 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar autocomplete_1 = __webpack_require__(107);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar escapeStringRegexp = __webpack_require__(108);\r\n\texports.DEFAULT_CONFIG = {\r\n\t    allCategoriesLabel: 'All Departments',\r\n\t    products: 4,\r\n\t    queries: 5,\r\n\t    minimumCharacters: 1,\r\n\t    delay: 100,\r\n\t    autoSearch: true,\r\n\t    staticSearch: false,\r\n\t    highlight: true,\r\n\t    https: false,\r\n\t    navigationNames: {},\r\n\t    allowedNavigations: []\r\n\t};\r\n\texports.MIN_DELAY = 100;\r\n\tvar Sayt = (function () {\r\n\t    function Sayt() {\r\n\t    }\r\n\t    Sayt.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.struct = Object.assign({}, this.config.structure, this._config.structure);\r\n\t        this.showProducts = this._config.products > 0;\r\n\t        this.sayt.configure(this.generateSaytConfig());\r\n\t        this.on('mount', this.initializeAutocomplete);\r\n\t        this.flux.on(autocomplete_1.AUTOCOMPLETE_HIDE_EVENT, this.reset);\r\n\t    };\r\n\t    Sayt.prototype.initializeAutocomplete = function () {\r\n\t        this.autocomplete = new autocomplete_1.Autocomplete(this);\r\n\t    };\r\n\t    Sayt.prototype.generateSaytConfig = function () {\r\n\t        return {\r\n\t            subdomain: this.config.customerId,\r\n\t            collection: this._config.collection || this.config.collection,\r\n\t            autocomplete: {\r\n\t                numSearchTerms: this._config.queries,\r\n\t                language: this._config.language\r\n\t            },\r\n\t            productSearch: {\r\n\t                area: this._config.area || this.config.area,\r\n\t                numProducts: this._config.products,\r\n\t                language: this._config.language\r\n\t            },\r\n\t            https: this._config.https\r\n\t        };\r\n\t    };\r\n\t    Sayt.prototype.reset = function () {\r\n\t        this.autocomplete.reset();\r\n\t        this.update({ queries: null, navigations: null, products: null });\r\n\t    };\r\n\t    Sayt.prototype.fetchSuggestions = function (originalQuery) {\r\n\t        this.sayt.autocomplete(originalQuery)\r\n\t            .then(function (_a) {\r\n\t            var result = _a.result;\r\n\t            return ({ result: result, originalQuery: originalQuery });\r\n\t        })\r\n\t            .then(this.handleSuggestions)\r\n\t            .catch(function (err) { return console.error(err); });\r\n\t    };\r\n\t    Sayt.prototype.handleSuggestions = function (_a) {\r\n\t        var result = _a.result, originalQuery = _a.originalQuery;\r\n\t        this.update({ originalQuery: originalQuery });\r\n\t        this.processResults(result);\r\n\t        if (this.queries && this.showProducts) {\r\n\t            var query = this.matchesInput ? originalQuery : this.queries[0].value;\r\n\t            this.searchProducts(query);\r\n\t        }\r\n\t    };\r\n\t    Sayt.prototype.searchProducts = function (query, refinements) {\r\n\t        var _this = this;\r\n\t        if (query === void 0) { query = ''; }\r\n\t        if (this.showProducts) {\r\n\t            this.sayt.productSearch(query, { refinements: refinements })\r\n\t                .then(function (res) { return _this.update({ products: res.result.products }); });\r\n\t        }\r\n\t    };\r\n\t    Sayt.prototype.rewriteQuery = function (query) {\r\n\t        this.flux.emit(groupby_api_1.Events.REWRITE_QUERY, query);\r\n\t    };\r\n\t    Sayt.prototype.notifier = function (query, refinement, field) {\r\n\t        var isRefinement = refinement && refinement !== this._config.allCategoriesLabel;\r\n\t        var refinementString = \"~\" + (field || this._config.categoryField) + \"=\" + refinement;\r\n\t        if (this._config.autoSearch)\r\n\t            this.searchProducts(field ? '' : query, isRefinement ? refinementString : undefined);\r\n\t        this.rewriteQuery(query);\r\n\t    };\r\n\t    Sayt.prototype.processResults = function (result) {\r\n\t        var _this = this;\r\n\t        var categoryResults = [];\r\n\t        this.matchesInput = result.searchTerms\r\n\t            && result.searchTerms[0].value.toLowerCase() === this.originalQuery.toLowerCase();\r\n\t        if (this.matchesInput) {\r\n\t            var categoryQuery = result.searchTerms.splice(0, 1)[0];\r\n\t            categoryResults = this.extractCategoryResults(categoryQuery);\r\n\t        }\r\n\t        var navigations = result.navigations ? result.navigations\r\n\t            .map(function (nav) { return Object.assign(nav, { displayName: _this._config.navigationNames[nav.name] || nav.name }); })\r\n\t            .filter(function (_a) {\r\n\t            var name = _a.name;\r\n\t            return _this._config.allowedNavigations.includes(name);\r\n\t        }) : [];\r\n\t        this.update({\r\n\t            results: result,\r\n\t            navigations: navigations,\r\n\t            queries: result.searchTerms,\r\n\t            categoryResults: categoryResults\r\n\t        });\r\n\t    };\r\n\t    Sayt.prototype.extractCategoryResults = function (_a) {\r\n\t        var additionalInfo = _a.additionalInfo, value = _a.value;\r\n\t        var categoryResults = [];\r\n\t        var categoryField = this._config.categoryField;\r\n\t        if (additionalInfo && categoryField && categoryField in additionalInfo) {\r\n\t            categoryResults = additionalInfo[categoryField]\r\n\t                .map(function (category) { return ({ category: category, value: value }); })\r\n\t                .slice(0, 3);\r\n\t            categoryResults.unshift({ category: this._config.allCategoriesLabel, value: value, noRefine: true });\r\n\t        }\r\n\t        return categoryResults;\r\n\t    };\r\n\t    Sayt.prototype.searchRefinement = function (event) {\r\n\t        this.flux.resetRecall();\r\n\t        this.refine(event.target, '');\r\n\t    };\r\n\t    Sayt.prototype.searchCategory = function (event) {\r\n\t        this.flux.resetRecall();\r\n\t        this.refine(event.target, this.originalQuery);\r\n\t    };\r\n\t    Sayt.prototype.highlightCurrentQuery = function (value, regexReplacement) {\r\n\t        return this._config.highlight\r\n\t            ? value.replace(new RegExp(escapeStringRegexp(this.originalQuery), 'i'), regexReplacement)\r\n\t            : value;\r\n\t    };\r\n\t    Sayt.prototype.enhanceCategoryQuery = function (query) {\r\n\t        return \"<b>\" + query.value + \"</b> in <span class=\\\"gb-category-query\\\">\" + query.category + \"</span>\";\r\n\t    };\r\n\t    Sayt.prototype.refine = function (node, queryString) {\r\n\t        var _this = this;\r\n\t        while (node.tagName !== 'GB-SAYT-LINK')\r\n\t            node = node.parentElement;\r\n\t        var doRefinement = !node.dataset['norefine'];\r\n\t        var refinement = {\r\n\t            navigationName: node.dataset['field'] || this._config.categoryField,\r\n\t            value: node.dataset['refinement'],\r\n\t            type: 'Value'\r\n\t        };\r\n\t        if (this._config.staticSearch && this.services.url.isActive()) {\r\n\t            this.services.url.update(this.flux.query.withQuery(queryString)\r\n\t                .withConfiguration({ refinements: doRefinement ? [refinement] : [] }));\r\n\t        }\r\n\t        else if (doRefinement) {\r\n\t            this.flux.rewrite(queryString, { skipSearch: true });\r\n\t            this.flux.refine(refinement)\r\n\t                .then(function () { return _this.services.tracker.sayt(); });\r\n\t        }\r\n\t        else {\r\n\t            this.flux.reset(queryString)\r\n\t                .then(function () { return _this.services.tracker.sayt(); });\r\n\t        }\r\n\t    };\r\n\t    Sayt.prototype.search = function (event) {\r\n\t        var _this = this;\r\n\t        var node = event.target;\r\n\t        while (node.tagName !== 'GB-SAYT-LINK')\r\n\t            node = node.parentElement;\r\n\t        var query = node.dataset['value'];\r\n\t        if (this._config.staticSearch && this.services.url.isActive()) {\r\n\t            this.services.url.update(this.flux.query.withQuery(query)\r\n\t                .withConfiguration({ refinements: [] }));\r\n\t        }\r\n\t        else {\r\n\t            this.rewriteQuery(query);\r\n\t            this.flux.reset(query)\r\n\t                .then(function () { return _this.services.tracker.sayt(); });\r\n\t        }\r\n\t    };\r\n\t    Sayt.prototype.listenForInput = function (tag) {\r\n\t        var input = tag.searchBox;\r\n\t        input.autocomplete = 'off';\r\n\t        var debouncedSearch = common_1.debounce(this.debouncedSearch(input), Math.max(this._config.delay, exports.MIN_DELAY));\r\n\t        input.addEventListener('input', debouncedSearch);\r\n\t        document.addEventListener('click', this.reset);\r\n\t    };\r\n\t    Sayt.prototype.debouncedSearch = function (input) {\r\n\t        var _this = this;\r\n\t        return function () {\r\n\t            if (input.value.length >= _this._config.minimumCharacters) {\r\n\t                _this.fetchSuggestions(input.value);\r\n\t            }\r\n\t            else {\r\n\t                _this.reset();\r\n\t            }\r\n\t        };\r\n\t    };\r\n\t    return Sayt;\r\n\t}());\r\n\texports.Sayt = Sayt;\r\n\n\n/***/ },\n/* 107 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar KEY_UP = 38;\r\n\tvar KEY_DOWN = 40;\r\n\tvar KEY_ENTER = 13;\r\n\tvar KEY_ESCAPE = 27;\r\n\tvar ACTIVE = 'active';\r\n\texports.AUTOCOMPLETE_HIDE_EVENT = 'autocomplete:hide';\r\n\tvar Autocomplete = (function () {\r\n\t    function Autocomplete(tag) {\r\n\t        this.tag = tag;\r\n\t        this.selected = this.searchInput = common_1.findSearchBox();\r\n\t    }\r\n\t    Autocomplete.prototype.indexOfSelected = function () {\r\n\t        return this.links().indexOf(this.selected);\r\n\t    };\r\n\t    Autocomplete.prototype.selectLink = function (link) {\r\n\t        if (link)\r\n\t            this.selected = this.swapAttributes(link);\r\n\t    };\r\n\t    Autocomplete.prototype.linkAbove = function () {\r\n\t        return this.links()[this.indexOfSelected() - 1];\r\n\t    };\r\n\t    Autocomplete.prototype.linkBelow = function () {\r\n\t        return this.links()[this.indexOfSelected() + 1];\r\n\t    };\r\n\t    Autocomplete.prototype.links = function () {\r\n\t        return Array.from(this.tag.root.querySelectorAll('gb-sayt-autocomplete gb-sayt-link'));\r\n\t    };\r\n\t    Autocomplete.prototype.isSelectedInAutocomplete = function () {\r\n\t        return this.links().indexOf(this.selected) !== -1;\r\n\t    };\r\n\t    Autocomplete.prototype.swapAttributes = function (next) {\r\n\t        this.removeActiveClass();\r\n\t        next.classList.add(ACTIVE);\r\n\t        var value = next.dataset['value'];\r\n\t        var refinement = next.dataset['refinement'];\r\n\t        var field = next.dataset['field'];\r\n\t        if (value || refinement)\r\n\t            this.tag.notifier(value, refinement, field);\r\n\t        return next;\r\n\t    };\r\n\t    Autocomplete.prototype.resetSelected = function () {\r\n\t        this.selected = this.searchInput;\r\n\t    };\r\n\t    Autocomplete.prototype.removeActiveClass = function () {\r\n\t        this.links().forEach(function (element) { return element.classList.remove(ACTIVE); });\r\n\t    };\r\n\t    Autocomplete.prototype.reset = function () {\r\n\t        this.removeActiveClass();\r\n\t        this.resetSelected();\r\n\t    };\r\n\t    Autocomplete.prototype.keyboardListener = function (event, submitDefault) {\r\n\t        switch (event.keyCode) {\r\n\t            case KEY_UP:\r\n\t                // prevent cursor from moving to front of text box\r\n\t                event.preventDefault();\r\n\t                if (this.isSelectedInAutocomplete()) {\r\n\t                    var linkAbove = this.linkAbove();\r\n\t                    if (linkAbove) {\r\n\t                        this.selectLink(linkAbove);\r\n\t                    }\r\n\t                    else {\r\n\t                        this.searchInput.value = this.preautocompleteValue;\r\n\t                        this.reset();\r\n\t                    }\r\n\t                }\r\n\t                else {\r\n\t                    this.tag.flux.emit(exports.AUTOCOMPLETE_HIDE_EVENT);\r\n\t                }\r\n\t                break;\r\n\t            case KEY_DOWN:\r\n\t                if (!this.isSelectedInAutocomplete()) {\r\n\t                    this.preautocompleteValue = this.searchInput.value;\r\n\t                }\r\n\t                this.selectLink(this.linkBelow());\r\n\t                break;\r\n\t            case KEY_ENTER:\r\n\t                if (this.isSelectedInAutocomplete()) {\r\n\t                    this.selected.querySelector('a').click();\r\n\t                    this.reset();\r\n\t                }\r\n\t                else {\r\n\t                    submitDefault();\r\n\t                }\r\n\t                break;\r\n\t            case KEY_ESCAPE:\r\n\t                this.tag.flux.emit(exports.AUTOCOMPLETE_HIDE_EVENT);\r\n\t                break;\r\n\t        }\r\n\t    };\r\n\t    return Autocomplete;\r\n\t}());\r\n\texports.Autocomplete = Autocomplete;\r\n\n\n/***/ },\n/* 108 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"escape-string-regexp\");\n\n/***/ },\n/* 109 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar autocomplete_1 = __webpack_require__(107);\r\n\t__webpack_require__(91);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar KEY_ENTER = 13;\r\n\texports.DEFAULT_CONFIG = {\r\n\t    sayt: true,\r\n\t    autoSearch: true,\r\n\t    staticSearch: false\r\n\t};\r\n\tvar Query = (function () {\r\n\t    function Query() {\r\n\t    }\r\n\t    Query.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.enterKeyHandlers = [];\r\n\t        this.on('mount', this.attachListeners);\r\n\t        this.flux.on(groupby_api_1.Events.REWRITE_QUERY, this.rewriteQuery);\r\n\t    };\r\n\t    Query.prototype.attachListeners = function () {\r\n\t        this.searchBox = this.findSearchBox();\r\n\t        this.searchBox.addEventListener('keydown', this.keydownListener);\r\n\t        if (this._config.sayt)\r\n\t            this.tags['gb-sayt'].listenForInput(this);\r\n\t        if (this._config.autoSearch) {\r\n\t            this.listenForInput();\r\n\t        }\r\n\t        else if (this._config.staticSearch) {\r\n\t            this.listenForStaticSearch();\r\n\t        }\r\n\t        else {\r\n\t            this.listenForSubmit();\r\n\t        }\r\n\t    };\r\n\t    Query.prototype.rewriteQuery = function (query) {\r\n\t        this.searchBox.value = query;\r\n\t    };\r\n\t    Query.prototype.listenForInput = function () {\r\n\t        this.searchBox.addEventListener('input', this.resetToInputValue);\r\n\t    };\r\n\t    Query.prototype.listenForSubmit = function () {\r\n\t        this.enterKeyHandlers.push(this.resetToInputValue);\r\n\t    };\r\n\t    Query.prototype.resetToInputValue = function () {\r\n\t        var _this = this;\r\n\t        this.flux.reset(this.inputValue())\r\n\t            .then(function () { return _this.services.tracker.search(); });\r\n\t    };\r\n\t    Query.prototype.listenForStaticSearch = function () {\r\n\t        this.enterKeyHandlers.push(this.setLocation);\r\n\t    };\r\n\t    Query.prototype.keydownListener = function (event) {\r\n\t        var sayt = common_1.findTag('gb-sayt');\r\n\t        if (sayt) {\r\n\t            var autocomplete = sayt['_tag'].autocomplete;\r\n\t            autocomplete.keyboardListener(event, this.onSubmit);\r\n\t        }\r\n\t        else if (event.keyCode === KEY_ENTER) {\r\n\t            this.onSubmit();\r\n\t        }\r\n\t    };\r\n\t    Query.prototype.onSubmit = function () {\r\n\t        this.enterKeyHandlers.forEach(function (f) { return f(); });\r\n\t        this.flux.emit(autocomplete_1.AUTOCOMPLETE_HIDE_EVENT);\r\n\t    };\r\n\t    Query.prototype.findSearchBox = function () {\r\n\t        if (this.tags['gb-search-box']) {\r\n\t            return this.tags['gb-search-box'].searchBox;\r\n\t        }\r\n\t        else {\r\n\t            return this.root.querySelector('input');\r\n\t        }\r\n\t    };\r\n\t    Query.prototype.setLocation = function () {\r\n\t        if (this.services.url.isActive()) {\r\n\t            this.services.url.update(this.flux.query.withQuery(this.inputValue())\r\n\t                .withConfiguration({ refinements: [] }));\r\n\t        }\r\n\t        else {\r\n\t            this.flux.reset(this.inputValue());\r\n\t        }\r\n\t    };\r\n\t    Query.prototype.inputValue = function () {\r\n\t        return this.searchBox.value;\r\n\t    };\r\n\t    return Query;\r\n\t}());\r\n\texports.Query = Query;\r\n\n\n/***/ },\n/* 110 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbRecordCount = __webpack_require__(111);\n\t\n\triot.tag2('gb-record-count', '<yield> <h2>{first} - {last} of {total} Products</h2> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbRecordCount.RecordCount);\n\t});\n\n/***/ },\n/* 111 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar RecordCount = (function () {\r\n\t    function RecordCount() {\r\n\t    }\r\n\t    RecordCount.prototype.init = function () {\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updatePageInfo);\r\n\t    };\r\n\t    RecordCount.prototype.updatePageInfo = function (_a) {\r\n\t        var pageInfo = _a.pageInfo, totalRecordCount = _a.totalRecordCount;\r\n\t        this.update({\r\n\t            first: pageInfo.recordStart,\r\n\t            last: pageInfo.recordEnd,\r\n\t            total: totalRecordCount\r\n\t        });\r\n\t    };\r\n\t    return RecordCount;\r\n\t}());\r\n\texports.RecordCount = RecordCount;\r\n\n\n/***/ },\n/* 112 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\tvar _gbRelatedQueries = __webpack_require__(113);\n\t\n\triot.tag2('gb-related-queries', '<yield> <gb-list class=\"{_style}\" items=\"{relatedQueries}\" scope=\"gb-related-queries\" inline> <a onclick=\"{_scope.send}\">{item}</a> </gb-list> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbRelatedQueries.RelatedQueries);\n\t});\n\n/***/ },\n/* 113 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar RelatedQueries = (function () {\r\n\t    function RelatedQueries() {\r\n\t    }\r\n\t    RelatedQueries.prototype.init = function () {\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updatedRelatedQueries);\r\n\t    };\r\n\t    RelatedQueries.prototype.updatedRelatedQueries = function (_a) {\r\n\t        var relatedQueries = _a.relatedQueries;\r\n\t        this.update({ relatedQueries: relatedQueries });\r\n\t    };\r\n\t    RelatedQueries.prototype.send = function (event) {\r\n\t        return this.flux.rewrite(event.target.text);\r\n\t    };\r\n\t    return RelatedQueries;\r\n\t}());\r\n\texports.RelatedQueries = RelatedQueries;\r\n\n\n/***/ },\n/* 114 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(101);\n\t\n\tvar _gbResults = __webpack_require__(115);\n\t\n\triot.tag2('gb-results', '<yield> <gb-list items=\"{records}\"> <gb-product all_meta=\"{item.allMeta}\"></gb-product> </gb-list> </yield>', 'gb-results .gb-stylish gb-list,[riot-tag=\"gb-results\"] .gb-stylish gb-list,[data-is=\"gb-results\"] .gb-stylish gb-list{ padding: 0; list-style: none; display: flex; flex-wrap: wrap; justify-content: space-around; } gb-results .gb-stylish gb-product,[riot-tag=\"gb-results\"] .gb-stylish gb-product,[data-is=\"gb-results\"] .gb-stylish gb-product{ display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }', '', function (opts) {\n\t    this._mixin(_gbResults.Results);\n\t});\n\n/***/ },\n/* 115 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar common_1 = __webpack_require__(11);\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar Results = (function () {\r\n\t    function Results() {\r\n\t    }\r\n\t    Results.prototype.init = function () {\r\n\t        this.struct = this.config.structure;\r\n\t        this.variantStruct = common_1.unless(this.struct._variantStructure, this.struct);\r\n\t        this.getPath = common_1.getPath;\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updateRecords);\r\n\t    };\r\n\t    Results.prototype.updateRecords = function (_a) {\r\n\t        var records = _a.records;\r\n\t        this.update({ records: records, collection: this.flux.query.raw.collection });\r\n\t    };\r\n\t    Results.prototype.userStyle = function (key) {\r\n\t        return this.opts.css ? this.opts.css[key] : '';\r\n\t    };\r\n\t    return Results;\r\n\t}());\r\n\texports.Results = Results;\r\n\n\n/***/ },\n/* 116 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _gbSnippet = __webpack_require__(117);\n\t\n\triot.tag2('gb-snippet', '<div class=\"gb-snippet\"> {responseText} </div>', '', '', function (opts) {\n\t    this._mixin(_gbSnippet.Snippet);\n\t});\n\n/***/ },\n/* 117 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.DEFAULT_CONFIG = {\r\n\t    raw: false\r\n\t};\r\n\tvar Snippet = (function () {\r\n\t    function Snippet() {\r\n\t    }\r\n\t    Snippet.prototype.init = function () {\r\n\t        this.configure(exports.DEFAULT_CONFIG);\r\n\t        this.on('mount', this.loadFile);\r\n\t    };\r\n\t    Snippet.prototype.loadFile = function () {\r\n\t        var _this = this;\r\n\t        var req = new XMLHttpRequest();\r\n\t        req.onload = function () {\r\n\t            var responseText = req.responseText;\r\n\t            if (_this._config.raw) {\r\n\t                _this.root.innerHTML = responseText;\r\n\t            }\r\n\t            else {\r\n\t                _this.update({ responseText: responseText });\r\n\t            }\r\n\t        };\r\n\t        req.open('get', this._config.url, true);\r\n\t        req.send();\r\n\t    };\r\n\t    return Snippet;\r\n\t}());\r\n\texports.Snippet = Snippet;\r\n\n\n/***/ },\n/* 118 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(47);\n\t\n\tvar _gbSort = __webpack_require__(119);\n\t\n\triot.tag2('gb-sort', '<yield> <gb-select scope=\"gb-sort\"> </gb-select> </yield>', '', '', function (opts) {\n\t    this._mixin(_gbSort.Sort);\n\t});\n\n/***/ },\n/* 119 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.DEFAULT_SORTS = [\r\n\t    { label: 'Name Descending', value: { field: 'title', order: 'Descending' } },\r\n\t    { label: 'Name Ascending', value: { field: 'title', order: 'Ascending' } }\r\n\t];\r\n\tvar Sort = (function () {\r\n\t    function Sort() {\r\n\t    }\r\n\t    Sort.prototype.init = function () {\r\n\t        this.configure();\r\n\t        this.options = this._config.options || exports.DEFAULT_SORTS;\r\n\t    };\r\n\t    Sort.prototype.sortValues = function () {\r\n\t        return this.options.map(function (option) { return option.value; });\r\n\t    };\r\n\t    Sort.prototype.onselect = function (value) {\r\n\t        return this.flux.sort(value, this.sortValues());\r\n\t    };\r\n\t    return Sort;\r\n\t}());\r\n\texports.Sort = Sort;\r\n\n\n/***/ },\n/* 120 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(121);\n\t\n\t__webpack_require__(122);\n\t\n\t__webpack_require__(123);\n\t\n\tvar _gbTemplate = __webpack_require__(124);\n\t\n\triot.tag2('gb-template', '<div if=\"{isActive}\"> <yield> <div each=\"{zone in zones}\" class=\"gb-zone-{zone.name}\"> <gb-content-zone if=\"{zone.type === \\'Content\\'}\"></gb-content-zone> <gb-rich-content-zone if=\"{zone.type === \\'Rich_Content\\'}\"></gb-rich-content-zone> <gb-record-zone if=\"{zone.type === \\'Record\\'}\"></gb-record-zone> </div> </yield> </div>', '', '', function (opts) {\n\t    this._mixin(_gbTemplate.Template);\n\t});\n\n/***/ },\n/* 121 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\triot.tag2('gb-content-zone', '<span>{zone.content}</span>', '', '', function (opts) {});\n\n/***/ },\n/* 122 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(95);\n\t\n\triot.tag2('gb-rich-content-zone', '<gb-raw content=\"{zone.richContent}\"></gb-raw>', '', '', function (opts) {});\n\n/***/ },\n/* 123 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(35);\n\t\n\triot.tag2('gb-record-zone', '<gb-list items=\"{zone.records}\"> <gb-product all_meta=\"{item.allMeta}\"></gb-product> </gb-list>', '', '', function (opts) {});\n\n/***/ },\n/* 124 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar groupby_api_1 = __webpack_require__(16);\r\n\tvar Template = (function () {\r\n\t    function Template() {\r\n\t    }\r\n\t    Template.prototype.init = function () {\r\n\t        this.configure();\r\n\t        this.flux.on(groupby_api_1.Events.RESULTS, this.updateActive);\r\n\t    };\r\n\t    Template.prototype.updateActive = function (_a) {\r\n\t        var template = _a.template;\r\n\t        this.update({\r\n\t            isActive: template.name === this._config.target,\r\n\t            zoneMap: template.zones,\r\n\t            zones: this.sortZones(template.zones)\r\n\t        });\r\n\t    };\r\n\t    Template.prototype.sortZones = function (zones) {\r\n\t        return Object.keys(zones).map(function (key) { return zones[key]; })\r\n\t            .reduce(function (list, zone) {\r\n\t            if (zone.type === 'Record') {\r\n\t                list.push(zone);\r\n\t            }\r\n\t            else {\r\n\t                list.unshift(zone);\r\n\t            }\r\n\t            return list;\r\n\t        }, []);\r\n\t    };\r\n\t    return Template;\r\n\t}());\r\n\texports.Template = Template;\r\n\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** searchandiser-ui-0.2.27.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c3976e4898f69d988432\n **/","import './polyfills';\nimport { initSearchandiser, Searchandiser, SearchandiserConfig } from './searchandiser';\nimport './tags/index';\nimport * as utils from './utils/common';\nimport {\n  BrowserBridge,\n  CloudBridge,\n  FluxCapacitor,\n  Query\n} from 'groupby-api';\nimport { Sayt } from 'sayt';\n\nconst searchandiser = initSearchandiser();\n\nexport {\n  searchandiser,\n  utils,\n  BrowserBridge,\n  CloudBridge,\n  FluxCapacitor,\n  Query,\n  Sayt,\n  Searchandiser,\n  SearchandiserConfig\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/pkg-index.ts\n **/","import 'array.of';\nrequire('array.from').shim();\nrequire('array-includes').shim();\nimport 'string.prototype.repeat';\nimport 'string.prototype.startswith';\nimport 'ts-helpers';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/polyfills.ts\n **/","module.exports = require(\"array.of\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"array.of\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"array.from\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"array.from\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"array-includes\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"array-includes\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"string.prototype.repeat\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"string.prototype.repeat\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"string.prototype.startswith\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"string.prototype.startswith\"\n ** module id = 6\n ** module chunks = 0\n **/","function __assignFn(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n    }\n    return t;\n}\nfunction __extendsFn(d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nfunction __decorateFn(decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n        r = Reflect.decorate(decorators, target, key, desc);\n    else\n        for (var i = decorators.length - 1; i >= 0; i--)\n            if (d = decorators[i])\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nfunction __metadataFn(k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\")\n        return Reflect.metadata(k, v);\n}\nfunction __paramFn(paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); };\n}\nfunction __awaiterFn(thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try {\n            step(generator.next(value));\n        }\n        catch (e) {\n            reject(e);\n        } }\n        function rejected(value) { try {\n            step(generator.throw(value));\n        }\n        catch (e) {\n            reject(e);\n        } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments)).next());\n    });\n}\n// hook global helpers\n(function (__global) {\n    __global.__assign = (__global && __global.__assign) || Object.assign || __assignFn;\n    __global.__extends = (__global && __global.__extends) || __extendsFn;\n    __global.__decorate = (__global && __global.__decorate) || __decorateFn;\n    __global.__metadata = (__global && __global.__metadata) || __metadataFn;\n    __global.__param = (__global && __global.__param) || __paramFn;\n    __global.__awaiter = (__global && __global.__awaiter) || __awaiterFn;\n})(typeof window !== \"undefined\" ? window :\n    typeof WorkerGlobalScope !== \"undefined\" ? self :\n        typeof global !== \"undefined\" ? global :\n            Function(\"return this;\")());\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ts-helpers/index.js\n ** module id = 7\n ** module chunks = 0\n **/","import { initServices, Service } from './services/init';\nimport { TrackerConfig } from './services/tracker';\nimport { UrlConfig } from './services/url';\nimport { BreadcrumbsConfig } from './tags/breadcrumbs/gb-breadcrumbs';\nimport { CollectionsConfig } from './tags/collections/gb-collections';\nimport { DetailsConfig } from './tags/details/gb-details';\nimport { FilterConfig } from './tags/filter/gb-filter';\nimport { NavigationConfig } from './tags/navigation/gb-navigation';\nimport { PageSizeConfig } from './tags/page-size/gb-page-size';\nimport { PagingConfig } from './tags/paging/gb-paging';\nimport { QueryConfig } from './tags/query/gb-query';\nimport { SaytConfig } from './tags/sayt/gb-sayt';\nimport { SortConfig } from './tags/sort/gb-sort';\nimport { SubmitConfig } from './tags/submit/gb-submit';\nimport { MixinFlux } from './tags/tag';\nimport { Configuration } from './utils/configuration';\nimport { ProductStructure } from './utils/product-transformer';\nimport { Events, FluxBridgeConfig, FluxCapacitor, Sort } from 'groupby-api';\nimport * as riot from 'riot';\n\nexport const CONFIGURATION_MASK = '{collection,area,language,pageSize,sort,fields,customUrlParams,pruneRefinements,disableAutocorrection}'; // tslint:disable:max-line-length\n\nexport function initSearchandiser() {\n  return function configure(rawConfig: SearchandiserConfig = <any>{}) {\n    const config = new Configuration(rawConfig).apply();\n    const flux = new FluxCapacitor(config.customerId, config, CONFIGURATION_MASK);\n    Object.assign(flux, Events);\n    const services = initServices(flux, config);\n    riot.mixin(MixinFlux(flux, config, services));\n    Object.assign(configure, { flux, services, config }, new Searchandiser()['__proto__']);\n  };\n}\n\nexport class Searchandiser {\n\n  flux: FluxCapacitor;\n  services: any;\n  config: SearchandiserConfig;\n\n  init() {\n    if (this.config.initialSearch) this.search();\n  }\n\n  attach(tagName: string, opts?: any);\n  attach(tagName: string, cssSelector: string, opts?: any);\n  attach(tagName: string, selectorOrOpts?: any, options?: any) {\n    let tag;\n    if (typeof selectorOrOpts === 'string') {\n      tag = this.cssAttach(tagName, selectorOrOpts, options);\n    } else {\n      tag = this.simpleAttach(tagName, selectorOrOpts);\n    }\n    if (tag) {\n      return tag.length === 1 ? tag[0] : tag;\n    } else {\n      return null;\n    }\n  }\n\n  compile() {\n    riot.compile(() => null);\n  }\n\n  search(query?: string) {\n    return this.flux.search(query)\n      .then(() => this.flux.emit(Events.PAGE_CHANGED, { pageNumber: 1, finalPage: this.flux.page.finalPage }));\n  }\n\n  private simpleAttach(tagName: string, options: any = {}) {\n    return riot.mount(this.riotTagName(tagName), options);\n  }\n\n  private cssAttach(tagName: string, cssSelector: string = `.${tagName}`, options: any = {}) {\n    return riot.mount(cssSelector, this.riotTagName(tagName), options);\n  }\n\n  private riotTagName(tagName: string) {\n    return tagName.startsWith('gb-') ? tagName : `gb-${tagName}`;\n  }\n}\n\nexport interface BridgeConfig extends FluxBridgeConfig {\n  skipCache?: boolean;\n  skipSemantish?: boolean;\n}\n\nexport interface SearchandiserConfig {\n  customerId: string;\n  structure: ProductStructure;\n\n  // services\n  bridge?: BridgeConfig;\n  url?: UrlConfig;\n  tracker?: TrackerConfig;\n\n  area?: string;\n  collection?: string;\n  customUrlParams?: any[];\n  disableAutocorrection?: boolean;\n  language?: string;\n  pageSize?: number;\n  pageSizes?: number[];\n  sort?: Sort[];\n  tags?: {\n    breadcrumbs?: BreadcrumbsConfig;\n    collections?: CollectionsConfig;\n    details?: DetailsConfig;\n    filter?: FilterConfig;\n    navigation?: NavigationConfig;\n    pageSize?: PageSizeConfig;\n    paging?: PagingConfig;\n    query?: QueryConfig;\n    sayt?: SaytConfig;\n    sort?: SortConfig;\n    submit?: SubmitConfig;\n  };\n  services?: { [name: string]: Service };\n  stylish?: boolean;\n  initialSearch?: boolean;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/searchandiser.ts\n **/","import { SearchandiserConfig } from '../searchandiser';\nimport { Collections } from './collections';\nimport { Filter } from './filter';\nimport { Redirect } from './redirect';\nimport { Tracker } from './tracker';\nimport { Url } from './url';\nimport { FluxCapacitor } from 'groupby-api';\n\nconst SERVICES = {\n  collections: Collections,\n  filter: Filter,\n  redirect: Redirect,\n  tracker: Tracker,\n  url: Url\n};\n\nconst CORE_SERVICES = {\n  collections: Collections,\n  filter: Filter,\n  tracker: Tracker\n};\n\nexport interface Services {\n  collections: Collections;\n  filter: Filter;\n  redirect: Redirect;\n  tracker: Tracker;\n  url: Url;\n}\n\nexport interface Service {\n  new (flux: FluxCapacitor, config: SearchandiserConfig, services: { [name: string]: any }): { init: () => null };\n}\n\ntype ServiceMap = { [name: string]: Service };\n\nexport function initServices(flux: FluxCapacitor, config: SearchandiserConfig) {\n  const servicesConstructors: ServiceMap = Object.assign({}, SERVICES, config.services || {}, CORE_SERVICES);\n  const services: Services = <any>{};\n\n  for (let key of Object.keys(servicesConstructors)) {\n    services[key] = new servicesConstructors[key](flux, config, services);\n  }\n\n  startServices(services);\n  return services;\n}\n\nexport function startServices(services: any) {\n  for (let key of Object.keys(services)) {\n    if (services[key]) {\n      services[key].init();\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/init.ts\n **/","import { SearchandiserConfig } from '../searchandiser';\nimport { CollectionsConfig, CollectionOption } from '../tags/collections/gb-collections';\nimport { getPath, unless } from '../utils/common';\nimport { Events, FluxCapacitor, Results } from 'groupby-api';\n\nexport const COLLECTIONS_UPDATED_EVENT = 'collections_updated';\n\nexport type CancelablePromise<T> = Promise<T> & { cancelled: boolean; };\n\nexport class Collections {\n\n  collectionsConfig: CollectionsConfig;\n  fetchCounts: boolean;\n  isLabeled: boolean;\n  counts: any = {};\n  inProgress: CancelablePromise<any>;\n  collections: string[];\n  options: string[] | CollectionOption[];\n\n  constructor(private flux: FluxCapacitor, private config: SearchandiserConfig) {\n    this.collectionsConfig = getPath(config, 'tags.collections') || {};\n    this.fetchCounts = unless(this.collectionsConfig.counts, true);\n    this.options = this.collectionsConfig.options || [];\n    this.isLabeled = this.options.length !== 0\n      && typeof this.options[0] === 'object';\n    this.collections = this.isLabeled\n      ? (<CollectionOption[]>this.options).map((collection) => collection.value)\n      : <string[]>this.options;\n  }\n\n  init() {\n    this.flux.on(Events.QUERY_CHANGED, (query) => this.updateCollectionCounts(query));\n    this.flux.on(Events.RESULTS, (results) => this.updateSelectedCollectionCount(results));\n    this.updateCollectionCounts();\n  }\n\n  updateCollectionCounts(query: string = '') {\n    if (this.fetchCounts) {\n      if (this.inProgress) {\n        this.inProgress.cancelled = true;\n      }\n\n      const searches = this.collections\n        .filter((collection) => !this.isSelected(collection))\n        .map((collection) => this.flux.bridge\n          .search(Object.assign(this.flux.query.raw, { query, collection, refinements: [], pageSize: 0, fields: '' }))\n          .then((results) => ({ results, collection })));\n\n      const promises = this.inProgress = <CancelablePromise<any>>Promise.all(searches);\n\n      promises.then(this.extractCounts)\n        .then((counts) => {\n          if (!promises.cancelled) {\n            Object.assign(this.counts, counts);\n            this.flux.emit(COLLECTIONS_UPDATED_EVENT, this.counts);\n          }\n        });\n    }\n  }\n\n  extractCounts(res: any[]) {\n    return res.reduce((counts, { results, collection }) =>\n      Object.assign(counts, { [collection]: results.totalRecordCount }), {});\n  }\n\n  updateSelectedCollectionCount(res: Results) {\n    Object.assign(this.counts, { [this.selectedCollection]: res.totalRecordCount });\n    this.flux.emit(COLLECTIONS_UPDATED_EVENT, this.counts);\n  }\n\n  isSelected(collection: string) {\n    return collection === this.selectedCollection;\n  }\n\n  get selectedCollection() {\n    return getPath(this.flux, 'query.raw.collection') || this.config.collection;\n  }\n\n  // private extractCounts(counts: any, { results, collection }: { results: Results, collection: string }) {\n  //   return Object.assign(counts, { [collection]: results.totalRecordCount });\n  // }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/collections.ts\n **/","import * as debounce from 'debounce';\nimport { Navigation, RangeRefinement, ValueRefinement } from 'groupby-api';\nimport * as queryString from 'query-string';\nimport filterObject = require('filter-object');\nimport oget = require('oget');\n\nexport { debounce }\n\nexport type Refinement = ValueRefinement & RangeRefinement;\n\nexport const LOCATION = {\n  href: () => window.location.href,\n  setSearch: (search) => window.location.search = search,\n  getSearch: () => window.location.search,\n  pathname: () => window.location.pathname,\n  replace: (url) => window.location.replace(url),\n  assign: (url) => window.location.assign(url)\n};\n\nexport function findSearchBox() {\n  return <HTMLInputElement>oget(findTag('gb-query'), '_tag.searchBox');\n}\n\nexport function findTag(tagName: string): Element {\n  return document.querySelector(tagName)\n    || document.querySelector(`[data-is=\"${tagName}\"]`)\n    || document.querySelector(`[riot-tag=\"${tagName}\"]`);\n}\n\nexport function toRefinement(ref: Refinement, nav: Navigation) {\n  return Object.assign({}, filterObject(ref, '{type,value,low,high}'), { navigationName: nav.name });\n}\n\nexport function displayRefinement(ref: Refinement) {\n  return ref.type === 'Value' ? ref.value : `${ref.low} - ${ref.high}`;\n}\n\nexport function checkNested(obj: any, ...keys: string[]): boolean {\n  return Array.prototype.slice.call(arguments, 1)\n    .reduce((res, arg) => {\n      if (!obj || !obj.hasOwnProperty(arg)) return false;\n      obj = obj[arg];\n      return res;\n    }, true);\n}\n\nexport function getParam(param: string): string | null {\n  return queryString.parse(LOCATION.getSearch())[param] || null;\n}\n\nexport function unless(obj: any, ...defaultObjs: any[]) {\n  return obj !== undefined ? obj : unless(defaultObjs.splice(0, 1)[0], ...defaultObjs);\n}\n\nexport function getPath(obj: any, path: string = '') {\n  return oget(obj, path);\n}\n\n/**\n * Example:\n * ({x: 3, y: 4, h: 8}, {z: 'x', i: 'h'}) -> {z: 3, i: 8}\n *\n * N.B. It removes keys that do not appear in the mapping\n */\nexport function remap(obj: any, mapping?: any) {\n  if (mapping) {\n    return Object.keys(mapping).reduce((acc, key) => {\n      const value = getPath(obj, mapping[key]);\n      if (value) {\n        return Object.assign(acc, { [key]: value });\n      } else {\n        return acc;\n      }\n    }, {});\n  } else {\n    return obj;\n  }\n}\n\nexport function checkBooleanAttr(attribute: string, opts: any) {\n  return typeof opts === 'object'\n    && attribute in opts\n    && opts[attribute] != 'false' // tslint:disable-line:triple-equals\n    && opts[attribute] !== false;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/utils/common.ts\n **/","module.exports = require(\"debounce\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"debounce\"\n ** module id = 12\n ** module chunks = 0\n **/","module.exports = require(\"query-string\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"query-string\"\n ** module id = 13\n ** module chunks = 0\n **/","module.exports = require(\"filter-object\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"filter-object\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"oget\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"oget\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"groupby-api\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"groupby-api\"\n ** module id = 16\n ** module chunks = 0\n **/","import { CONFIGURATION_MASK, SearchandiserConfig } from '../searchandiser';\nimport { FilterConfig } from '../tags/filter/gb-filter';\nimport { getPath } from '../utils/common';\nimport { Events, FluxCapacitor } from 'groupby-api';\n\nexport const FILTER_UPDATED_EVENT = 'filter_updated';\n\nexport class Filter {\n\n  filterConfig: FilterConfig;\n  fluxClone: FluxCapacitor;\n\n  constructor(private flux: FluxCapacitor, private config: SearchandiserConfig) {\n    this.fluxClone = this.clone();\n    this.filterConfig = getPath(config, 'tags.filter') || {};\n  }\n\n  init() {\n    this.flux.on(Events.RESULTS, () => this.updateFluxClone());\n  }\n\n  updateFluxClone() {\n    const searchRequest = this.flux.query.raw;\n    // TODO: this is probably broken in terms of state propagation\n    this.fluxClone.query.withConfiguration(<any>{ refinements: [] });\n    if (searchRequest.refinements) {\n      const filteredRefinements: any[] = searchRequest.refinements\n        .filter(({ navigationName }) => !this.isTargetNav(navigationName));\n      this.fluxClone.query.withSelectedRefinements(...filteredRefinements);\n    }\n\n    this.fluxClone.search(searchRequest.query)\n      .then((res) => this.flux.emit(FILTER_UPDATED_EVENT, res));\n  }\n\n  isTargetNav(navName: string) {\n    return navName === this.filterConfig.field;\n  }\n\n  clone() {\n    return new FluxCapacitor(this.config.customerId, this.config, CONFIGURATION_MASK);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/filter.ts\n **/","import { LOCATION } from '../utils/common';\nimport { Events, FluxCapacitor } from 'groupby-api';\n\nexport class Redirect {\n\n  constructor(private flux: FluxCapacitor) { }\n\n  init() {\n    this.flux.on(Events.REDIRECT, (redirect) => this.redirect(redirect));\n  }\n\n  redirect(url: string) {\n    LOCATION.assign(url);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/redirect.ts\n **/","import { SearchandiserConfig } from '../searchandiser';\nimport { ProductTransformer } from '../utils/product-transformer';\nimport * as GbTracker from 'gb-tracker-client';\nimport { Events, FluxCapacitor } from 'groupby-api';\nimport * as Cookies from 'js-cookie';\nimport * as uuid from 'node-uuid';\n\nexport const MAX_COOKIE_AGE = 365; // days\nexport const VISITOR_COOKIE_KEY = 'visitor';\nexport const SESSION_COOKIE_KEY = 'session';\n\nexport interface TrackerConfig {\n  sessionId?: string;\n  visitorId?: string;\n}\n\nexport class Tracker {\n\n  _config: TrackerConfig;\n  tracker: TrackerClient;\n  transformer: ProductTransformer;\n\n  constructor(private flux: FluxCapacitor, private config: SearchandiserConfig) {\n    this._config = this.config.tracker || {};\n    this.tracker = new GbTracker(this.config.customerId, this.config.area);\n    this.transformer = new ProductTransformer(this.config.structure || {});\n  }\n\n  init() {\n    this.setVisitorInfo();\n\n    this.listenForViewProduct();\n  }\n\n  setVisitorInfo() {\n    const visitorId = this._config.visitorId\n      || Cookies.get(VISITOR_COOKIE_KEY)\n      || uuid.v1();\n    const sessionId = this._config.sessionId\n      || Cookies.get(SESSION_COOKIE_KEY)\n      || uuid.v1();\n\n    this.setVisitor(visitorId, sessionId);\n  }\n\n  listenForViewProduct() {\n    this.flux.on(Events.DETAILS, ({ allMeta }) => {\n      const productMeta = this.transformer.transform(allMeta);\n      this.tracker.sendViewProductEvent({\n        product: {\n          productId: productMeta().id,\n          title: productMeta().title,\n          price: productMeta().price,\n          category: 'NONE'\n        }\n      });\n    });\n  }\n\n  setVisitor(visitorId: string, sessionId: string) {\n    this.tracker.setVisitor(visitorId, sessionId);\n\n    Cookies.set(VISITOR_COOKIE_KEY, visitorId, { expires: MAX_COOKIE_AGE });\n    Cookies.set(SESSION_COOKIE_KEY, sessionId);\n  }\n\n  search() {\n    this.sendSearchEvent();\n  }\n\n  didYouMean() {\n    this.sendSearchEvent('dym');\n  }\n\n  sayt() {\n    this.sendSearchEvent('sayt');\n  }\n\n  addToCart(productsInfo: any) {\n    this.tracker.sendAddToCartEvent(productsInfo);\n  }\n\n  order(productsInfo: any) {\n    this.tracker.sendOrderEvent(productsInfo);\n  }\n\n  sendSearchEvent(origin: string = 'search') {\n    this.tracker.sendSearchEvent({\n      search: Object.assign({\n        origin: { [origin]: true },\n        query: this.flux.results.originalQuery || ''\n      }, this.flux.results)\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/tracker.ts\n **/","import { getPath, remap } from './common';\nimport filterObject = require('filter-object');\n\nconst DEFAULT_STRUCTURE = {\n  id: 'id'\n};\n\nexport interface BaseStructure {\n  title: string;\n  price: string;\n  id?: string;\n  url?: string;\n  variants?: string;\n  _variantStructure?: any;\n  _transform?: (allMeta: any) => any;\n}\n\nexport interface ProductMeta {\n  (variant?: number): any;\n  variants?: any[];\n  transformedMeta?: any;\n}\n\nexport type ProductStructure = BaseStructure & any;\n\nexport class ProductTransformer {\n\n  struct: ProductStructure;\n  variantStruct: any;\n  hasVariants: boolean;\n  idField: string;\n  productTransform: (allMeta: any) => any;\n  variants: any[];\n\n  constructor(struct: ProductStructure) {\n    this.struct = Object.assign({}, DEFAULT_STRUCTURE, struct);\n    this.setTransform();\n    this.hasVariants = 'variants' in struct;\n    this.variantStruct = this.struct._variantStructure || this.struct;\n    this.idField = this.extractIdField();\n  }\n\n  transform(allMeta: any): ProductMeta {\n    const transformedMeta = this.productTransform(allMeta);\n    const variants = this.unpackVariants(transformedMeta);\n    const productMeta: ProductMeta = (variant: number = 0) => {\n      if (variant >= variants.length) {\n        throw new Error(`cannot access the variant at index ${variant}`);\n      } else {\n        return variants[variant];\n      }\n    };\n    productMeta.variants = variants;\n    productMeta.transformedMeta = transformedMeta;\n\n    return productMeta;\n  }\n\n  unpackVariants(allMeta: any): any[] {\n    const struct = filterObject(this.struct, '!_*');\n    const variantStruct = filterObject(this.variantStruct, '!_*');\n    const remappedMeta = remap(allMeta, struct);\n    const variantMapping = this.remapVariant(remappedMeta, variantStruct);\n\n    if (this.hasVariants && Array.isArray(getPath(allMeta, struct.variants))) {\n      const variantsArray: any[] = getPath(allMeta, struct.variants)\n        .filter((variant) => variant);\n      if (variantsArray.length > 0) {\n        return variantsArray.map(variantMapping);\n      }\n    }\n    return [filterObject(remappedMeta, '!variants')];\n  }\n\n  remapVariant(remappedMeta: any, variantStruct: any) {\n    return (variant) => {\n      const remappedVariant = remap(variant, variantStruct);\n      return filterObject(Object.assign({}, remappedMeta, remappedVariant), '!variants');\n    };\n  }\n\n  extractIdField() {\n    // ensure we actually want the nested id\n    if (this.hasVariants && this.struct._variantStructure && this.variantStruct.id) {\n      return `${this.struct.variants}.${this.variantStruct.id}`;\n    } else {\n      return this.struct.id;\n    }\n  }\n\n  private setTransform() {\n    if (typeof this.struct._transform === 'function') {\n      this.productTransform = this.struct._transform;\n    } else {\n      this.productTransform = this.defaultTransform;\n    }\n  }\n\n  private defaultTransform(allMeta: any) {\n    return allMeta;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/utils/product-transformer.ts\n **/","module.exports = require(\"gb-tracker-client\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"gb-tracker-client\"\n ** module id = 21\n ** module chunks = 0\n **/","module.exports = require(\"js-cookie\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"js-cookie\"\n ** module id = 22\n ** module chunks = 0\n **/","module.exports = require(\"node-uuid\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"node-uuid\"\n ** module id = 23\n ** module chunks = 0\n **/","import { SearchandiserConfig } from '../searchandiser';\nimport { LOCATION } from '../utils/common';\nimport { SimpleBeautifier } from '../utils/simple-beautifier';\nimport { BeautifierConfig, UrlBeautifier } from '../utils/url-beautifier';\nimport { Services } from './init';\nimport { FluxCapacitor, Query } from 'groupby-api';\nimport * as parseUri from 'parseUri';\n\nexport interface UrlConfig {\n  beautifier?: boolean | BeautifierConfig;\n  queryParam?: string;\n  searchUrl?: string;\n  detailsUrl?: string;\n}\n\nexport class Url {\n\n  urlConfig: UrlConfig;\n  beautifier: UrlBeautifier;\n  simple: SimpleBeautifier;\n  beautify: boolean;\n\n  constructor(private flux: FluxCapacitor, private config: SearchandiserConfig, private services: Services) {\n    this.urlConfig = this.config.url || {};\n    this.beautify = !!this.urlConfig.beautifier;\n  }\n\n  init() {\n    this.beautifier = new UrlBeautifier(this.config);\n    this.simple = new SimpleBeautifier(this.config);\n\n    if (!this.config.initialSearch) {\n\n      let query;\n      if (this.beautify) {\n        query = Url.parseBeautifiedUrl(this.beautifier);\n      } else {\n        query = Url.parseUrl(this.simple);\n      }\n\n      if (query) {\n        this.flux.query = query;\n        this.flux.search(query.raw.query)\n          .then(() => this.services.tracker.search());\n      }\n    }\n  }\n\n  isActive() {\n    return LOCATION.pathname() !== this.urlConfig.searchUrl;\n  }\n\n  update(query: Query) {\n    const url = (this.beautify ? this.beautifier : this.simple).build(query);\n\n    Url.setLocation(url, this.urlConfig);\n  }\n\n  static parseUrl(simple: SimpleBeautifier) {\n    return simple.parse(LOCATION.href());\n  }\n\n  static parseBeautifiedUrl(beautifier: UrlBeautifier) {\n    return beautifier.parse(LOCATION.href());\n  }\n\n  // TODO: better way to do this is with browser history rewrites\n  static setLocation(url: string, config: UrlConfig) {\n    if (LOCATION.pathname() === config.searchUrl) {\n      LOCATION.setSearch(`?${parseUri(url).query}`);\n    } else {\n      LOCATION.replace(url);\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/services/url.ts\n **/","import { CONFIGURATION_MASK, SearchandiserConfig, } from '../searchandiser';\nimport { UrlConfig } from '../services/url';\nimport { Query } from 'groupby-api';\nimport * as parseUri from 'parseUri';\nimport * as queryString from 'query-string';\n\nexport class SimpleBeautifier {\n\n  urlConfig: UrlConfig;\n\n  constructor(private config: SearchandiserConfig) {\n    this.urlConfig = config.url || {};\n  }\n\n  parse(url: string) {\n    const queryParams: any = queryString.parse(parseUri(url).query);\n    const queryFromUrl = new Query(queryParams[this.urlConfig.queryParam] || '')\n      .withConfiguration(this.config, CONFIGURATION_MASK);\n\n    if (queryParams.refinements) {\n      const refinements = JSON.parse(queryParams.refinements);\n      if (refinements.length > 0) {\n        queryFromUrl.withSelectedRefinements(...refinements);\n      }\n    }\n\n    return queryFromUrl;\n  }\n\n  build(query: Query) {\n    const request = query.build();\n    const queryObj = {};\n\n    if ('refinements' in request && request.refinements.length > 0) {\n      queryObj['refinements'] = JSON.stringify(request.refinements);\n    }\n\n    queryObj[this.urlConfig.queryParam] = request.query;\n\n    return `${this.urlConfig.searchUrl}?${queryString.stringify(queryObj)}`;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/utils/simple-beautifier.ts\n **/","module.exports = require(\"parseUri\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"parseUri\"\n ** module id = 26\n ** module chunks = 0\n **/","import { CONFIGURATION_MASK, SearchandiserConfig } from '../searchandiser';\nimport { Query, SelectedRangeRefinement, SelectedRefinement, SelectedValueRefinement } from 'groupby-api';\nimport * as parseUri from 'parseUri';\nimport * as queryString from 'query-string';\n\nexport class UrlBeautifier {\n\n  config: BeautifierConfig = {\n    refinementMapping: [],\n    extraRefinementsParam: 'refinements',\n    queryToken: 'q',\n    suffix: ''\n  };\n  private generator: UrlGenerator = new UrlGenerator(this);\n  private parser: UrlParser = new UrlParser(this);\n\n  constructor(public searchandiserConfig: SearchandiserConfig = <any>{}) {\n    const urlConfig = searchandiserConfig.url || {};\n    const config = typeof urlConfig.beautifier === 'object' ? urlConfig.beautifier : {};\n    Object.assign(this.config, config);\n\n    const keys = [];\n    for (let mapping of this.config.refinementMapping) {\n      const key = Object.keys(mapping)[0];\n      if (key.length !== 1) {\n        throw new Error('refinement mapping token must be a single character');\n      }\n      if (key.match(/[aeiouy]/)) {\n        throw new Error('refinement mapping token must not be a vowel');\n      }\n      if (keys.indexOf(key) > -1) {\n        throw new Error('refinement mapping tokens must be unique');\n      }\n      keys.push(key);\n    }\n    if (this.config.queryToken.length !== 1) {\n      throw new Error('query token must be a single character');\n    }\n    if (this.config.queryToken.match(/[aeiouy]/)) {\n      throw new Error('query token must not be a vowel');\n    }\n    if (keys.indexOf(this.config.queryToken) > -1) {\n      throw new Error('query token must be unique from refinement tokens');\n    }\n  }\n\n  parse(url: string) {\n    return this.parser.parse(url);\n  }\n\n  build(query: Query) {\n    return this.generator.build(query);\n  }\n}\n\nexport class UrlGenerator {\n\n  config: BeautifierConfig;\n\n  constructor({ config }: UrlBeautifier) {\n    this.config = config;\n  }\n\n  build(query: Query): string {\n    const request = query.build();\n    const uri = {\n      path: [],\n      query: ''\n    };\n    // let url = '';\n    const origRefinements = Array.of(...request.refinements);\n    const countMap = {};\n    const { map, keys } = this.generateRefinementMap(origRefinements);\n\n    // add query\n    if (request.query) {\n      uri.path.push(request.query);\n    }\n\n    // add refinements\n    for (let key of keys) {\n      const refinements = <SelectedRefinement[]>map[key];\n      countMap[key] = refinements.length;\n      uri.path.push(...refinements.map(this.convertRefinement).sort());\n    }\n\n    // add reference key\n    if (keys.length || request.query) {\n      let referenceKey = '';\n      if (request.query) referenceKey += this.config.queryToken;\n      keys.forEach((key) => referenceKey += key.repeat(countMap[key]));\n      uri.path.push(referenceKey);\n    }\n\n    // add remaining refinements\n    if (origRefinements.length) {\n      uri.query = origRefinements\n        .sort((lhs, rhs) => lhs.navigationName.localeCompare(rhs.navigationName))\n        .map(this.stringifyRefinement)\n        .join('~');\n    }\n\n    let url = `/${uri.path.map((path) => encodeURIComponent(path)).join('/')}`;\n    if (this.config.suffix) url += `/${this.config.suffix.replace(/^\\/+/, '')}`;\n    if (uri.query) url += `?${this.config.extraRefinementsParam}=${encodeURIComponent(uri.query)}`;\n\n    return url.replace(/\\s|%20/g, '+');\n  }\n\n  private generateRefinementMap(refinements: SelectedRefinement[]): { map: any, keys: string[] } {\n    const refinementMap = {};\n    const refinementKeys = [];\n    for (let mapping of this.config.refinementMapping) {\n      const key = Object.keys(mapping)[0];\n      const matchingRefinements = refinements.filter((refinement) => refinement.navigationName === mapping[key]);\n      if (matchingRefinements.length) {\n        refinementKeys.push(key);\n        refinementMap[key] = matchingRefinements;\n        matchingRefinements.forEach((ref) => refinements.splice(refinements.indexOf(ref), 1));\n      }\n    }\n    return { map: refinementMap, keys: refinementKeys };\n  }\n\n  private convertRefinement(refinement: SelectedRefinement): string {\n    if (refinement.type === 'Value') {\n      return (<SelectedValueRefinement>refinement).value;\n    } else {\n      throw new Error('cannot map range refinements');\n    }\n  }\n\n  private stringifyRefinement(refinement: SelectedRefinement): string {\n    const name = refinement.navigationName;\n    if (refinement.type === 'Value') {\n      return `${name}=${(<SelectedValueRefinement>refinement).value}`;\n    } else {\n      return `${name}:${(<SelectedRangeRefinement>refinement).low}..${(<SelectedRangeRefinement>refinement).high}`;\n    }\n  }\n}\n\nexport class UrlParser {\n\n  searchandiserConfig: SearchandiserConfig;\n  config: BeautifierConfig;\n  suffixRegex: RegExp;\n\n  constructor({ config, searchandiserConfig }: UrlBeautifier) {\n    this.config = config;\n    this.searchandiserConfig = searchandiserConfig;\n    this.suffixRegex = new RegExp(`^${this.config.suffix}`);\n  }\n\n  parse(rawUrl: string): Query {\n    const url = parseUri(rawUrl);\n    const paths = url.path.split('/').filter((val) => val);\n\n    if (paths[paths.length - 1] === this.config.suffix) paths.pop();\n\n    const keys = (paths.pop() || '').split('');\n    const map = this.generateRefinementMapping();\n    const query = new Query().withConfiguration(this.searchandiserConfig, CONFIGURATION_MASK);\n\n    for (let key of keys) {\n      if (!(key in map || key === this.config.queryToken)) {\n        throw new Error(`unexpected token '${key}' found in reference`);\n      }\n    }\n\n    if (paths.length < keys.length) throw new Error('token reference is invalid');\n\n    // remove prefixed paths\n    paths.splice(0, paths.length - keys.length);\n\n    for (let i = 0; i < keys.length; i++) {\n      if (keys[i] === this.config.queryToken) {\n        query.withQuery(this.decode(paths[i]));\n      } else {\n        query.withSelectedRefinements(...this.extractRefinements(paths[i], map[keys[i]]));\n      }\n    }\n\n    const unmappedRefinements = queryString.parse(url.query)[this.config.extraRefinementsParam];\n    if (unmappedRefinements) query.withSelectedRefinements(...this.extractUnmapped(unmappedRefinements));\n\n    return query;\n  }\n\n  private generateRefinementMapping() {\n    return this.config.refinementMapping.reduce((map, mapping) => Object.assign(map, mapping), {});\n  }\n\n  private extractRefinements(refinementString: string, navigationName: string): SelectedValueRefinement[] {\n    const refinementStrings = refinementString.split('~');\n\n    return <any[]>refinementStrings.map((value) => ({ navigationName, type: 'Value', value: this.decode(value) }));\n  }\n\n  private extractUnmapped(refinementString: string): Array<SelectedValueRefinement | SelectedRangeRefinement> {\n    const refinementStrings = refinementString.split('~');\n    return refinementStrings\n      .map(this.decode)\n      .map((refinement) => {\n        const [navigationName, value] = refinement.split(/=|:/);\n        if (value.indexOf('..') >= 0) {\n          const [low, high] = value.split('..');\n          return <any>{ navigationName, low: Number(low), high: Number(high), type: 'Range' };\n        } else {\n          return <any>{ navigationName, value, type: 'Value' };\n        }\n      });\n  }\n\n  private decode(value: string): string {\n    return decodeURIComponent(value.replace('+', ' '));\n  }\n}\n\nexport interface BeautifierConfig {\n  refinementMapping?: any[];\n  extraRefinementsParam?: string;\n  queryToken?: string;\n  suffix?: string;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/utils/url-beautifier.ts\n **/","import { Services } from '../services/init';\nimport { checkBooleanAttr, getPath } from '../utils/common';\nimport { FluxCapacitor } from 'groupby-api';\nimport * as riot from 'riot';\nimport { Sayt } from 'sayt';\n\nconst sayt = new Sayt();\n\nexport interface FluxTag<T> extends riot.Tag.Instance {\n  parent: riot.Tag.Instance & FluxTag<any> & any;\n\n  flux: FluxCapacitor;\n  services: Services;\n  config: any;\n}\n\nexport class FluxTag<T> {\n  _tagName: string;\n  _simpleTagName: string;\n  _camelTagName: string;\n  _parents: any;\n  _parentsList: any[];\n  _scope: FluxTag<any> & any;\n  _top: FluxTag<any> & any;\n  _style: string;\n  _config: T;\n\n  init() {\n    this._style = this.config.stylish ? 'gb-stylish' : '';\n    setTagName(this);\n    setParents(this);\n    setScope(this);\n  }\n\n  _mixin(...mixins: any[]) {\n    this.mixin(...mixins.map((mixin) => new mixin().__proto__));\n  }\n\n  _scopeTo(scope: string) {\n    this._scope = this._parents[scope];\n  }\n\n  findParent(tag: riot.Tag.Instance, name: string) {\n    let parentTag: riot.Tag.Instance = tag;\n    while (parentTag.root.localName !== name && parentTag.parent) {\n      parentTag = parentTag.parent;\n    }\n    return parentTag;\n  }\n\n  configure(defaultConfig: any = {}) {\n    const rawConfig = Object.assign(\n      {},\n      defaultConfig,\n      getPath(this.config, `tags.${this._camelTagName}`),\n      this.opts.__proto__,\n      this.opts);\n    for (let key of Object.keys(rawConfig)) {\n      if (typeof defaultConfig[key] === 'boolean'\n        || rawConfig[key] == true // tslint:disable-line:triple-equals\n        || rawConfig[key] == false) { // tslint:disable-line:triple-equals\n        rawConfig[key] = checkBooleanAttr(key, rawConfig);\n      }\n    }\n    this._config = rawConfig;\n  }\n}\n\nexport interface SaytTag<T> extends FluxTag<T> { }\n\nexport class SaytTag<T> {\n\n  sayt: any;\n\n  init() {\n    this.sayt = sayt;\n  }\n}\n\nexport function setTagName(tag: FluxTag<any>) {\n  const htmlTagName = tag.root.tagName.toLowerCase();\n  const tagName = htmlTagName.startsWith('gb-') ?\n    htmlTagName :\n    tag.root.dataset['is'] || tag.root.getAttribute('riot-tag');\n\n  if (tagName) {\n    tag._tagName = tagName;\n    tag._simpleTagName = tag._tagName.replace(/^gb-/, '');\n    tag._camelTagName = tag._simpleTagName.replace(/-([a-z])/g, (match) => match[1].toUpperCase());\n  }\n}\n\nexport function setParents(tag: FluxTag<any>) {\n  tag._parents = tag.parent ? Object.assign({}, tag.parent['_parents']) : {};\n  if (tag._tagName) {\n    tag._parents[tag._tagName] = tag;\n  }\n\n  tag._parentsList = [];\n  let currTag = tag;\n  while (currTag = currTag.parent) tag._parentsList.push(currTag);\n}\n\n// somehow this function isn't working for the gb-select inside gb-sort\nexport function setScope(tag: FluxTag<any>) {\n  if (tag._parents && tag._parents[tag.opts.scope]) {\n    tag._scope = tag._parents[tag.opts.scope];\n  } else if (tag.parent && tag.parent._scope) {\n    tag._scope = tag.parent._scope;\n  } else {\n    let parent: any = tag;\n    while (parent.parent) tag._scope = parent = parent.parent;\n    tag._top = tag._scope;\n  }\n}\n\nexport function MixinFlux(flux: FluxCapacitor, config: any, services: any): FluxTag<any> {\n  return Object.assign(new FluxTag()['__proto__'], { flux, config, services });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/tag.ts\n **/","module.exports = require(\"sayt\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"sayt\"\n ** module id = 29\n ** module chunks = 0\n **/","import { BridgeConfig, SearchandiserConfig } from '../searchandiser';\nimport { Sort } from 'groupby-api';\nimport oget = require('oget');\n\nexport const DEFAULT_CONFIG: SearchandiserConfig = <any>{\n  initialSearch: true,\n\n  url: {\n    queryParam: 'q',\n    searchUrl: 'search'\n  }\n};\n\nexport interface ConfigurationHandler {\n  <T>(configOrValue: T): T;\n}\n\nexport type HandlerMap = { [key: string]: ConfigurationHandler };\n\nexport class Configuration {\n\n  handlers: HandlerMap = {\n    bridge: (config: BridgeConfig = {}) => {\n      const headers = config.headers || {};\n      if (config.skipCache) {\n        headers['Skip-Caching'] = 'true';\n      }\n      if (config.skipSemantish) {\n        headers['Skip-Semantish'] = 'true';\n      }\n\n      return Object.assign(config, { headers });\n    },\n    sort: (sort: Sort) => {\n      if (!sort) {\n        let sortOptions = oget(this.rawConfig, 'tags.sort.options');\n        if (sortOptions && sortOptions.length > 0) {\n          return sortOptions.map((val) => val.value)[0];\n        }\n      }\n      return sort;\n    },\n    pageSize: (pageSize: number) => {\n      if (!pageSize) {\n        let pageSizes = this.rawConfig.pageSizes;\n        if (pageSizes && pageSizes.length > 0) {\n          return pageSizes[0];\n        }\n      }\n      return pageSize;\n    }\n  };\n\n  constructor(public rawConfig: SearchandiserConfig) { }\n\n  apply() {\n    Configuration.validate(this.rawConfig);\n    const config = Configuration.applyDefaults(this.rawConfig, DEFAULT_CONFIG);\n    return Configuration.transform(config, this.handlers);\n  }\n\n  static applyDefaults(config: SearchandiserConfig, defaults: SearchandiserConfig) {\n    for (let key of Object.keys(defaults)) {\n      if (typeof defaults[key] === 'object') {\n        config[key] = Object.assign(config[key] || {}, defaults[key]);\n      } else {\n        config[key] = defaults[key];\n      }\n    }\n    return config;\n  }\n\n  static transform(config: SearchandiserConfig, handlers: HandlerMap) {\n    for (let key of Object.keys(handlers)) {\n      config[key] = handlers[key](config[key]);\n    }\n    return config;\n  }\n\n  static validate(config: SearchandiserConfig) {\n    if (!config.structure) {\n      throw 'must provide a record structure';\n    }\n    const struct = Object.assign({}, config.structure, config.structure._variantStructure);\n    if (!(struct.title && struct.title.trim())) {\n      throw 'structure.title must be the path to the title field';\n    }\n    if (!(struct.price && struct.price.trim())) {\n      throw 'structure.price must be the path to the price field';\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/utils/configuration.ts\n **/","module.exports = require(\"riot\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"riot\"\n ** module id = 31\n ** module chunks = 0\n **/","import './breadcrumbs/gb-breadcrumbs.tag.html';\nimport './carousel/gb-carousel.tag.html';\nimport './category-menu/gb-category-menu.tag.html';\nimport './collections/gb-collections.tag.html';\nimport './details/gb-details.tag.html';\nimport './did-you-mean/gb-did-you-mean.tag.html';\nimport './filter/gb-filter.tag.html';\nimport './navigation/gb-navigation.tag.html';\nimport './page-size/gb-page-size.tag.html';\nimport './paging/gb-pager.tag.html';\nimport './paging/gb-pages.tag.html';\nimport './paging/gb-paging.tag.html';\nimport './paging/gb-terminal-pager.tag.html';\nimport './query/gb-query.tag.html';\nimport './raw/gb-raw.tag.html';\nimport './record-count/gb-record-count.tag.html';\nimport './related-queries/gb-related-queries.tag.html';\nimport './reset/gb-reset.tag.html';\nimport './results/gb-results.tag.html';\nimport './sayt/gb-sayt.tag.html';\nimport './select/gb-select.tag.html';\nimport './snippet/gb-snippet.tag.html';\nimport './sort/gb-sort.tag.html';\nimport './submit/gb-submit.tag.html';\nimport './template/gb-template.tag.html';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/index.ts\n **/","import './gb-query-crumb.tag.html';\nimport '../list/gb-list.tag.html';\nimport './gb-refinement-crumb.tag.html';\nimport { Breadcrumbs } from './gb-breadcrumbs';\nriot.tag2('gb-breadcrumbs', '<yield> <div class=\"gb-breadcrumbs {_style}\"> <gb-query-crumb if=\"{!_config.hideQuery}\"></gb-query-crumb> <gb-list items=\"{selected}\" if=\"{!_config.hideRefinements}\" scope=\"gb-breadcrumbs\"> <gb-list class=\"gb-navigation-crumb\" items=\"{item.refinements}\" inline> <gb-refinement-crumb nav=\"{parent.item}\" ref=\"{item}\"></gb-refinement-crumb> </gb-list> </gb-list> </div> </yield>', 'gb-breadcrumbs .gb-stylish.gb-breadcrumbs,[riot-tag=\"gb-breadcrumbs\"] .gb-stylish.gb-breadcrumbs,[data-is=\"gb-breadcrumbs\"] .gb-stylish.gb-breadcrumbs{ display: flex; justify-content: flex-start; align-items: baseline; }', '', function(opts) {\n    this._mixin(Breadcrumbs);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/breadcrumbs/gb-breadcrumbs.tag.html\n **/","riot.tag2('gb-query-crumb', '<div if=\"{originalQuery}\"> <span if=\"{!_scope.correctedQuery && _scope._config.labels}\" class=\"gb-query-label\">{_scope._config.resultsLabel}</span> <span if=\"{_scope.correctedQuery && _scope._config.labels}\" class=\"gb-query-label\">{_scope._config.noResultsLabel}</span> <span class=\"gb-original-query\">{originalQuery}</span> </div> <div if=\"{correctedQuery}\"> <span if=\"{_scope._config.labels}\" class=\"gb-query-label\">{_scope._config.correctedResultsLabel}</span> <span class=\"gb-corrected-query\">{correctedQuery}</span> </div>', '', '', function(opts) {\n    this._scopeTo('gb-breadcrumbs');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/breadcrumbs/gb-query-crumb.tag.html\n **/","riot.tag2('gb-list', '<ul class=\"{_style} {inline: \\'inline\\' in opts}\"> <li each=\"{item, i in opts.items}\" class=\"{active: isActive(i)}\"> <yield></yield> </li> </ul>', 'gb-list > ul.gb-stylish { list-style: none; margin: 0; padding: 0; } gb-list > ul.gb-stylish > li { margin: 0 10px; } gb-list > ul.gb-stylish.inline > li { display: inline-block; } gb-list > ul.gb-stylish a { color: #888; cursor: pointer; } gb-list > ul.gb-stylish a:hover { color: black; }', '', function(opts) {\n    this.isActive = opts.activation;\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/list/gb-list.tag.html\n **/","riot.tag2('gb-refinement-crumb', '<a onclick=\"{remove}\">&times;</a> <b>{nav.displayName}: {_scope.toView(ref)}</b>', '', '', function(opts) {\n    this.remove = () => this._scope.remove(opts.ref, opts.nav);\n    this.nav = opts.nav;\n    this.ref = opts.ref;\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/breadcrumbs/gb-refinement-crumb.tag.html\n **/","import { displayRefinement, toRefinement } from '../../utils/common';\nimport { FluxTag } from '../tag';\nimport { Events, Results } from 'groupby-api';\n\nexport interface BreadcrumbsConfig {\n  hideQuery?: boolean;\n  hideRefinements?: boolean;\n  labels?: boolean;\n  resultsLabel?: string;\n  noResultsLabel?: string;\n  correctedResultsLabel?: string;\n}\n\nexport const DEFAULT_CONFIG: BreadcrumbsConfig = {\n  hideQuery: false,\n  hideRefinements: false,\n  labels: true,\n  resultsLabel: 'Results for:',\n  noResultsLabel: 'No results for:',\n  correctedResultsLabel: 'Showing results for:'\n};\n\nexport interface Breadcrumbs extends FluxTag<BreadcrumbsConfig> { }\n\nexport class Breadcrumbs {\n\n  selected: any[];\n  originalQuery: string;\n  toView: typeof displayRefinement;\n  correctedQuery: string;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n    this.toView = displayRefinement;\n\n    this.flux.on(Events.RESULTS, this.updateQueryState);\n    this.flux.on(Events.RESET, this.clearRefinements);\n  }\n\n  clearRefinements() {\n    this.update({ selected: [] });\n  }\n\n  updateQueryState({ originalQuery, selectedNavigation, correctedQuery }: Results) {\n    this.update({ originalQuery, selected: selectedNavigation, correctedQuery });\n  }\n\n  remove(ref: any, nav: any) {\n    this.flux.unrefine(toRefinement(ref, nav));\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/breadcrumbs/gb-breadcrumbs.ts\n **/","import '../list/gb-list.tag.html';\nimport { Carousel } from './gb-carousel';\nriot.tag2('gb-carousel', '<a class=\"gb-carousel__previous-link\" onclick=\"{prev}\">Prev</a> <gb-list items=\"{options}\" activation=\"{isSelected}\"> <yield></yield> </gb-list> <a class=\"gb-carousel__next-link\" onclick=\"{next}\">Next</a>', 'gb-carousel gb-list > ul > li:not(.active),[riot-tag=\"gb-carousel\"] gb-list > ul > li:not(.active),[data-is=\"gb-carousel\"] gb-list > ul > li:not(.active){ display: none; }', '', function(opts) {\n    this._mixin(Carousel);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/carousel/gb-carousel.tag.html\n **/","import { unless } from '../../utils/common';\nimport { FluxTag } from '../tag';\n\nexport interface CarouselConfig {\n  options: any[];\n}\n\nexport interface Carousel extends FluxTag<CarouselConfig> { }\n\nexport class Carousel {\n\n  currentIndex: number;\n  options: any[];\n\n  init() {\n    this.configure();\n    this.currentIndex = 0;\n    this.options = unless(this._config.options, this._scope.options, []);\n  }\n\n  isSelected(index: number) {\n    return this.currentIndex === index;\n  }\n\n  next() {\n    this.update({ currentIndex: Math.min(this.currentIndex + 1, this.options.length - 1) });\n  }\n\n  prev() {\n    this.update({ currentIndex: Math.max(this.currentIndex - 1, 0) });\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/carousel/gb-carousel.ts\n **/","import './gb-category-dropdown.tag.html';\nimport './gb-category-section.tag.html';\nriot.tag2('gb-category-menu', '<div class=\"gb-menu {_style}\"> <div class=\"gb-menu__item\" each=\"{opts.sections}\"> <gb-category-dropdown class=\"gb-category-dropdown\"></gb-category-dropdown> </div> </div>', 'gb-category-menu .gb-stylish.gb-menu,[riot-tag=\"gb-category-menu\"] .gb-stylish.gb-menu,[data-is=\"gb-category-menu\"] .gb-stylish.gb-menu{ display: flex; flex-direction: row; justify-content: center; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/category-menu/gb-category-menu.tag.html\n **/","riot.tag2('gb-category-dropdown', '<div class=\"gb-dropdown {_style}\"> <button type=\"button\" class=\"gb-dropdown__button\">{name}</button> <div class=\"gb-dropdown__content\"> <gb-category-section if=\"{items}\"></gb-category-section> <gb-category-section each=\"{subsections}\" named=\"{true}\"></gb-category-section> </div> <div class=\"gb-dropdown__images\"> <img src=\"\" each=\"{results.images}\"> </div> </div>', 'gb-category-dropdown .gb-dropdown,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown,[data-is=\"gb-category-dropdown\"] .gb-dropdown{ position: relative; display: inline-block; } gb-category-dropdown .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-dropdown__content{ display: none; position: absolute; min-width: 160px; background-color: #fff; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); } gb-category-dropdown .gb-dropdown:hover .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-dropdown:hover .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-dropdown:hover .gb-dropdown__content{ display: block; } gb-category-dropdown .gb-stylish .gb-dropdown__button,[riot-tag=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__button,[data-is=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__button{ border: none; cursor: pointer; padding: 16px; width: 100%; } gb-category-dropdown .gb-stylish .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-stylish .gb-dropdown__content{ flex-wrap: wrap; background-color: #f9f9f9; min-width: 272px; } gb-category-dropdown .gb-stylish.gb-dropdown:hover .gb-dropdown__content,[riot-tag=\"gb-category-dropdown\"] .gb-stylish.gb-dropdown:hover .gb-dropdown__content,[data-is=\"gb-category-dropdown\"] .gb-stylish.gb-dropdown:hover .gb-dropdown__content{ display: flex; }', '', function(opts) {\n    const sayt = require('sayt');\n    this.parentOpts = this.parent.opts;\n    const saytConfig = Object.assign({ products: 4 }, this.parentOpts.config.sayt);\n\n    sayt.configure({\n      subdomain: this.parentOpts.config.customerId,\n      collection: this.parentOpts.config.collection,\n      autocomplete: {},\n      productSearch: { area: this.parentOpts.config.area, numProducts: saytConfig.products }\n    });\n\n    this.updateSectionImages = (event) => console.dir(event.target);\n    this.updateCategoryImages = (event) => console.dir(event.target);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/category-menu/gb-category-dropdown.tag.html\n **/","riot.tag2('gb-category-section', '<div class=\"gb-category-section {_style}\"> <a if=\"{opts.named}\" class=\"gb-category-section__header\" onmouseover=\"{updateSectionImages}\" data-try=\"{name}\">{name}</a> <a each=\"{item in items}\" class=\"gb-category-section__link\" onmouseover=\"{updateCategoryImages}\">{item}</a> </div>', 'gb-category-section .gb-stylish.gb-category-section,[riot-tag=\"gb-category-section\"] .gb-stylish.gb-category-section,[data-is=\"gb-category-section\"] .gb-stylish.gb-category-section{ min-width: 120px; flex-wrap: wrap; padding: 6px 8px; } gb-category-section .gb-stylish .gb-category-section__header,[riot-tag=\"gb-category-section\"] .gb-stylish .gb-category-section__header,[data-is=\"gb-category-section\"] .gb-stylish .gb-category-section__header{ padding: 6px 4px; margin: 0; font-size: 1.1em; font-weight: bold; } gb-category-section .gb-stylish a,[riot-tag=\"gb-category-section\"] .gb-stylish a,[data-is=\"gb-category-section\"] .gb-stylish a{ padding: 3px 4px; text-decoration: none; display: block; } gb-category-section .gb-stylish a:hover,[riot-tag=\"gb-category-section\"] .gb-stylish a:hover,[data-is=\"gb-category-section\"] .gb-stylish a:hover{ background-color: #f1f1f1; }', '', function(opts) {\n    this.parentOpts = this.parent.parent.opts;\n    this.updateSectionImages = this.parent.parent.updateSectionImages;\n    this.updateCategoryImages = this.parent.parent.updateCategoryImages;\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/category-menu/gb-category-section.tag.html\n **/","import './gb-collection-item.tag.html';\nimport './gb-collection-dropdown-item.tag.html';\nimport '../badge/gb-badge.tag.html';\nimport '../list/gb-list.tag.html';\nimport '../select/gb-select.tag.html';\nimport { Collections } from './gb-collections';\nriot.tag2('gb-collections', '<yield> <gb-list class=\"gb-collections {_style}\" items=\"{collections}\" if=\"{!_config.dropdown}\" scope=\"gb-collections\" inline> <gb-collection-item></gb-collection-item> </gb-list> <gb-select if=\"{_config.dropdown}\" scope=\"gb-collections\"> <gb-custom-select> <gb-collection-dropdown-item></gb-collection-dropdown-item> </gb-custom-select> </gb-select> </yield>', '', '', function(opts) {\n    this._mixin(Collections);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/collections/gb-collections.tag.html\n **/","import '../badge/gb-badge.tag.html';\nriot.tag2('gb-collection-item', '<a class=\"gb-collection\" data-collection=\"{item}\" onclick=\"{_scope.switchCollection}\"> <span class=\"gb-collection__name\">{_scope.labels[item] || item}</span> <gb-badge if=\"{_scope._config.counts}\">{_scope.counts[item]}</gb-badge> </a>', '', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/collections/gb-collection-item.tag.html\n **/","riot.tag2('gb-badge', '<span class=\"{_style}\"><yield></yield></span>', 'gb-badge .gb-stylish,[riot-tag=\"gb-badge\"] .gb-stylish,[data-is=\"gb-badge\"] .gb-stylish{ display: inline-block; min-width: 10px; max-height: 20px; padding: 4px 7px; border-radius: 10px; font-size: 12px; font-weight: bold; line-height: 1; color: #fff; background-color: #ccc; text-align: center; white-space: nowrap; vertical-align: middle; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/badge/gb-badge.tag.html\n **/","riot.tag2('gb-collection-dropdown-item', '<a class=\"gb-collection\" onclick=\"{selectDropdown}\"> <span class=\"gb-collection__name\">{option.label || option}</span> <gb-badge>{_scope.counts[option.value || option]}</gb-badge> </a>', '', '', function(opts) {\n    this.selectDropdown = () => {\n      if (typeof this.option === 'object') {\n        this._scope.selectCustom(this.option);\n      } else {\n        this._scope.selectCustom({\n          label: this.option,\n          value: this.option\n        });\n      }\n    };\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/collections/gb-collection-dropdown-item.tag.html\n **/","import './gb-native-select.tag.html';\nimport './gb-custom-select.tag.html';\nimport { Select } from './gb-select';\nriot.tag2('gb-select', '<yield> <gb-native-select if=\"{_config.native}\"></gb-native-select> <gb-custom-select if=\"{!_config.native}\"></gb-custom-select> </yield>', '', '', function(opts) {\n    this._mixin(Select);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-select.tag.html\n **/","import { Select } from './gb-select';\nriot.tag2('gb-native-select', '<select name=\"selector\" onchange=\"{_scope.selectNative}\"> <option if=\"{!_scope.default}\" value=\"\" selected disabled>{_scope.selectLabel()}</option> <option each=\"{option in _scope.options}\" if=\"{!option.clear}\" value=\"{optionValue(option)}\">{optionLabel(option)}</option> </select>', '', '', function(opts) {\n    this.optionLabel = Select.optionLabel;\n    this.optionValue = Select.optionValue;\n    this._scopeTo('gb-select');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-native-select.tag.html\n **/","import { FluxTag } from '../tag';\n\nexport interface SelectConfig {\n  label?: string;\n  clear?: string;\n  hover?: boolean;\n  native?: boolean;\n}\n\nexport interface SelectTag<T extends SelectConfig> extends FluxTag<T> {\n  options: any[];\n  onselect: Function;\n}\n\nexport interface Select<T extends SelectConfig> extends FluxTag<T> {\n  _scope: SelectTag<T>;\n}\n\nexport class Select<T extends SelectConfig> {\n\n  iconUrl: string;\n  label: string;\n  clearOption: { label: string, clear: boolean };\n  options: any[];\n  callback: Function;\n  selectedOption: any;\n  default: boolean;\n  selected: any;\n  focused: boolean;\n\n  init(): void {\n    this._config = this._scope._config;\n\n    this.iconUrl = require('./arrow-down.png');\n    this.label = this._config.label || 'Select';\n    this.clearOption = { label: this._config.clear || 'Unselect', clear: true };\n    this.options = this._scope.options || [];\n    this.callback = this._scope.onselect;\n    this.default = !('clear' in this._config);\n\n    if (this.default) {\n      this.selectedOption = typeof this.options[0] === 'object' ? this.options[0].label : this.options[0];\n    }\n  }\n\n  updateOptions(options: any[]) {\n    this.update({ options: this.default ? options : [this.clearOption, ...options] });\n  }\n\n  selectLabel(): string {\n    return this.selectedOption || (this.selected ? this.clearOption : this.label);\n  }\n\n  prepFocus() {\n    return this.focused = false;\n  }\n\n  selectButton() {\n    return this.tags['gb-custom-select'].tags['gb-select-button'].root;\n  }\n\n  nativeSelect() {\n    if (this.tags['gb-native-select']) {\n      return this.tags['gb-native-select'].selector;\n    } else {\n      return this.root.querySelector('select');\n    }\n  }\n\n  unfocus() {\n    this.focused = this._config.hover || !this.focused;\n    if (!this.focused) this.selectButton().blur();\n  }\n\n  selectOption(selectedOption: string, value: any): void {\n    this.update({ selectedOption });\n    if (this.callback) {\n      try {\n        this.callback(JSON.parse(value));\n      } catch (e) {\n        this.callback(value || '*');\n      }\n    }\n  }\n\n  selectNative(event: Event) {\n    const [option] = Array.from((<HTMLSelectElement>event.target).selectedOptions);\n    const selected = option.value;\n    this.nativeSelect().options[0].disabled = !selected;\n    this.update({ selected });\n    this.selectOption(option.text, selected);\n  }\n\n  selectCustom({ value, label }: { value: string, label: string }) {\n    this.selectButton().blur();\n    this.selectOption(label, value);\n  }\n\n  clearSelection() {\n    return this.selectOption(undefined, '*');\n  }\n\n  static optionValue(option: any) {\n    return typeof option === 'object' ? JSON.stringify(option.value) : option;\n  }\n\n  static optionLabel(option: any) {\n    return typeof option === 'object' ? option.label : option;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/select/gb-select.ts\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAPFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQLyYwAAAAE3RSTlMADQ46Ozw9SElKS0y5x+zz9Pj5WslQRAAAAQdJREFUeJztzlcOwkAQBFFyxjbM/e9KFsbrNGK3V6Cq/1a/yYSIiIiIiIiIiIiIfqRp8kF/q2LtG+yLedT/yk4uwf5sZUTBsjJzCa7/FlFw//cI7v/xBMvSzCV4/scSLF7/ZueN6z+OoPY/TlD7jyI4mLkEH/9mh68Bs6NL0Pg/zr4G+AQJ/l2CJP8OQaL/ULAV/48UJPwfJUj6P0KQ+H9QkPx/QCD4DwU78X+PQPTfKZD9dwiE/60C6X+LQPwfCtT/gUD+3yfQ/HcLVP9dAt1/u0D53ybQ/ocC9X9ToP//FOT4rwvy/L8Fuf5fgnz/D0HO/5sg7/9VkPmfiIiIiIiIiIiIiP6gC0vzP5P1npi3AAAAAElFTkSuQmCC\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/tags/select/arrow-down.png\n ** module id = 50\n ** module chunks = 0\n **/","import './gb-select-button.tag.html';\nimport './gb-option-list.tag.html';\nimport './gb-option.tag.html';\nriot.tag2('gb-custom-select', '<div class=\"gb-select {_scope._config.hover ? \\'hoverable\\' : \\'clickable\\'} {_style}\"> <button data-is=\"gb-select-button\" type=\"button\"></button> <gb-option-list> <yield> <gb-option option=\"{option}\" send=\"{option.clear ? _scope.clearSelection : _scope.selectCustom}\"></gb-option> </yield> </gb-option-list> </div>', 'gb-custom-select .gb-select,[riot-tag=\"gb-custom-select\"] .gb-select,[data-is=\"gb-custom-select\"] .gb-select{ position: relative; display: inline-block; } gb-custom-select gb-option-list,[riot-tag=\"gb-custom-select\"] gb-option-list,[data-is=\"gb-custom-select\"] gb-option-list{ display: none; z-index: 100; position: absolute; min-width: 160px; background-color: #f6f6f6; box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); max-height: 300px; overflow-y: scroll; } gb-custom-select .gb-select.hoverable:hover gb-option-list,[riot-tag=\"gb-custom-select\"] .gb-select.hoverable:hover gb-option-list,[data-is=\"gb-custom-select\"] .gb-select.hoverable:hover gb-option-list,gb-custom-select .gb-select.clickable button:focus + gb-option-list,[riot-tag=\"gb-custom-select\"] .gb-select.clickable button:focus + gb-option-list,[data-is=\"gb-custom-select\"] .gb-select.clickable button:focus + gb-option-list,gb-custom-select gb-option-list:hover,[riot-tag=\"gb-custom-select\"] gb-option-list:hover,[data-is=\"gb-custom-select\"] gb-option-list:hover{ display: block; } gb-custom-select .gb-stylish.gb-select:hover button,[riot-tag=\"gb-custom-select\"] .gb-stylish.gb-select:hover button,[data-is=\"gb-custom-select\"] .gb-stylish.gb-select:hover button,gb-custom-select .gb-stylish.gb-select button:focus,[riot-tag=\"gb-custom-select\"] .gb-stylish.gb-select button:focus,[data-is=\"gb-custom-select\"] .gb-stylish.gb-select button:focus{ border-color: #aaa; } gb-custom-select button,[riot-tag=\"gb-custom-select\"] button,[data-is=\"gb-custom-select\"] button{ overflow-x: hidden; display: flex; align-items: center; font-size: 14px; border: none; cursor: pointer; padding: 8px 16px; width: 100%; background-color: #eee; border: 2px solid #ddd; border-radius: 4px; white-space: nowrap; } gb-custom-select .gb-stylish button:focus,[riot-tag=\"gb-custom-select\"] .gb-stylish button:focus,[data-is=\"gb-custom-select\"] .gb-stylish button:focus{ outline: none; }', '', function(opts) {\n    this._scopeTo('gb-select');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-custom-select.tag.html\n **/","riot.tag2('gb-select-button', '<yield> <span class=\"gb-button__label\">{_scope.selectLabel()}</span> <img riot-src=\"{_scope.iconUrl}\" alt=\"\"> </yield>', 'gb-select-button img,[riot-tag=\"gb-select-button\"] img,[data-is=\"gb-select-button\"] img{ margin-left: 10px; margin-top: 2px; height: 24px; }', '', function(opts) {\n    this.root.addEventListener('focus', this._scope.prepFocus);\n    this.root.addEventListener('click', this._scope.unFocus);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-select-button.tag.html\n **/","riot.tag2('gb-option-list', '<ul> <li each=\"{option in _scope.options}\" class=\"gb-select__option {clear: option.clear}\" if=\"{option.clear ? _scope.selectedOption : true}\"> <yield></yield> </li> </ul>', 'gb-option-list ul,[riot-tag=\"gb-option-list\"] ul,[data-is=\"gb-option-list\"] ul{ margin: 0; padding: 0; list-style: none; } gb-option-list ul:hover,[riot-tag=\"gb-option-list\"] ul:hover,[data-is=\"gb-option-list\"] ul:hover{ display: block; } gb-option-list a,[riot-tag=\"gb-option-list\"] a,[data-is=\"gb-option-list\"] a{ cursor: pointer; display: block; text-decoration: none; color: black; padding: 10px 12px; } gb-option-list a:hover,[riot-tag=\"gb-option-list\"] a:hover,[data-is=\"gb-option-list\"] a:hover{ background-color: #eee; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-option-list.tag.html\n **/","import { Select } from './gb-select';\nriot.tag2('gb-option', '<a onclick=\"{send}\">{label}</a>', '', '', function(opts) {\n    this.label = Select.optionLabel(opts.option);\n    this.value = Select.optionValue(opts.option);\n    this.send = () => opts.send(this);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/select/gb-option.tag.html\n **/","import { COLLECTIONS_UPDATED_EVENT } from '../../services/collections';\nimport { SelectConfig, SelectTag } from '../select/gb-select';\n\nexport interface CollectionOption {\n  label: string;\n  value: string;\n}\n\nexport interface CollectionsConfig extends SelectConfig {\n  options: string[] | CollectionOption[];\n  counts?: boolean;\n  dropdown?: boolean;\n}\n\nexport const DEFAULT_CONFIG: CollectionsConfig = {\n  options: [],\n  counts: true,\n  dropdown: false\n};\n\nexport interface Collections extends SelectTag<CollectionsConfig> { }\n\nexport class Collections {\n\n  collections: string[];\n  counts: any;\n  labels: any;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.options = this._config.options;\n    const collectionsService = this.services.collections;\n    this.collections = collectionsService.collections;\n    this.labels = collectionsService.isLabeled\n      ? (<CollectionOption[]>this._config.options).reduce(this.extractLabels, {})\n      : {};\n\n    this.flux.on(COLLECTIONS_UPDATED_EVENT, this.updateCounts);\n  }\n\n  updateCounts(counts: any) {\n    this.update({ counts });\n  }\n\n  switchCollection(event: MouseEvent) {\n    let element = <HTMLElement>event.target;\n    while (element.tagName !== 'A') element = element.parentElement;\n    this.onselect(element.dataset['collection']);\n  }\n\n  onselect(collection: string) {\n    this.flux.switchCollection(collection);\n  }\n\n  private extractLabels(labels: any, collection: { value: string; label: string; }) {\n    return Object.assign(labels, { [collection.value]: collection.label });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/collections/gb-collections.ts\n **/","import { Details } from './gb-details';\nriot.tag2('gb-details', '<div class=\"gb-details\"> <yield></yield> </div>', '', '', function(opts) {\n    this._mixin(Details);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/details/gb-details.tag.html\n **/","import { getParam } from '../../utils/common';\nimport { ProductMeta, ProductTransformer } from '../../utils/product-transformer';\nimport { FluxTag } from '../tag';\nimport * as clone from 'clone';\nimport { Events, Record } from 'groupby-api';\n\nexport interface DetailsConfig {\n  idParam: string;\n}\n\nexport const DEFAULT_CONFIG: DetailsConfig = {\n  idParam: 'id'\n};\n\nexport interface Details extends FluxTag<DetailsConfig> { }\n\nexport class Details {\n\n  query: string;\n  struct: any;\n  allMeta: any;\n  transformer: ProductTransformer;\n  productMeta: ProductMeta;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.query = getParam(this._config.idParam);\n    this.struct = this.config.structure || {};\n    this.transformer = new ProductTransformer(this.struct);\n\n    this.flux.on(Events.DETAILS, this.updateRecord);\n    if (this.query) this.flux.details(this.query, this.transformer.idField);\n  }\n\n  updateRecord({ allMeta }: Record) {\n    const productMeta = this.transformer.transform(clone(allMeta, false));\n    this.update({ productMeta, allMeta: productMeta() });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/details/gb-details.ts\n **/","module.exports = require(\"clone\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"clone\"\n ** module id = 58\n ** module chunks = 0\n **/","import '../list/gb-list.tag.html';\nimport { DidYouMean } from './gb-did-you-mean';\nriot.tag2('gb-did-you-mean', '<yield> <gb-list class=\"{_style}\" items=\"{didYouMean}\" scope=\"gb-did-you-mean\" inline> <a onclick=\"{_scope.send}\">{item}</a> </gb-list> </yield>', '', '', function(opts) {\n    this._mixin(DidYouMean);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/did-you-mean/gb-did-you-mean.tag.html\n **/","import { FluxTag } from '../tag';\nimport { Events, Results } from 'groupby-api';\n\nexport interface DidYouMean extends FluxTag<any> { }\n\nexport class DidYouMean {\n\n  init() {\n    this.flux.on(Events.RESULTS, this.updateDidYouMean);\n  }\n\n  send(event: Event) {\n    this.flux.rewrite((<HTMLAnchorElement>event.target).text)\n      .then(() => this.services.tracker.didYouMean());\n  }\n\n  updateDidYouMean({ didYouMean }: Results) {\n    this.update({ didYouMean });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/did-you-mean/gb-did-you-mean.ts\n **/","import '../select/gb-select.tag.html';\nimport { Filter } from './gb-filter';\nriot.tag2('gb-filter', '<yield> <gb-select scope=\"gb-filter\"> </gb-select> </yield>', '', '', function(opts) {\n    this._mixin(Filter);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/filter/gb-filter.tag.html\n **/","import { FILTER_UPDATED_EVENT } from '../../services/filter';\nimport { toRefinement } from '../../utils/common';\nimport { SelectConfig, SelectTag } from '../select/gb-select';\nimport { Results } from 'groupby-api';\n\nexport interface FilterConfig extends SelectConfig {\n  field: string;\n}\n\nexport const DEFAULT_CONFIG: FilterConfig = {\n  field: undefined,\n  label: 'Filter',\n  clear: 'Unfiltered'\n};\n\nexport interface Filter extends SelectTag<FilterConfig> { }\n\nexport class Filter {\n\n  _config: FilterConfig;\n  selected: any;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.flux.on(FILTER_UPDATED_EVENT, this.updateValues);\n  }\n\n  convertRefinements(navigations: any[]): any[] {\n    const found = navigations.find(({ name }) => this.services.filter.isTargetNav(name));\n    return found ? found.refinements.map((ref) => ({ label: ref.value, value: ref })) : [];\n  }\n\n  updateValues(res: Results) {\n    const converted = this.convertRefinements(res.availableNavigation);\n    if (this.tags['gb-select']) {\n      this.tags['gb-select'].updateOptions(converted);\n    } else {\n      this.update({ options: converted });\n    }\n  }\n\n  onselect(value: any | '*') {\n    if (this.selected) this.flux.unrefine(this.selected, { skipSearch: true });\n    if (value === '*') {\n      this.flux.reset();\n    } else {\n      this.flux.refine(this.selected = toRefinement(value, <any>{ name: this._config.field }));\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/filter/gb-filter.ts\n **/","import './gb-refinement-list.tag.html';\nimport './gb-available-refinement.tag.html';\nimport './gb-selected-refinement.tag.html';\nimport { Navigation } from './gb-navigation';\nriot.tag2('gb-navigation', '<yield> <div class=\"gb-side-nav {_style}\"> <gb-refinement-list each=\"{nav in processed}\"></gb-refinement-list> </div> </yield>', 'gb-navigation .gb-stylish.gb-side-nav,[riot-tag=\"gb-navigation\"] .gb-stylish.gb-side-nav,[data-is=\"gb-navigation\"] .gb-stylish.gb-side-nav{ padding: 12px; }', '', function(opts) {\n    this._mixin(Navigation);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/navigation/gb-navigation.tag.html\n **/","riot.tag2('gb-refinement-list', '<div id=\"{nav.name}\" class=\"{_style}\"> <h4 class=\"gb-navigation-title\">{nav.displayName}</h4> <ul> <gb-selected-refinement if=\"{_config.showSelected}\" each=\"{ref in nav.selected}\"></gb-selected-refinement> <gb-available-refinement each=\"{ref in nav.refinements}\"></gb-available-refinement> <li class=\"gb-more-refinements\" if=\"{nav.moreRefinements}\"> <a href=\"#\" onclick=\"{moreRefinements}\">More</a> </li> </ul> </div>', 'gb-refinement-list .gb-stylish.gb-refinement-list .gb-navigation-title,[riot-tag=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list .gb-navigation-title,[data-is=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list .gb-navigation-title{ font-size: 18px; margin: 10px 0; } gb-refinement-list .gb-stylish.gb-refinement-list ul,[riot-tag=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list ul,[data-is=\"gb-refinement-list\"] .gb-stylish.gb-refinement-list ul{ margin: 0; padding-left: 8px; }', '', function(opts) {\n    this.moreRefinements = () => {\n      this.flux.refinements(this.nav.name);\n      this.nav.moreRefinements = false;\n    };\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/navigation/gb-refinement-list.tag.html\n **/","import '../badge/gb-badge.tag.html';\nimport { AvailableRefinement } from './gb-refinement';\nriot.tag2('gb-available-refinement', '<li class=\"gb-ref {_style}\"> <a class=\"gb-ref__link\" onclick=\"{send}\"> <span class=\"gb-ref__title\">{toView(ref)}</span> <span class=\"gb-filler\"></span> <gb-badge if=\"{_config.badge}\">{ref.count}</gb-badge> </a> </li>', 'gb-available-refinement .gb-stylish,[riot-tag=\"gb-available-refinement\"] .gb-stylish,[data-is=\"gb-available-refinement\"] .gb-stylish{ list-style: none; } gb-available-refinement .gb-stylish .gb-filler,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-filler,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-filler{ flex-grow: 1; } gb-available-refinement .gb-stylish .gb-ref__link,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-ref__link,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-ref__link{ cursor: pointer; display: flex; padding: 4px 6px; border-radius: 4px; color: black; font-size: 14px; text-decoration: none; align-items: baseline; } gb-available-refinement .gb-stylish .gb-ref__link:hover,[riot-tag=\"gb-available-refinement\"] .gb-stylish .gb-ref__link:hover,[data-is=\"gb-available-refinement\"] .gb-stylish .gb-ref__link:hover{ background-color: #ddd; }', '', function(opts) {\n    this._mixin(AvailableRefinement);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/navigation/gb-available-refinement.tag.html\n **/","import { displayRefinement } from '../../utils/common';\nimport { FluxTag } from '../tag';\n\nexport interface Refinement extends FluxTag<any> { }\n\nexport class Refinement {\n\n  ref: any;\n  nav: any;\n  toView: typeof displayRefinement;\n\n  init() {\n    this._scopeTo('gb-navigation');\n    this.toView = displayRefinement;\n  }\n}\n\nexport class AvailableRefinement extends Refinement {\n  send() {\n    return this._scope.send(this.ref, this.nav);\n  }\n}\n\nexport class SelectedRefinement extends Refinement {\n  remove() {\n    return this._scope.remove(this.ref, this.nav);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/navigation/gb-refinement.ts\n **/","import { SelectedRefinement } from './gb-refinement';\nriot.tag2('gb-selected-refinement', '<li class=\"gb-ref {_style}\"> <a class=\"gb-ref__link\" onclick=\"{remove}\">&times;</a> <span class=\"gb-ref__value\">{toView(ref)}</span> </li>', 'gb-selected-refinement .gb-stylish,[riot-tag=\"gb-selected-refinement\"] .gb-stylish,[data-is=\"gb-selected-refinement\"] .gb-stylish{ position: relative; list-style: none; padding: 4px 6px; font-size: 14px; } gb-selected-refinement .gb-stylish .gb-ref__link,[riot-tag=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link,[data-is=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link{ cursor: pointer; left: -8px; position: absolute; color: black; text-decoration: none; } gb-selected-refinement .gb-stylish .gb-ref__link:hover,[riot-tag=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link:hover,[data-is=\"gb-selected-refinement\"] .gb-stylish .gb-ref__link:hover{ color: red; font-weight: bold; }', '', function(opts) {\n    this._mixin(SelectedRefinement);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/navigation/gb-selected-refinement.tag.html\n **/","import { toRefinement } from '../../utils/common';\nimport { FluxTag } from '../tag';\nimport * as clone from 'clone';\nimport { Events, Navigation as NavModel, NavigationInfo, RefinementResults, Results } from 'groupby-api';\n\nexport { NavigationInfo }\n\nexport interface NavigationConfig {\n  badge?: boolean;\n  showSelected?: boolean;\n}\n\nexport const DEFAULT_CONFIG: NavigationConfig = {\n  badge: true,\n  showSelected: true\n};\n\nexport interface Navigation extends FluxTag<NavigationConfig> { }\n\nexport class Navigation {\n\n  processed: SelectionNavigation[];\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.flux.on(Events.RESULTS, this.updateNavigations);\n    this.flux.on(Events.REFINEMENT_RESULTS, this.updateRefinements);\n  }\n\n  updateNavigations(res: Results) {\n    this.update({ processed: this.processNavigations(res) });\n  }\n\n  updateRefinements(res: RefinementResults) {\n    this.update({ processed: this.replaceRefinements(res) });\n  }\n\n  replaceRefinements(res: RefinementResults) {\n    const found = this.processed.find((nav) => nav.name === res.navigation.name);\n    if (found) {\n      found.refinements = res.navigation.refinements;\n    }\n    return this.processed;\n  }\n\n  processNavigations({ selectedNavigation, availableNavigation }: Results) {\n    const processed = <SelectionNavigation[]>clone(availableNavigation);\n    selectedNavigation.forEach((selNav) => {\n      const availNav = processed.find((nav) => nav.name === selNav.name);\n      if (availNav) {\n        availNav.selected = selNav.refinements;\n      } else {\n        processed.unshift(Object.assign({}, selNav, { selected: selNav.refinements, refinements: [] }));\n      }\n    });\n    return processed;\n  }\n\n  send(ref: any, nav: any) {\n    return this.flux.refine(toRefinement(ref, nav));\n  }\n\n  remove(ref: any, nav: any) {\n    return this.flux.unrefine(toRefinement(ref, nav));\n  }\n}\n\nexport interface SelectionNavigation extends NavModel {\n  selected: any[];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/navigation/gb-navigation.ts\n **/","import '../select/gb-select.tag.html';\nimport { PageSize } from './gb-page-size';\nriot.tag2('gb-page-size', '<yield> <gb-select scope=\"gb-page-size\"> </gb-select> </yield>', '', '', function(opts) {\n    this._mixin(PageSize);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/page-size/gb-page-size.tag.html\n **/","import { SelectConfig, SelectTag } from '../select/gb-select';\n\nexport interface PageSizeConfig extends SelectConfig {\n  resetOffset?: boolean;\n}\n\nexport const DEFAULT_CONFIG = {\n  resetOffset: false\n};\n\nexport interface PageSize extends SelectTag<PageSizeConfig> { }\n\nexport class PageSize {\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.options = this.config.pageSizes || [10, 25, 50, 100];\n  }\n\n  onselect(value: number) {\n    this.flux.resize(value, this._config.resetOffset)\n      .then(() => this.services.tracker.search());\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/page-size/gb-page-size.ts\n **/","import '../icon/gb-icon.tag.html';\nimport { Pager } from './gb-pager';\nriot.tag2('gb-pager', '<div class=\"gb-pager {_style}\"> <a class=\"gb-pager__link prev {disabled: _scope.backDisabled}\" onclick=\"{_scope.pager.prev}\"> <gb-icon if=\"{_config.icons}\" value=\"{_config.prev_icon}\"></gb-icon> <span if=\"{_config.labels}\">{_config.prev_label}</span> </a> <yield></yield> <a class=\"gb-pager__link next {disabled: _scope.forwardDisabled}\" onclick=\"{_scope.pager.next}\"> <span if=\"{_config.labels}\">{_config.next_label}</span> <gb-icon if=\"{_config.icons}\" value=\"{_config.next_icon}\"></gb-icon> </a> </div>', 'gb-pager .gb-stylish a,[riot-tag=\"gb-pager\"] .gb-stylish a,[data-is=\"gb-pager\"] .gb-stylish a{ cursor: pointer; } gb-pager .gb-stylish.gb-pager,[riot-tag=\"gb-pager\"] .gb-stylish.gb-pager,[data-is=\"gb-pager\"] .gb-stylish.gb-pager{ display: flex; } gb-pager .gb-stylish .gb-pager__link,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link{ display: flex; text-decoration: none; color: #888; padding: 5px 14px; } gb-pager .gb-stylish .gb-pager__link:hover,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link:hover,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link:hover{ color: black; } gb-pager .gb-stylish .gb-pager__link.disabled,[riot-tag=\"gb-pager\"] .gb-stylish .gb-pager__link.disabled,[data-is=\"gb-pager\"] .gb-stylish .gb-pager__link.disabled{ color: #ddd; cursor: not-allowed; } gb-pager .gb-stylish gb-pages,[riot-tag=\"gb-pager\"] .gb-stylish gb-pages,[data-is=\"gb-pager\"] .gb-stylish gb-pages{ flex: 1; } gb-pager .gb-stylish gb-icon img,[riot-tag=\"gb-pager\"] .gb-stylish gb-icon img,[data-is=\"gb-pager\"] .gb-stylish gb-icon img{ width: 20px; }', '', function(opts) {\n    this._mixin(Pager);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/paging/gb-pager.tag.html\n **/","import { Icon } from './gb-icon';\nriot.tag2('gb-icon', '<i if=\"{classes}\" class=\"{classes}\"></i> <img if=\"{url}\" riot-src=\"{url}\"></img>', '', '', function(opts) {\n    this._mixin(Icon);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/icon/gb-icon.tag.html\n **/","import { FluxTag } from '../tag';\n\nexport const IMAGE_PATTERN = /.*\\..*/;\nexport const DATA_URL_PREFIX = 'data:image/';\n\nexport interface IconConfig {\n  value: string;\n}\n\nexport interface Icon extends FluxTag<IconConfig> { }\n\nexport class Icon {\n\n  url: string;\n  classes: string;\n\n  init() {\n    this.configure();\n    if (this.isImage(this._config.value)) {\n      this.url = this._config.value;\n    } else {\n      this.classes = this._config.value;\n    }\n  }\n\n  private isImage(value: string) {\n    const matches = value.match(IMAGE_PATTERN);\n    return (matches && matches.length > 0) || value.startsWith(DATA_URL_PREFIX);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/icon/gb-icon.ts\n **/","import { FluxTag } from '../tag';\nimport { PagingConfig } from './gb-paging';\n\nexport interface Pager extends FluxTag<PagingConfig> { }\n\nexport class Pager {\n\n  init() {\n    this._scopeTo('gb-paging');\n    this._config = this._scope._config;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/paging/gb-pager.ts\n **/","import { Pages } from './gb-pages';\nriot.tag2('gb-pages', '<ul class=\"gb-pages {_style}\" if=\"{_config.pages}\"> <span class=\"gb-pages__ellipsis\" if=\"{_scope.lowOverflow}\">&hellip;</span> <li each=\"{pageNumber in _scope.pageNumbers}\"> <a class=\"gb-pages__page {selected: _scope.currentPage === pageNumber}\" onclick=\"{jumpTo}\">{pageNumber}</a> </li> <span class=\"gb-pages__ellipsis\" if=\"{_scope.highOverflow}\">&hellip;</span> </ul>', 'gb-pages .gb-stylish a,[riot-tag=\"gb-pages\"] .gb-stylish a,[data-is=\"gb-pages\"] .gb-stylish a{ cursor: pointer; } gb-pages .gb-stylish.gb-pages,[riot-tag=\"gb-pages\"] .gb-stylish.gb-pages,[data-is=\"gb-pages\"] .gb-stylish.gb-pages{ margin: 0; padding: 0; list-style: none; display: flex; align-items: center; justify-content: center; height: 100%; } gb-pages .gb-stylish.gb-pages li,[riot-tag=\"gb-pages\"] .gb-stylish.gb-pages li,[data-is=\"gb-pages\"] .gb-stylish.gb-pages li{ display: inline; } gb-pages .gb-stylish .gb-pages__page,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page,gb-pages .gb-stylish .gb-pages__ellipsis,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__ellipsis,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__ellipsis{ text-decoration: none; color: #888; } gb-pages .gb-stylish .gb-pages__page,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page{ padding: 0 4px; } gb-pages .gb-stylish .gb-pages__page:hover,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page:hover,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page:hover,gb-pages .gb-stylish .gb-pages__page.selected,[riot-tag=\"gb-pages\"] .gb-stylish .gb-pages__page.selected,[data-is=\"gb-pages\"] .gb-stylish .gb-pages__page.selected{ color: black; }', '', function(opts) {\n    this._mixin(Pages);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/paging/gb-pages.tag.html\n **/","import { FluxTag } from '../tag';\nimport { PagingConfig } from './gb-paging';\n\nexport interface Pages extends FluxTag<PagingConfig> { }\n\nexport class Pages {\n\n  init() {\n    this._scopeTo('gb-paging');\n    this._config = this._scope._config;\n  }\n\n  jumpTo({ target }: any) {\n    this._scope.pager.switchPage(Number(target.text));\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/paging/gb-pages.ts\n **/","import './gb-terminal-pager.tag.html';\nimport './gb-pager.tag.html';\nimport './gb-pages.tag.html';\nimport { Paging } from './gb-paging';\nriot.tag2('gb-paging', '<yield> <gb-terminal-pager> <gb-pager> <gb-pages></gb-pages> </gb-pager> </gb-terminal-pager> </yield>', '', '', function(opts) {\n    this._mixin(Paging);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/paging/gb-paging.tag.html\n **/","import '../icon/gb-icon.tag.html';\nimport { TerminalPager } from './gb-terminal-pager';\nriot.tag2('gb-terminal-pager', '<div class=\"gb-terminal-pager {_style}\"> <a class=\"gb-terminal__link first {disabled: _scope.backDisabled}\" if=\"{_scope._config.terminals}\" onclick=\"{_scope.pager.first}\"> <gb-icon if=\"{_config.icons}\" value=\"{_config.first_icon}\"></gb-icon> <span if=\"{_config.labels}\">{_config.numeric ? 1 : _config.first_label}</span> </a> <yield></yield> <a class=\"gb-terminal__link last {disabled: _scope.forwardDisabled}\" if=\"{_config.terminals}\" onclick=\"{_scope.pager.last}\"> <span if=\"{_config.labels}\">{_config.numeric ? _scope.lastPage : _config.last_label}</span> <gb-icon if=\"{_config.icons}\" value=\"{_config.last_icon}\"></gb-icon> </a> </div>', 'gb-terminal-pager .gb-stylish a,[riot-tag=\"gb-terminal-pager\"] .gb-stylish a,[data-is=\"gb-terminal-pager\"] .gb-stylish a{ cursor: pointer; } gb-terminal-pager .gb-stylish.gb-terminal-pager,[riot-tag=\"gb-terminal-pager\"] .gb-stylish.gb-terminal-pager,[data-is=\"gb-terminal-pager\"] .gb-stylish.gb-terminal-pager{ display: flex; width: 100%; } gb-terminal-pager .gb-stylish .gb-terminal__link,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link{ display: flex; text-decoration: none; color: #888; padding: 5px 14px; } gb-terminal-pager .gb-stylish .gb-terminal__link:hover,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link:hover,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link:hover{ color: black; } gb-terminal-pager .gb-stylish .gb-terminal__link.disabled,[riot-tag=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link.disabled,[data-is=\"gb-terminal-pager\"] .gb-stylish .gb-terminal__link.disabled{ color: #ddd; cursor: not-allowed; } gb-terminal-pager .gb-stylish gb-pager,[riot-tag=\"gb-terminal-pager\"] .gb-stylish gb-pager,[data-is=\"gb-terminal-pager\"] .gb-stylish gb-pager{ flex: 1; } gb-terminal-pager .gb-stylish gb-icon img,[riot-tag=\"gb-terminal-pager\"] .gb-stylish gb-icon img,[data-is=\"gb-terminal-pager\"] .gb-stylish gb-icon img{ width: 20px; }', '', function(opts) {\n    this._mixin(TerminalPager);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/paging/gb-terminal-pager.tag.html\n **/","import { FluxTag } from '../tag';\nimport { PagingConfig } from './gb-paging';\n\nexport interface TerminalPager extends FluxTag<PagingConfig> { }\n\nexport class TerminalPager {\n\n  init() {\n    this._scopeTo('gb-paging');\n    this._config = this._scope._config;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/paging/gb-terminal-pager.ts\n **/","import { FluxTag } from '../tag';\nimport { Events, Pager } from 'groupby-api';\n\nexport interface PagingConfig {\n  limit?: number;\n  pages?: boolean;\n  numeric?: boolean;\n  terminals?: boolean;\n  labels?: boolean;\n  icons?: boolean;\n\n  prev_label?: string;\n  next_label?: string;\n  first_label?: string;\n  last_label?: string;\n\n  prev_icon?: string;\n  next_icon?: string;\n  first_icon?: string;\n  last_icon?: string;\n}\n\nexport const DEFAULT_CONFIG: PagingConfig = {\n  limit: 5,\n  pages: false,\n  numeric: false,\n  terminals: true,\n  labels: true,\n  icons: true,\n\n  first_label: 'First',\n  prev_label: 'Prev',\n  next_label: 'Next',\n  last_label: 'Last',\n\n  first_icon: require('./double-arrow-left.png'),\n  prev_icon: require('./arrow-left.png'),\n  next_icon: require('./arrow-right.png'),\n  last_icon: require('./double-arrow-right.png')\n};\n\nexport interface FluxPager {\n  first: () => void;\n  prev: () => void;\n  next: () => void;\n  last: () => void;\n  switchPage: (page: number) => void;\n}\n\nexport interface Paging extends FluxTag<PagingConfig> { }\n\nexport class Paging {\n\n  forwardDisabled: boolean;\n  backDisabled: boolean;\n  lowOverflow: boolean;\n  highOverflow: boolean;\n  currentPage: number;\n  lastPage: number;\n  pageNumbers: number[];\n  pager: FluxPager;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    // default initial state\n    this.backDisabled = true;\n    this.currentPage = 1;\n\n    this.pager = this.wrapPager(this.flux.page);\n\n    this.flux.on(Events.PAGE_CHANGED, this.updateCurrentPage);\n    this.flux.on(Events.RESULTS, this.pageInfo);\n  }\n\n  pageInfo() {\n    const pageNumbers = this.flux.page.pageNumbers(this._config.limit);\n    const lastPage = this.flux.page.finalPage;\n    const currentPage = this.flux.page.currentPage;\n    this.updatePageInfo(pageNumbers, currentPage, lastPage);\n  }\n\n  updatePageInfo(pageNumbers: number[], currentPage: number, lastPage: number) {\n    this.update({\n      pageNumbers,\n      currentPage,\n      lastPage,\n      lowOverflow: pageNumbers[0] !== 1,\n      highOverflow: pageNumbers[pageNumbers.length - 1] !== lastPage,\n      backDisabled: currentPage === 1,\n      forwardDisabled: currentPage === lastPage\n    });\n  }\n\n  updateCurrentPage({ pageNumber }: { pageNumber: number }) {\n    this.update({ currentPage: pageNumber });\n  }\n\n  wrapPager(pager: Pager): any {\n    return {\n      first: () => !this.backDisabled && pager.reset().then(this.emitEvent),\n      prev: () => !this.backDisabled && pager.prev().then(this.emitEvent),\n      next: () => !this.forwardDisabled && pager.next().then(this.emitEvent),\n      last: () => !this.forwardDisabled && pager.last().then(this.emitEvent),\n      switchPage: (page) => pager.switchPage(page).then(this.emitEvent)\n    };\n  }\n\n  emitEvent() {\n    this.services.tracker.search();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/paging/gb-paging.ts\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABYmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9InIiPz60J7anAAABhWlDQ1BzUkdCIElFQzYxOTY2LTIuMQAAKJF1kbtLA0EQhz8TxeADCwNaWKQQBYmiUYJ2miA+CEGigq8mOfMQcslxd0HE0sI2hYUPbBSxsdZO/AcEQVArEWzFQsFG5JxNhIiYWXb329/OzO7Ogmshq+lWbT/oOduMTYR8C4tLvvonPLThpRt/XLOMsZmZCFXt444aNd/2qlzV/f61xtWkpUGNR3hUM0xbeFI4um4bineFvVomvip8Juw35YLCD0pPlPlFcbrELpXTa87FwsJeYV/6Fyd+sZYxdeEh4U49W9B+7qNe0pTMzc8qXXoHFjEmCOFjinHCBBlgRMYgvQTokxVV4gOl+Ch5idVkNNjAZI00GWz8ohYke1LmlOhJaVnxEFN/8Le2VmowUD6haRrqnh3nvQfqD+Br23E+jxzn6xjcUpernUp8fgeGX0UvVrTOQ2jZgvPLipY4gYsitD8acTNektzSXakUvJ1C8yK03kDDcrluP/sc38PcJkSuYW8fusS/ZeUbWh5nYM1tRxkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAGBSURBVHic7d0xblNhEIXRS3qyoCT0QLJhVpDNpDMFVFBZspBj8vxmnm3NOdJrR5a+6/pPAAAAAAAAAAAAAAAAAAAAAK7TfZIfSR5v5C6F7pO8JvmTZJe6WF13KXQYaf/tkjxd6V0KHYtUEavrLoVORdp/P7M8VtddCn0k0mGsLxe+S6ElkZbE6rpLoXMi7b+3JJ83vkuhNZF+Jfm68V0KiT+Y+IOJP9iaSL/TE//UXQqtjfRt47sUEn8w8QcTfzDxBxN/MPEHWxvp+8Z3KST+YOIPJv5g4g8m/mBrIz1vfJdC4g8m/mDiDyb+YOJfgbtL/4AVPt3YXY5Y+2992fguDYwAI8AIiBEQIyBGQIyAGAExAmIExAiIERAjIEZAjIAYATECYgTECIgRECMgRkA8GEHOi7VL8nChuzRYEmtJpK67NPhIrHMidd2lwf8eeDw3UtddGrz3xOvaSF13afDvI89Vkbru0mD/zHt1pK67AAAAAAAAAAAAAAAAAAAAwGB/AYR4hXFo7p5xAAAAAElFTkSuQmCC\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/tags/paging/double-arrow-left.png\n ** module id = 81\n ** module chunks = 0\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAACrklEQVR4Ae3dvXLTQBQF4IQeHihAD0leOE+Ql0kHBVSwKjzjIj9er65GZ/V5RpXlq7vfOeOk882NFwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEBgLoEv7ThP7fo617Gc5hKBJfzndv1r1692KUFDOMrrPPylAKcSfDsKwJHP+Vr4SnCQRrwX/qkEv5uFb4IJC3FJ+Ocl+D6hwWGP1BO+EkxWk2vCP5XgpVl8nszjUMcZCf9Pk/pxKK3JDiv8yQLtOY7we7Qmu1f4kwXac5yR8P+2B/mb36O9s3tHw/+5s/NYp0NA+B1Ys90q/NkS7TiP8DuwZrtV+LMl2nEe4XdgzXar8GdLtOM8o+HfdzzLrTsTEP7OAtlyHeFvqb2zZwl/Z4FsuY7wt9Te2bOEv7NAtlxnNPyHLZf1rHUFhL+uZ9Q04UfFte6ywl/XM2qa8KPiWndZ4a/o+WnFWSmjblMWtefbAqPfAo9vj/ZOioASpCRVuKcSFOKmjFaClKQK91SCQtyU0UqQklThnkpQiJsyWglSkircUwkKcVNGK0FKUoV7KkEhbspoJUhJqnBPJSjETRmtBClJFe6pBIW4KaOVICWpwj2VoBA3ZbQSpCRVuKcSFOKmjFaClKQK91SCQtyU0UqQklThnkpQiJsyeqQEfjAiJeUP9rymBMtvCd59MNfbQQI9JRB+ULA9q15SAuH3iAbe+14JhB8Y6DUrv1YC4V8jGfyZ8xIIPzjIkdWXEiw/H++//RFFnyVAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgS6BP4DIgpCusyEaeEAAAAASUVORK5CYII=\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/tags/paging/arrow-left.png\n ** module id = 82\n ** module chunks = 0\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAACtklEQVR4Ae3dQW7UQBAF0Ch7OFCAPQQunBNwGXawgBUpLywhFEFc3Ym7ym8kK5uU3f3+z8QjZTI3Nx4ECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAgdcTuItLPcTx9vUu6UqrCGzhf4/jdxxf41CCQLjK48/wtwIowVWSj30+Fb4SXKQA/wpfCZqX4DnhK0HTEhwJXwmaleBN7OdbHHuwR756ddCkDF9iH7+UoEmayW0oQRKu05gSdEozuRclSMJ1GlOCTmkm96IESbhOY0rQKc3kXpQgCddpTAk6pZncixIk4TqNKUGnNJN7UYIkXKcxJeiUZnIvSpCE6zSmBJ3STO5FCZJwncaUoFOayb0oQRKu05gSdEozuRclSMJ1GlOCTmkm96IESbhOY0rQKc3kXi5XgtskVNex7Y0mHhcV+Bz79oYT4R9+25m3nBUvjZ/84gGOLF/4I3rFZ4VfPMCR5d/HsBu+EcHCs8IvHN7o0oU/Klh4XviFwxtduvBHBQvPC79weKNL/xQncLc/qlh0XvhFg5uxbOHPUCx6DuEXDW7GsoU/Q7HoOYRfNLgZyxb+DMWi5/gY6/ZSr2h4o8vewv8Zx5F/Gr1/r7/kGdU/eV74Jwdw5uWFf6b+ydcW/skBnHl5Hxhxpv4i1/4Q6/gRx34z95yvbvgWCW/WMo6UQPiz1Bc7z/tYz/+eCYS/WGizl7OVYP/I2L9/FQh/tvai53uqBMJfNKyXWta7OPH+TCD8l1Je/LxbCR7i8MnhiwdleQQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgMAxgUc/cUO5Y0FtKQAAAABJRU5ErkJggg==\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/tags/paging/arrow-right.png\n ** module id = 83\n ** module chunks = 0\n **/","module.exports = \"data:image/png;base64,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\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/tags/paging/double-arrow-right.png\n ** module id = 84\n ** module chunks = 0\n **/","import './gb-search-box.tag.html';\nimport '../submit/gb-submit.tag.html';\nimport '../reset/gb-reset.tag.html';\nimport '../sayt/gb-sayt.tag.html';\nimport { Query } from './gb-query';\nriot.tag2('gb-query', '<yield> <div class=\"gb-query {_style}\"> <gb-search-box></gb-search-box> <gb-submit></gb-submit> <gb-reset></gb-reset> <gb-sayt if=\"{_config.sayt}\"></gb-sayt> </div> </yield>', 'gb-query .gb-stylish.gb-query,[riot-tag=\"gb-query\"] .gb-stylish.gb-query,[data-is=\"gb-query\"] .gb-stylish.gb-query{ position: relative; display: flex; align-items: baseline; } gb-query .gb-stylish.gb-query gb-sayt,[riot-tag=\"gb-query\"] .gb-stylish.gb-query gb-sayt,[data-is=\"gb-query\"] .gb-stylish.gb-query gb-sayt{ top: 31px; left: 0; z-index: 10; position: absolute; min-width: 175px; background-color: #fff; box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); }', '', function(opts) {\n    this._mixin(Query);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/query/gb-query.tag.html\n **/","riot.tag2('gb-search-box', '<input name=\"searchBox\" class=\"{_style}\" type=\"text\" placeholder=\"Search...\" autofocus>', 'gb-search-box input.gb-stylish,[riot-tag=\"gb-search-box\"] input.gb-stylish,[data-is=\"gb-search-box\"] input.gb-stylish{ padding: 6px 12px; font-size: 14px; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/query/gb-search-box.tag.html\n **/","import { Submit } from './gb-submit';\nriot.tag2('gb-submit', '<yield> <a class=\"gb-submit {_style}\">&#128269;</a> </yield>', 'gb-submit .gb-stylish.gb-submit,[riot-tag=\"gb-submit\"] .gb-stylish.gb-submit,[data-is=\"gb-submit\"] .gb-stylish.gb-submit{ padding: 4px; } gb-submit .gb-stylish.gb-submit:hover,[riot-tag=\"gb-submit\"] .gb-stylish.gb-submit:hover,[data-is=\"gb-submit\"] .gb-stylish.gb-submit:hover{ cursor: pointer; }', '', function(opts) {\n    this._mixin(Submit);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/submit/gb-submit.tag.html\n **/","import { findSearchBox } from '../../utils/common';\nimport { FluxTag } from '../tag';\nimport * as riot from 'riot';\n\nexport interface SubmitConfig {\n  label?: string;\n  staticSearch?: boolean;\n}\n\nexport const DEFAULT_CONFIG: SubmitConfig = {\n  label: 'Search',\n  staticSearch: false\n};\n\nexport interface Submit extends FluxTag<SubmitConfig> {\n  root: riot.TagElement & { value: any };\n}\n\nexport class Submit {\n\n  searchBox: HTMLInputElement;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    if (this.root.tagName === 'INPUT') {\n      this.root.value = this._config.label;\n    }\n\n    this.on('mount', this.setSearchBox);\n    this.root.addEventListener('click', this.submitQuery);\n  }\n\n  setSearchBox() {\n    this.searchBox = findSearchBox();\n  }\n\n  submitQuery() {\n    const inputValue = this.searchBox.value;\n\n    if (this._config.staticSearch && this.services.url.isActive()) {\n      this.services.url.update(this.flux.query.withQuery(inputValue)\n        .withConfiguration(<any>{ refinements: [] }));\n    } else {\n      this.flux.reset(inputValue)\n        .then(() => this.services.tracker.search());\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/submit/gb-submit.ts\n **/","import { Reset } from './gb-reset';\nriot.tag2('gb-reset', '<yield> <a class=\"gb-reset {_style}\">&times;</a> </yield>', 'gb-reset .gb-stylish.gb-reset,[riot-tag=\"gb-reset\"] .gb-stylish.gb-reset,[data-is=\"gb-reset\"] .gb-stylish.gb-reset{ color: #888; padding: 4px; } gb-reset .gb-stylish.gb-reset:hover,[riot-tag=\"gb-reset\"] .gb-stylish.gb-reset:hover,[data-is=\"gb-reset\"] .gb-stylish.gb-reset:hover{ color: black; cursor: pointer; }', '', function(opts) {\n    this._mixin(Reset);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/reset/gb-reset.tag.html\n **/","import { findSearchBox } from '../../utils/common';\nimport { FluxTag } from '../tag';\n\nexport interface Reset extends FluxTag<any> { }\n\nexport class Reset {\n\n  searchBox: HTMLInputElement;\n\n  init() {\n    this.on('mount', this.setSearchBox);\n    this.root.addEventListener('click', this.clearQuery);\n  }\n\n  setSearchBox() {\n    this.searchBox = findSearchBox();\n  }\n\n  clearQuery() {\n    this.flux.reset(this.searchBox.value = '')\n      .then(() => this.services.tracker.search());\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/reset/gb-reset.ts\n **/","import './gb-sayt-autocomplete.tag.html';\nimport './gb-sayt-products.tag.html';\nimport { Sayt } from './gb-sayt';\nimport { SaytTag } from '../tag';\nriot.tag2('gb-sayt', '<yield> <div class=\"{_style}\" if=\"{(queries && queries.length) || (navigations && navigations.length)}\"> <gb-sayt-autocomplete></gb-sayt-autocomplete> <gb-sayt-products if=\"{showProducts}\"></gb-sayt-products> </div> </yield>', 'gb-sayt div.gb-stylish,[riot-tag=\"gb-sayt\"] div.gb-stylish,[data-is=\"gb-sayt\"] div.gb-stylish{ display: flex; } gb-sayt .gb-stylish ul,[riot-tag=\"gb-sayt\"] .gb-stylish ul,[data-is=\"gb-sayt\"] .gb-stylish ul{ list-style: none; margin: 0; padding: 0; } gb-sayt .gb-stylish gb-sayt-link:hover,[riot-tag=\"gb-sayt\"] .gb-stylish gb-sayt-link:hover,[data-is=\"gb-sayt\"] .gb-stylish gb-sayt-link:hover,gb-sayt .gb-stylish gb-sayt-link.active,[riot-tag=\"gb-sayt\"] .gb-stylish gb-sayt-link.active,[data-is=\"gb-sayt\"] .gb-stylish gb-sayt-link.active{ background-color: #f1f1f1; display: block; } gb-sayt .gb-stylish gb-list li,[riot-tag=\"gb-sayt\"] .gb-stylish gb-list li,[data-is=\"gb-sayt\"] .gb-stylish gb-list li{ margin: 0px; }', '', function(opts) {\n    this._mixin(SaytTag, Sayt);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt.tag.html\n **/","import './gb-sayt-categories.tag.html';\nimport './gb-sayt-search-terms.tag.html';\nimport './gb-sayt-refinements.tag.html';\nimport './gb-sayt-divider.tag.html';\nriot.tag2('gb-sayt-autocomplete', '<yield> <gb-sayt-categories></gb-sayt-categories> <gb-sayt-divider></gb-sayt-divider> <gb-sayt-search-terms></gb-sayt-search-terms> <gb-sayt-divider></gb-sayt-divider> <gb-sayt-refinements each=\"{navigations}\"></gb-sayt-refinements> </yield>', '.gb-stylish gb-sayt-autocomplete,.gb-stylish [riot-tag=\"gb-sayt-autocomplete\"],.gb-stylish [data-is=\"gb-sayt-autocomplete\"]{ min-width: 210px; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-autocomplete.tag.html\n **/","import '../list/gb-list.tag.html';\nimport './gb-sayt-link.tag.html';\nimport '../raw/gb-raw.tag.html';\nriot.tag2('gb-sayt-categories', '<gb-list items=\"{categoryResults}\"> <gb-sayt-link send=\"{_scope.searchCategory}\" data-value=\"{item.value}\" data-refinement=\"{item.category}\" data-field=\"{_scope.categoryField}\" data-norefine=\"{item.noRefine}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item.value, \\'<b>$&</b>\\')}\"></gb-raw> in <span class=\"gb-category-query\">{item.category}</span> </yield> </gb-sayt-link> </gb-list>', '.gb-stylish gb-sayt-categories .gb-category-query,.gb-stylish [riot-tag=\"gb-sayt-categories\"] .gb-category-query,.gb-stylish [data-is=\"gb-sayt-categories\"] .gb-category-query{ font-weight: bold; color: darkorange; }', '', function(opts) {\n\n    this._scopeTo('gb-sayt');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-categories.tag.html\n **/","riot.tag2('gb-sayt-link', '<a onclick=\"{opts.send}\"> <yield></yield> </a>', '.gb-stylish gb-sayt-link a,.gb-stylish [riot-tag=\"gb-sayt-link\"] a,.gb-stylish [data-is=\"gb-sayt-link\"] a{ padding: 5px 15px; text-decoration: none; display: block; }', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-link.tag.html\n **/","import { Raw } from './gb-raw';\nriot.tag2('gb-raw', '<span></span>', '', '', function(opts) {\n    this._mixin(Raw);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/raw/gb-raw.tag.html\n **/","import { FluxTag } from '../tag';\n\nexport interface RawConfig {\n  content: string;\n}\n\nexport interface Raw extends FluxTag<RawConfig> { }\n\nexport class Raw {\n\n  init() {\n    this.configure();\n\n    this.on('update', this.updateContent);\n    this.on('mount', this.updateContent);\n  }\n\n  updateContent() {\n    this.root.innerHTML = this._config.content;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/raw/gb-raw.ts\n **/","import '../list/gb-list.tag.html';\nimport './gb-sayt-link.tag.html';\nimport '../raw/gb-raw.tag.html';\nriot.tag2('gb-sayt-search-terms', '<gb-list items=\"{_scope.queries}\"> <gb-sayt-link send=\"{_scope.search}\" data-value=\"{item.value}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item.value, \\'<b>$&</b>\\')}\"></gb-raw> </yield> </gb-sayt-link> </gb-list>', '', '', function(opts) {\n\n    this._scopeTo('gb-sayt');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-search-terms.tag.html\n **/","import '../list/gb-list.tag.html';\nimport './gb-sayt-link.tag.html';\nimport '../raw/gb-raw.tag.html';\nriot.tag2('gb-sayt-refinements', '<h4>{displayName}</h4> <gb-list items=\"{values}\"> <gb-sayt-link send=\"{_scope.searchRefinement}\" data-value=\"{displayName}: {item}\" data-refinement=\"{item}\" data-field=\"{name}\"> <yield> <gb-raw content=\"{_scope.highlightCurrentQuery(item, \\'<b>$&</b>\\')}\"></gb-raw> </yield> </gb-sayt-link> </gb-list>', '.gb-stylish gb-sayt-refinements h4,.gb-stylish [riot-tag=\"gb-sayt-refinements\"] h4,.gb-stylish [data-is=\"gb-sayt-refinements\"] h4{ margin: 4px; }', '', function(opts) {\n\n    this._scopeTo('gb-sayt');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-refinements.tag.html\n **/","riot.tag2('gb-sayt-divider', '<div if=\"{isVisible()}\"></div>', '.gb-stylish gb-sayt-divider div,.gb-stylish [riot-tag=\"gb-sayt-divider\"] div,.gb-stylish [data-is=\"gb-sayt-divider\"] div{ display: block; margin: 3px 10%; border-top: 1px solid #777; }', '', function(opts) {\n    this.isVisible = () => this.root.nextElementSibling &&\n      this.root.nextElementSibling.querySelector('li') &&\n      this.root.previousElementSibling &&\n      this.root.previousElementSibling.querySelector('li');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-divider.tag.html\n **/","import '../product/gb-product.tag.html';\nimport '../product/gb-product-image.tag.html';\nriot.tag2('gb-sayt-products', '<ul class=\"{_style}\"> <li class=\"gb-sayt-product\" each=\"{products}\"> <yield> <gb-product all_meta=\"{allMeta}\"> <gb-product-image thumbnail></gb-product-image> </gb-product> </yield> </li> </ul>', '.gb-stylish gb-sayt-products,.gb-stylish [riot-tag=\"gb-sayt-products\"],.gb-stylish [data-is=\"gb-sayt-products\"]{ min-width: 300px; } gb-sayt-products ul.gb-stylish,[riot-tag=\"gb-sayt-products\"] ul.gb-stylish,[data-is=\"gb-sayt-products\"] ul.gb-stylish{ display: flex; flex-wrap: wrap; align-items: center; width: calc(86px * 4); align-content: flex-start; } gb-sayt-products .gb-stylish gb-product-image img,[riot-tag=\"gb-sayt-products\"] .gb-stylish gb-product-image img,[data-is=\"gb-sayt-products\"] .gb-stylish gb-product-image img{ vertical-align: bottom; margin: 3px; } gb-sayt-products .gb-stylish gb-product-image img:hover,[riot-tag=\"gb-sayt-products\"] .gb-stylish gb-product-image img:hover,[data-is=\"gb-sayt-products\"] .gb-stylish gb-product-image img:hover{ box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); }', '', function(opts) {\n    this._scopeTo('gb-sayt')\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sayt/gb-sayt-products.tag.html\n **/","import './gb-product-image.tag.html';\nimport './gb-product-info.tag.html';\nimport './gb-variant-switcher.tag.html';\nimport { Product } from './gb-product';\nriot.tag2('gb-product', '<yield> <gb-product-image></gb-product-image> <gb-product-info></gb-product-info> <gb-variant-switcher></gb-variant-switcher> </yield>', '', '', function(opts) {\n    this._mixin(Product);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/product/gb-product.tag.html\n **/","riot.tag2('gb-product-image', '<a class=\"gb-product-image {_style}\" href=\"{_scope.link()}\"> <img class=\"{thumbnail: opts.thumbnail !== undefined}\" riot-src=\"{imageLink()}\" alt=\"\"> </a>', 'gb-product-image .gb-product-image.gb-stylish img,[riot-tag=\"gb-product-image\"] .gb-product-image.gb-stylish img,[data-is=\"gb-product-image\"] .gb-product-image.gb-stylish img{ width: 380px; } gb-product-image .gb-product-image.gb-stylish img.thumbnail,[riot-tag=\"gb-product-image\"] .gb-product-image.gb-stylish img.thumbnail,[data-is=\"gb-product-image\"] .gb-product-image.gb-stylish img.thumbnail{ width: 80px; }', '', function(opts) {\n    this._scopeTo('gb-product');\n    const _scope = this._scope;\n    this.imageLink = () => _scope.image(_scope.productMeta().image);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/product/gb-product-image.tag.html\n **/","riot.tag2('gb-product-info', '<a href=\"{_scope.link()}\"> <p class=\"gb-product__title\">{_scope.productMeta().title}</p> <p class=\"gb-product__price\">{_scope.productMeta().price}</p> </a>', '', '', function(opts) {\n    this._scopeTo('gb-product');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/product/gb-product-info.tag.html\n **/","riot.tag2('gb-variant-switcher', '<a if=\"{_scope.variants.length > 1}\" each=\"{variant, i in _scope.variants}\" class=\"gb-product__variant-link\" onclick=\"{_scope.switchVariant}\" data-index=\"{i}\"> {i} </a>', '', '', function(opts) {\n    this._scopeTo('gb-product');\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/product/gb-variant-switcher.tag.html\n **/","import { ProductMeta, ProductTransformer } from '../../utils/product-transformer';\nimport { FluxTag } from '../tag';\nimport * as clone from 'clone';\nimport oget = require('oget');\n\nexport interface Product extends FluxTag<any> { }\n\nexport class Product {\n\n  variantIndex: number;\n  variants: any[];\n  detailsUrl: string;\n  allMeta: any;\n  struct: any;\n  productMeta: ProductMeta;\n  transformer: ProductTransformer;\n\n  init() {\n    this.variantIndex = 0;\n    this.detailsUrl = oget(this.services, 'url.urlConfig.detailsUrl', 'details.html');\n    this.struct = this._scope.struct || this.config.structure || {};\n    this.transformer = new ProductTransformer(this.struct);\n\n    this.transformRecord(this.opts.all_meta);\n  }\n\n  transformRecord(allMeta: any) {\n    const productMeta = this.transformer.transform(clone(allMeta, false));\n    this.update({\n      productMeta: () => productMeta(this.variantIndex),\n      variants: productMeta.variants || [],\n      allMeta: productMeta.transformedMeta\n    });\n  }\n\n  link() {\n    return this.productMeta().url || `${this.detailsUrl}?id=${this.productMeta().id}`;\n  }\n\n  image(imageObj: string | string[]) {\n    return Array.isArray(imageObj) ? imageObj[0] : imageObj;\n  }\n\n  switchVariant(event: MouseEvent) {\n    const variantIndex = (<HTMLElement>event.target).dataset['index'];\n    this.update({ variantIndex });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/product/gb-product.ts\n **/","import { debounce } from '../../utils/common';\nimport { ProductStructure } from '../../utils/product-transformer';\nimport { Query } from '../query/gb-query';\nimport { SaytTag } from '../tag';\nimport { Autocomplete, AUTOCOMPLETE_HIDE_EVENT } from './autocomplete';\nimport { Events, Navigation, Record, SelectedValueRefinement } from 'groupby-api';\nimport escapeStringRegexp = require('escape-string-regexp');\n\nexport interface SaytConfig {\n  structure?: ProductStructure;\n  categoryField?: string;\n  allCategoriesLabel?: string;\n  collection?: string;\n  area?: string;\n  language?: string;\n  products?: number;\n  queries?: number;\n  minimumCharacters?: number;\n  delay?: number;\n  autoSearch?: boolean;\n  staticSearch?: boolean;\n  https?: boolean;\n  highlight?: boolean;\n  navigationNames?: { [name: string]: string };\n  allowedNavigations?: string[];\n}\n\nexport const DEFAULT_CONFIG: SaytConfig = {\n  allCategoriesLabel: 'All Departments',\n  products: 4,\n  queries: 5,\n  minimumCharacters: 1,\n  delay: 100,\n  autoSearch: true,\n  staticSearch: false,\n  highlight: true,\n  https: false,\n  navigationNames: {},\n  allowedNavigations: []\n};\nexport const MIN_DELAY = 100;\n\nexport interface Sayt extends SaytTag<SaytConfig> { }\n\nexport class Sayt {\n\n  products: Record[];\n  navigations: Navigation[];\n  struct: any;\n  autocomplete: Autocomplete;\n  autocompleteList: HTMLUListElement;\n  originalQuery: string;\n  showProducts: boolean;\n  matchesInput: boolean;\n  queries: any[];\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.struct = Object.assign({}, this.config.structure, this._config.structure);\n    this.showProducts = this._config.products > 0;\n\n    this.sayt.configure(this.generateSaytConfig());\n\n    this.on('mount', this.initializeAutocomplete);\n    this.flux.on(AUTOCOMPLETE_HIDE_EVENT, this.reset);\n  }\n\n  initializeAutocomplete() {\n    this.autocomplete = new Autocomplete(this);\n  }\n\n  generateSaytConfig() {\n    return {\n      subdomain: this.config.customerId,\n      collection: this._config.collection || this.config.collection,\n      autocomplete: {\n        numSearchTerms: this._config.queries,\n        language: this._config.language\n      },\n      productSearch: {\n        area: this._config.area || this.config.area,\n        numProducts: this._config.products,\n        language: this._config.language\n      },\n      https: this._config.https\n    };\n  }\n\n  reset() {\n    this.autocomplete.reset();\n    this.update({ queries: null, navigations: null, products: null });\n  }\n\n  fetchSuggestions(originalQuery: string) {\n    this.sayt.autocomplete(originalQuery)\n      .then(({ result }) => ({ result, originalQuery }))\n      .then(this.handleSuggestions)\n      .catch((err) => console.error(err));\n  }\n\n  handleSuggestions({ result, originalQuery }: { result: any, originalQuery: string }) {\n    this.update({ originalQuery });\n    this.processResults(result);\n    if (this.queries && this.showProducts) {\n      const query = this.matchesInput ? originalQuery : this.queries[0].value;\n      this.searchProducts(query);\n    }\n  }\n\n  searchProducts(query: string = '', refinements?: string) {\n    if (this.showProducts) {\n      this.sayt.productSearch(query, { refinements })\n        .then((res) => this.update({ products: res.result.products }));\n    }\n  }\n\n  rewriteQuery(query: string) {\n    this.flux.emit(Events.REWRITE_QUERY, query);\n  }\n\n  notifier(query: string, refinement?: string, field?: string) {\n    const isRefinement = refinement && refinement !== this._config.allCategoriesLabel;\n    const refinementString = `~${field || this._config.categoryField}=${refinement}`;\n    if (this._config.autoSearch) this.searchProducts(field ? '' : query, isRefinement ? refinementString : undefined);\n    this.rewriteQuery(query);\n  }\n\n  processResults(result: any) {\n    let categoryResults = [];\n\n    this.matchesInput = result.searchTerms\n      && result.searchTerms[0].value.toLowerCase() === this.originalQuery.toLowerCase();\n\n    if (this.matchesInput) {\n      const [categoryQuery] = result.searchTerms.splice(0, 1);\n      categoryResults = this.extractCategoryResults(categoryQuery);\n    }\n\n    const navigations = result.navigations ? result.navigations\n      .map((nav) => Object.assign(nav, { displayName: this._config.navigationNames[nav.name] || nav.name }))\n      .filter(({name}) => this._config.allowedNavigations.includes(name)) : [];\n    this.update({\n      results: result,\n      navigations,\n      queries: result.searchTerms,\n      categoryResults\n    });\n  }\n\n  extractCategoryResults({ additionalInfo, value }: any) {\n    let categoryResults = [];\n    const categoryField = this._config.categoryField;\n    if (additionalInfo && categoryField && categoryField in additionalInfo) {\n      categoryResults = additionalInfo[categoryField]\n        .map((category) => ({ category, value }))\n        .slice(0, 3);\n      categoryResults.unshift({ category: this._config.allCategoriesLabel, value, noRefine: true });\n    }\n    return categoryResults;\n  }\n\n  searchRefinement(event: Event) {\n    this.flux.resetRecall();\n    this.refine(<HTMLElement>event.target, '');\n  }\n\n  searchCategory(event: Event) {\n    this.flux.resetRecall();\n    this.refine(<HTMLElement>event.target, this.originalQuery);\n  }\n\n  highlightCurrentQuery(value: string, regexReplacement: string) {\n    return this._config.highlight\n      ? value.replace(new RegExp(escapeStringRegexp(this.originalQuery), 'i'), regexReplacement)\n      : value;\n  }\n\n  enhanceCategoryQuery(query: any) {\n    return `<b>${query.value}</b> in <span class=\"gb-category-query\">${query.category}</span>`;\n  }\n\n  refine(node: HTMLElement, queryString: string) {\n    while (node.tagName !== 'GB-SAYT-LINK') node = node.parentElement;\n\n    const doRefinement = !node.dataset['norefine'];\n    const refinement: SelectedValueRefinement = {\n      navigationName: node.dataset['field'] || this._config.categoryField,\n      value: node.dataset['refinement'],\n      type: 'Value'\n    };\n\n    if (this._config.staticSearch && this.services.url.isActive()) {\n      this.services.url.update(this.flux.query.withQuery(queryString)\n        .withConfiguration(<any>{ refinements: doRefinement ? [refinement] : [] }));\n    } else if (doRefinement) {\n      this.flux.rewrite(queryString, { skipSearch: true });\n      this.flux.refine(refinement)\n        .then(() => this.services.tracker.sayt());\n    } else {\n      this.flux.reset(queryString)\n        .then(() => this.services.tracker.sayt());\n    }\n  }\n\n  search(event: Event) {\n    let node = <HTMLElement>event.target;\n    while (node.tagName !== 'GB-SAYT-LINK') node = node.parentElement;\n\n    const query = node.dataset['value'];\n\n    if (this._config.staticSearch && this.services.url.isActive()) {\n      this.services.url.update(this.flux.query.withQuery(query)\n        .withConfiguration(<any>{ refinements: [] }));\n    } else {\n      this.rewriteQuery(query);\n      this.flux.reset(query)\n        .then(() => this.services.tracker.sayt());\n    }\n  }\n\n  listenForInput(tag: Query) {\n    const input = <HTMLInputElement>tag.searchBox;\n    input.autocomplete = 'off';\n    const debouncedSearch = debounce(this.debouncedSearch(input), Math.max(this._config.delay, MIN_DELAY));\n    input.addEventListener('input', debouncedSearch);\n    document.addEventListener('click', this.reset);\n  }\n\n  debouncedSearch(input: HTMLInputElement) {\n    return () => {\n      if (input.value.length >= this._config.minimumCharacters) {\n        this.fetchSuggestions(input.value);\n      } else {\n        this.reset();\n      }\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/sayt/gb-sayt.ts\n **/","import { findSearchBox } from '../../utils/common';\nimport { Sayt } from './gb-sayt';\n\nconst KEY_UP = 38;\nconst KEY_DOWN = 40;\nconst KEY_ENTER = 13;\nconst KEY_ESCAPE = 27;\nconst ACTIVE = 'active';\n\nexport const AUTOCOMPLETE_HIDE_EVENT = 'autocomplete:hide';\n\nexport class Autocomplete {\n\n  selected: HTMLElement;\n  searchInput: HTMLInputElement;\n  preautocompleteValue: string;\n\n  constructor(public tag: Sayt) {\n    this.selected = this.searchInput = findSearchBox();\n  }\n\n  indexOfSelected() {\n    return this.links().indexOf(this.selected);\n  }\n\n  selectLink(link: HTMLElement) {\n    if (link) this.selected = this.swapAttributes(link);\n  }\n\n  linkAbove() {\n    return <HTMLElement>this.links()[this.indexOfSelected() - 1];\n  }\n\n  linkBelow() {\n    return <HTMLElement>this.links()[this.indexOfSelected() + 1];\n  }\n\n  links() {\n    return Array.from(this.tag.root.querySelectorAll('gb-sayt-autocomplete gb-sayt-link'));\n  }\n\n  isSelectedInAutocomplete() {\n    return this.links().indexOf(this.selected) !== -1;\n  }\n\n  swapAttributes(next: HTMLElement) {\n    this.removeActiveClass();\n    next.classList.add(ACTIVE);\n    const value = next.dataset['value'];\n    const refinement = next.dataset['refinement'];\n    const field = next.dataset['field'];\n    if (value || refinement) this.tag.notifier(value, refinement, field);\n    return next;\n  }\n\n  resetSelected() {\n    this.selected = this.searchInput;\n  }\n\n  removeActiveClass() {\n    this.links().forEach((element) => element.classList.remove(ACTIVE));\n  }\n\n  reset() {\n    this.removeActiveClass();\n    this.resetSelected();\n  }\n\n  keyboardListener(event: KeyboardEvent, submitDefault: Function) {\n    switch (event.keyCode) {\n      case KEY_UP:\n        // prevent cursor from moving to front of text box\n        event.preventDefault();\n\n        if (this.isSelectedInAutocomplete()) {\n          const linkAbove = this.linkAbove();\n          if (linkAbove) {\n            this.selectLink(linkAbove);\n          } else {\n            this.searchInput.value = this.preautocompleteValue;\n            this.reset();\n          }\n        } else {\n          this.tag.flux.emit(AUTOCOMPLETE_HIDE_EVENT);\n        }\n        break;\n      case KEY_DOWN:\n        if (!this.isSelectedInAutocomplete()) {\n          this.preautocompleteValue = this.searchInput.value;\n        }\n        this.selectLink(this.linkBelow());\n        break;\n      case KEY_ENTER:\n        if (this.isSelectedInAutocomplete()) {\n          this.selected.querySelector('a').click();\n          this.reset();\n        } else {\n          submitDefault();\n        }\n        break;\n      case KEY_ESCAPE:\n        this.tag.flux.emit(AUTOCOMPLETE_HIDE_EVENT);\n        break;\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/sayt/autocomplete.ts\n **/","module.exports = require(\"escape-string-regexp\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"escape-string-regexp\"\n ** module id = 108\n ** module chunks = 0\n **/","import { findTag } from '../../utils/common';\nimport { AUTOCOMPLETE_HIDE_EVENT } from '../sayt/autocomplete';\nimport { Sayt } from '../sayt/gb-sayt';\nimport '../sayt/gb-sayt.tag.html';\nimport { FluxTag } from '../tag';\nimport { Events } from 'groupby-api';\nimport * as riot from 'riot';\n\nconst KEY_ENTER = 13;\n\nexport interface QueryConfig {\n  sayt?: boolean;\n  autoSearch?: boolean;\n  staticSearch?: boolean;\n}\n\nexport const DEFAULT_CONFIG: QueryConfig = {\n  sayt: true,\n  autoSearch: true,\n  staticSearch: false\n};\n\nexport interface Query extends FluxTag<QueryConfig> {\n  root: riot.TagElement & HTMLInputElement;\n}\n\nexport class Query {\n\n  searchBox: HTMLInputElement;\n  enterKeyHandlers: Function[];\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.enterKeyHandlers = [];\n\n    this.on('mount', this.attachListeners);\n    this.flux.on(Events.REWRITE_QUERY, this.rewriteQuery);\n  }\n\n  attachListeners() {\n    this.searchBox = this.findSearchBox();\n    this.searchBox.addEventListener('keydown', this.keydownListener);\n    if (this._config.sayt) this.tags['gb-sayt'].listenForInput(this);\n\n    if (this._config.autoSearch) {\n      this.listenForInput();\n    } else if (this._config.staticSearch) {\n      this.listenForStaticSearch();\n    } else {\n      this.listenForSubmit();\n    }\n  }\n\n  rewriteQuery(query: string) {\n    this.searchBox.value = query;\n  }\n\n  listenForInput() {\n    this.searchBox.addEventListener('input', this.resetToInputValue);\n  }\n\n  listenForSubmit() {\n    this.enterKeyHandlers.push(this.resetToInputValue);\n  }\n\n  resetToInputValue() {\n    this.flux.reset(this.inputValue())\n      .then(() => this.services.tracker.search());\n  }\n\n  listenForStaticSearch() {\n    this.enterKeyHandlers.push(this.setLocation);\n  }\n\n  keydownListener(event: KeyboardEvent) {\n    const sayt = findTag('gb-sayt');\n    if (sayt) {\n      const autocomplete = (<Sayt>sayt['_tag']).autocomplete;\n      autocomplete.keyboardListener(event, this.onSubmit);\n    } else if (event.keyCode === KEY_ENTER) {\n      this.onSubmit();\n    }\n  }\n\n  onSubmit() {\n    this.enterKeyHandlers.forEach((f) => f());\n    this.flux.emit(AUTOCOMPLETE_HIDE_EVENT);\n  }\n\n  findSearchBox() {\n    if (this.tags['gb-search-box']) {\n      return this.tags['gb-search-box'].searchBox;\n    } else {\n      return this.root.querySelector('input');\n    }\n  }\n\n  setLocation() {\n    if (this.services.url.isActive()) {\n      this.services.url.update(this.flux.query.withQuery(this.inputValue())\n        .withConfiguration(<any>{ refinements: [] }));\n    } else {\n      this.flux.reset(this.inputValue());\n    }\n  }\n\n  private inputValue() {\n    return this.searchBox.value;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/query/gb-query.ts\n **/","import { RecordCount } from './gb-record-count';\nriot.tag2('gb-record-count', '<yield> <h2>{first} - {last} of {total} Products</h2> </yield>', '', '', function(opts) {\n    this._mixin(RecordCount);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/record-count/gb-record-count.tag.html\n **/","import { FluxTag } from '../tag';\nimport { Events, PageInfo } from 'groupby-api';\n\nexport interface RecordCount extends FluxTag<any> { }\n\nexport class RecordCount {\n\n  first: number;\n  last: number;\n  total: number;\n\n  init() {\n    this.flux.on(Events.RESULTS, this.updatePageInfo);\n  }\n\n  updatePageInfo({ pageInfo, totalRecordCount }: { pageInfo: PageInfo, totalRecordCount: number }) {\n    this.update({\n      first: pageInfo.recordStart,\n      last: pageInfo.recordEnd,\n      total: totalRecordCount\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/record-count/gb-record-count.ts\n **/","import '../list/gb-list.tag.html';\nimport { RelatedQueries } from './gb-related-queries';\nriot.tag2('gb-related-queries', '<yield> <gb-list class=\"{_style}\" items=\"{relatedQueries}\" scope=\"gb-related-queries\" inline> <a onclick=\"{_scope.send}\">{item}</a> </gb-list> </yield>', '', '', function(opts) {\n    this._mixin(RelatedQueries);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/related-queries/gb-related-queries.tag.html\n **/","import { FluxTag } from '../tag';\nimport { Events, Results } from 'groupby-api';\n\nexport interface RelatedQueries extends FluxTag<any> { }\n\nexport class RelatedQueries {\n\n  relatedQueries: string[];\n\n  init() {\n    this.flux.on(Events.RESULTS, this.updatedRelatedQueries);\n  }\n\n  updatedRelatedQueries({ relatedQueries }: Results) {\n    this.update({ relatedQueries });\n  }\n\n  send(event: Event) {\n    return this.flux.rewrite((<HTMLAnchorElement>event.target).text);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/related-queries/gb-related-queries.ts\n **/","import '../list/gb-list.tag.html';\nimport '../product/gb-product.tag.html';\nimport { Results } from './gb-results';\nriot.tag2('gb-results', '<yield> <gb-list items=\"{records}\"> <gb-product all_meta=\"{item.allMeta}\"></gb-product> </gb-list> </yield>', 'gb-results .gb-stylish gb-list,[riot-tag=\"gb-results\"] .gb-stylish gb-list,[data-is=\"gb-results\"] .gb-stylish gb-list{ padding: 0; list-style: none; display: flex; flex-wrap: wrap; justify-content: space-around; } gb-results .gb-stylish gb-product,[riot-tag=\"gb-results\"] .gb-stylish gb-product,[data-is=\"gb-results\"] .gb-stylish gb-product{ display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }', '', function(opts) {\n    this._mixin(Results);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/results/gb-results.tag.html\n **/","import { getPath, unless } from '../../utils/common';\nimport { ProductStructure } from '../../utils/product-transformer';\nimport { FluxTag } from '../tag';\nimport { Events, Record, Results as ResultsModel } from 'groupby-api';\n\nexport interface Results extends FluxTag<any> { }\n\nexport class Results {\n\n  struct: ProductStructure;\n  variantStruct: ProductStructure;\n  records: Record[];\n  collection: string;\n  getPath: typeof getPath;\n\n  init() {\n    this.struct = this.config.structure;\n    this.variantStruct = unless(this.struct._variantStructure, this.struct);\n    this.getPath = getPath;\n\n    this.flux.on(Events.RESULTS, this.updateRecords);\n  }\n\n  updateRecords({ records }: ResultsModel) {\n    this.update({ records, collection: this.flux.query.raw.collection });\n  }\n\n  userStyle(key: string) {\n    return this.opts.css ? this.opts.css[key] : '';\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/results/gb-results.ts\n **/","import { Snippet } from '../snippet/gb-snippet';\nriot.tag2('gb-snippet', '<div class=\"gb-snippet\"> {responseText} </div>', '', '', function(opts) {\n    this._mixin(Snippet);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/snippet/gb-snippet.tag.html\n **/","import { FluxTag } from '../tag';\n\nexport interface SnippetConfig {\n  raw?: boolean;\n  url: string;\n}\n\nexport const DEFAULT_CONFIG: SnippetConfig & any = {\n  raw: false\n};\n\nexport interface Snippet extends FluxTag<SnippetConfig> { }\n\nexport class Snippet {\n\n  responseText: string;\n\n  init() {\n    this.configure(DEFAULT_CONFIG);\n\n    this.on('mount', this.loadFile);\n  }\n\n  loadFile() {\n    const req = new XMLHttpRequest();\n    req.onload = () => {\n      const { responseText } = req;\n      if (this._config.raw) {\n        this.root.innerHTML = responseText;\n      } else {\n        this.update({ responseText });\n      }\n    };\n    req.open('get', this._config.url, true);\n    req.send();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/snippet/gb-snippet.ts\n **/","import '../select/gb-select.tag.html';\nimport { Sort } from './gb-sort';\nriot.tag2('gb-sort', '<yield> <gb-select scope=\"gb-sort\"> </gb-select> </yield>', '', '', function(opts) {\n    this._mixin(Sort);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/sort/gb-sort.tag.html\n **/","import { SelectConfig, SelectTag } from '../select/gb-select';\nimport { Results, Sort as SortModel } from 'groupby-api';\n\nexport const DEFAULT_SORTS = [\n  { label: 'Name Descending', value: { field: 'title', order: 'Descending' } },\n  { label: 'Name Ascending', value: { field: 'title', order: 'Ascending' } }\n];\n\nexport interface SortConfig extends SelectConfig {\n  options: any[];\n}\n\nexport interface Sort extends SelectTag<SortConfig> { }\n\nexport class Sort {\n\n  init() {\n    this.configure();\n\n    this.options = this._config.options || DEFAULT_SORTS;\n  }\n\n  sortValues() {\n    return this.options.map((option) => option.value);\n  }\n\n  onselect(value: SortModel): Promise<Results> {\n    return this.flux.sort(value, this.sortValues());\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/sort/gb-sort.ts\n **/","import './gb-content-zone.tag.html';\nimport './gb-rich-content-zone.tag.html';\nimport './gb-record-zone.tag.html';\nimport { Template } from './gb-template';\nriot.tag2('gb-template', '<div if=\"{isActive}\"> <yield> <div each=\"{zone in zones}\" class=\"gb-zone-{zone.name}\"> <gb-content-zone if=\"{zone.type === \\'Content\\'}\"></gb-content-zone> <gb-rich-content-zone if=\"{zone.type === \\'Rich_Content\\'}\"></gb-rich-content-zone> <gb-record-zone if=\"{zone.type === \\'Record\\'}\"></gb-record-zone> </div> </yield> </div>', '', '', function(opts) {\n    this._mixin(Template);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/template/gb-template.tag.html\n **/","riot.tag2('gb-content-zone', '<span>{zone.content}</span>', '', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/template/gb-content-zone.tag.html\n **/","import '../raw/gb-raw.tag.html';\nriot.tag2('gb-rich-content-zone', '<gb-raw content=\"{zone.richContent}\"></gb-raw>', '', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/template/gb-rich-content-zone.tag.html\n **/","import '../list/gb-list.tag.html';\nriot.tag2('gb-record-zone', '<gb-list items=\"{zone.records}\"> <gb-product all_meta=\"{item.allMeta}\"></gb-product> </gb-list>', '', '', function(opts) {\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tags/template/gb-record-zone.tag.html\n **/","import { FluxTag } from '../tag';\nimport { Events, Results } from 'groupby-api';\n\nexport interface TemplateConfig {\n  target: string;\n}\n\nexport interface Template extends FluxTag<TemplateConfig> { }\n\nexport class Template {\n\n  isActive: boolean;\n  zones: any[];\n  zoneMap: any;\n\n  init() {\n    this.configure();\n\n    this.flux.on(Events.RESULTS, this.updateActive);\n  }\n\n  updateActive({ template }: Results) {\n    this.update({\n      isActive: template.name === this._config.target,\n      zoneMap: template.zones,\n      zones: this.sortZones(template.zones)\n    });\n  }\n\n  sortZones(zones: any) {\n    return Object.keys(zones).map((key) => zones[key])\n      .reduce((list, zone) => {\n        if (zone.type === 'Record') {\n          list.push(zone);\n        } else {\n          list.unshift(zone);\n        }\n        return list;\n      }, []);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/source-map-loader!./src/tags/template/gb-template.ts\n **/"],"sourceRoot":""}